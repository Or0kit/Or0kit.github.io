{
    "version": "https://jsonfeed.org/version/1",
    "title": "Or0kit • All posts by \"tab\" tag",
    "description": "临渊羡鱼，不如退而结网",
    "home_page_url": "https://Or0kit.github.io",
    "items": [
        {
            "id": "https://or0kit.github.io/Programming/MFC/MFC-05Tab%E6%A0%87%E7%AD%BE%E6%8E%A7%E4%BB%B6/",
            "url": "https://or0kit.github.io/Programming/MFC/MFC-05Tab%E6%A0%87%E7%AD%BE%E6%8E%A7%E4%BB%B6/",
            "title": "MFC-05Tab标签控件",
            "date_published": "2022-03-22T06:43:28.000Z",
            "content_html": "<h1 id=\"tab标签控件\"><a class=\"anchor\" href=\"#tab标签控件\">#</a> Tab 标签控件</h1>\n<p>添加 Tab Control 控件</p>\n<p><img data-src=\"image001.png\" alt=\"\" /></p>\n<p>我们为了使用方便先给这个标签页添加一个类型变量  <code>m_Tab1</code>  。</p>\n<p><img data-src=\"image002.png\" alt=\"\" /></p>\n<p>在工程中添加子对话框，有几个标签页插入几个子对话框，并且修改对话框资源属性，把 边框改为  <code>None</code>  把样式改为  <code>Child</code>  英文是  <code>Border：None</code>   <code>Style：Child</code> 。</p>\n<p><img data-src=\"image003.png\" alt=\"\" /></p>\n<p>然后对着子对话框右键选择添加类，这里类名随便起，基类就选择  <code>CDialog</code>  了。</p>\n<p><img data-src=\"image004.png\" alt=\"\" /></p>\n<p>在主对话框类声明中加入子对话框的实例化对象：  <code>CPage1 m_CPage1</code>  ， 记得包含进我们为子对话框新建的类的声明文件。</p>\n<p>以上步骤我们重复一次再创建一个  <code>CPage2 m_CPage2</code> 。</p>\n<p>现在我们开始显示这两个标签页。</p>\n<p>在主对话框初始化的地方添加如下代码:</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 添加标签页</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\tm_Tab1<span class=\"token punctuation\">.</span><span class=\"token function\">InsertItem</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">_T</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"第一页\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tm_Tab1<span class=\"token punctuation\">.</span><span class=\"token function\">InsertItem</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token function\">_T</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"第二页\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\tm_CPage1<span class=\"token punctuation\">.</span><span class=\"token function\">Create</span><span class=\"token punctuation\">(</span>IDD_DIALOG1<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>m_Tab1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\tm_CPage2<span class=\"token punctuation\">.</span><span class=\"token function\">Create</span><span class=\"token punctuation\">(</span>IDD_DIALOG2<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>m_Tab1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token comment\">// 调整子对话框大小及位置</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\tCRect rc<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\tm_Tab1<span class=\"token punctuation\">.</span><span class=\"token function\">GetClientRect</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>rc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\tCRect rcTabItem<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\tm_Tab1<span class=\"token punctuation\">.</span><span class=\"token function\">GetItemRect</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> rcTabItem<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\trc<span class=\"token punctuation\">.</span>top <span class=\"token operator\">+=</span> rcTabItem<span class=\"token punctuation\">.</span><span class=\"token function\">Height</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\trc<span class=\"token punctuation\">.</span>left <span class=\"token operator\">+=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\trc<span class=\"token punctuation\">.</span>bottom <span class=\"token operator\">-=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\trc<span class=\"token punctuation\">.</span>right <span class=\"token operator\">-=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\tm_CPage1<span class=\"token punctuation\">.</span><span class=\"token function\">MoveWindow</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>rc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\tm_CPage2<span class=\"token punctuation\">.</span><span class=\"token function\">MoveWindow</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>rc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t<span class=\"token comment\">// 设置默认的标签页</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\tm_CPage1<span class=\"token punctuation\">.</span><span class=\"token function\">ShowWindow</span><span class=\"token punctuation\">(</span>SW_SHOW<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\tm_Tab1<span class=\"token punctuation\">.</span><span class=\"token function\">SetCurFocus</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>当然这个过程也可以封装一下方便以后自己调用。</p>\n<p>然后给标签页控件添加 消息处理函数</p>\n<p><img data-src=\"image005.png\" alt=\"\" /></p>\n<p>函数为:</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token class-name\">CMFCCStringDlg</span><span class=\"token operator\">::</span><span class=\"token function\">OnTcnSelchangeTab1</span><span class=\"token punctuation\">(</span>NMHDR<span class=\"token operator\">*</span> pNMHDR<span class=\"token punctuation\">,</span> LRESULT<span class=\"token operator\">*</span> pResult<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token comment\">// TODO: 在此添加控件通知处理程序代码</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>m_Tab1<span class=\"token punctuation\">.</span><span class=\"token function\">GetCurSel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t\tm_CPage1<span class=\"token punctuation\">.</span><span class=\"token function\">ShowWindow</span><span class=\"token punctuation\">(</span>SW_SHOW<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t\tm_CPage2<span class=\"token punctuation\">.</span><span class=\"token function\">ShowWindow</span><span class=\"token punctuation\">(</span>SW_HIDE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\tm_CPage1<span class=\"token punctuation\">.</span><span class=\"token function\">SetFocus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t\tm_CPage2<span class=\"token punctuation\">.</span><span class=\"token function\">ShowWindow</span><span class=\"token punctuation\">(</span>SW_SHOW<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t\tm_CPage1<span class=\"token punctuation\">.</span><span class=\"token function\">ShowWindow</span><span class=\"token punctuation\">(</span>SW_HIDE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\tm_CPage2<span class=\"token punctuation\">.</span><span class=\"token function\">SetFocus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t<span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t<span class=\"token operator\">*</span>pResult <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>当显示第 X 页的时候，要把其他页给隐藏了。</p>\n<p><img data-src=\"image006.png\" alt=\"\" /></p>\n<p>当然也可以进行美化。</p>\n",
            "tags": [
                "Tab"
            ]
        }
    ]
}