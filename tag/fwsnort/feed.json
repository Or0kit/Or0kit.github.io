{
    "version": "https://jsonfeed.org/version/1",
    "title": "Or0kit • All posts by \"fwsnort\" tag",
    "description": "临渊羡鱼，不如退而结网",
    "home_page_url": "https://Or0kit.github.io",
    "items": [
        {
            "id": "https://or0kit.github.io/Linux/Linux%E9%98%B2%E7%81%AB%E5%A2%99-fwsnort%E7%9A%84%E5%AE%89%E8%A3%85/",
            "url": "https://or0kit.github.io/Linux/Linux%E9%98%B2%E7%81%AB%E5%A2%99-fwsnort%E7%9A%84%E5%AE%89%E8%A3%85/",
            "title": "Linux防火墙-fwsnort的安装",
            "date_published": "2021-12-21T08:17:01.000Z",
            "content_html": "<h1 id=\"楔子\"><a class=\"anchor\" href=\"#楔子\">#</a> 楔子</h1>\n<p>Linux 防火墙实验报告</p>\n<h2 id=\"实验目的\"><a class=\"anchor\" href=\"#实验目的\">#</a> 实验目的</h2>\n<ol>\n<li>掌握在 Linux 下安装 fwsnort 的基本方法和常规设置。</li>\n<li>掌握 fwsnort 转换 iptables 规则的使用方法。</li>\n<li>理解 fwsnort 运行的原理。</li>\n</ol>\n<h2 id=\"实验内容\"><a class=\"anchor\" href=\"#实验内容\">#</a> 实验内容</h2>\n<p>在 centos 中安装 fwsnort</p>\n<h2 id=\"实验环境\"><a class=\"anchor\" href=\"#实验环境\">#</a> 实验环境</h2>\n<p>Centos 7 IP: 192.168.252.136<br />\nkali  IP: 192.168.252.128</p>\n<h2 id=\"实验步骤\"><a class=\"anchor\" href=\"#实验步骤\">#</a> 实验步骤</h2>\n<ol>\n<li>下载并导入密钥公钥 验证</li>\n</ol>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS-7 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cd /usr/local/src</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS-7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># wget http://www.cipherdyne.org/fwsnort/download/fwsnort-1.6.8.tar.bz2</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS-7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># gpg --keyserver http://www.cipherdyne.org/public_key --recv  0D3E7410</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS-7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># wget http://www.cipherdyne.org/fwsnort/download/fwsnort-1.6.8.tar.bz2.asc</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS-7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># gpg --verify fwsnort-1.6.8.tar.bz2.asc</span></pre></td></tr></table></figure><p><img data-src=\"image001.png\" alt=\"\" /></p>\n<ol start=\"2\">\n<li>解压并安装</li>\n</ol>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS-7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># tar -jxvf ./fwsnort-1.6.8.tar.bz2</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS-7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># cd fwsnort-1.6.8/</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS-7 fwsnort-1.6.8<span class=\"token punctuation\">]</span><span class=\"token comment\"># ls</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS-7 fwsnort-1.6.8<span class=\"token punctuation\">]</span><span class=\"token comment\"># ./install.pl</span></pre></td></tr></table></figure><p><img data-src=\"image002.png\" alt=\"\" /></p>\n<ol start=\"3\">\n<li>执行命令  <code>fwsnort</code></li>\n</ol>\n<p><img data-src=\"image003.png\" alt=\"\" /></p>\n<p>成功率只有 61.37%</p>\n<ol start=\"4\">\n<li>触发签名</li>\n</ol>\n<p><img data-src=\"image004.png\" alt=\"\" /></p>\n<ol start=\"5\">\n<li>查看 iptables 规则链<br />\n <code>iptables -L</code>  或者  <code>fwsnort --ipt-list</code></li>\n</ol>\n<p><img data-src=\"image005.png\" alt=\"\" /></p>\n<ol start=\"6\">\n<li>在外部扫描者上执行下面命令  <code>echo &quot;l44adsl&quot; | nc -u 192.168.252.136 27444</code></li>\n</ol>\n<p><img data-src=\"image006.png\" alt=\"\" /></p>\n<ol start=\"7\">\n<li>参考目标主机的日志信息  <code>grep 237 /var/log/messages | tail -n 1</code></li>\n</ol>\n<p><img data-src=\"image007.png\" alt=\"\" /></p>\n<ol start=\"8\">\n<li>观察 fwsnort 的运行</li>\n</ol>\n<p>在 CentOS7 上执行以下命令</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS-7 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># fwsnort -snort-sid 652</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS-7 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># /var/lib/fwsnort/fwsnort.sh</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS-7 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># systemctl start httpd</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS-7 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># iptables -A OUTPUT -p tcp --sport 80 -j ACCEPT</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS-7 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># iptables -A INPUT -p tcp --dport 80 -j ACCEPT</span></pre></td></tr></table></figure><p><img data-src=\"image008.png\" alt=\"\" /></p>\n<p>在 kali 上执行: <code>perl -e 'print &quot;\\x90\\x90\\x90\\xe8\\xc0\\xff\\xff\\xff/bin/sh&quot;' | nc 192.168.252.136 80 </code></p>\n<p><img data-src=\"image009.png\" alt=\"\" /></p>\n<p>在 CentOS7 上查看<br />\n <code>[root@CentOS-7 ~]# grep 128 /var/log/messages | tail -n 10</code></p>\n<p><img data-src=\"image010.png\" alt=\"\" /></p>\n",
            "tags": [
                "fwsnort"
            ]
        }
    ]
}