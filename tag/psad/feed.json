{
    "version": "https://jsonfeed.org/version/1",
    "title": "Or0kit â€¢ All posts by \"psad\" tag",
    "description": "ä¸´æ¸Šç¾¡é±¼ï¼Œä¸å¦‚é€€è€Œç»“ç½‘",
    "home_page_url": "https://Or0kit.github.io",
    "items": [
        {
            "id": "https://or0kit.github.io/Linux/Linux%E9%98%B2%E7%81%AB%E5%A2%99-Psad%E7%9A%84%E7%AD%BE%E5%90%8D%E5%8C%B9%E9%85%8D/",
            "url": "https://or0kit.github.io/Linux/Linux%E9%98%B2%E7%81%AB%E5%A2%99-Psad%E7%9A%84%E7%AD%BE%E5%90%8D%E5%8C%B9%E9%85%8D/",
            "title": "Linuxé˜²ç«å¢™-Psadçš„ç­¾ååŒ¹é…",
            "date_published": "2021-12-21T07:30:38.000Z",
            "content_html": "<h1 id=\"æ¥”å­\"><a class=\"anchor\" href=\"#æ¥”å­\">#</a> æ¥”å­</h1>\n<p>Linux é˜²ç«å¢™å®éªŒæŠ¥å‘Š</p>\n<h2 id=\"å®éªŒç›®çš„\"><a class=\"anchor\" href=\"#å®éªŒç›®çš„\">#</a> å®éªŒç›®çš„</h2>\n<p>1. æŒæ¡ Psad æ˜¯å¦‚ä½•é€šè¿‡è§£æ iptables æ—¥å¿—ä¿¡æ¯æ¥è¿›è¡Œç­¾ååŒ¹é…ï¼›<br />\n2. æŒæ¡ psad ç­¾åæ›´æ–°ã€æŸ¥çœ‹ psad çš„çŠ¶æ€è¾“å‡ºã€å–è¯å’Œè¯¦ç»† / è°ƒè¯•æ¨¡å¼ã€‚</p>\n<h2 id=\"å®éªŒå†…å®¹\"><a class=\"anchor\" href=\"#å®éªŒå†…å®¹\">#</a> å®éªŒå†…å®¹</h2>\n<p>Psad çš„é«˜çº§ä¸»é¢˜ï¼šä»ç­¾ååŒ¹é…åˆ°æ“ä½œç³»ç»ŸæŒ‡çº¹è¯†åˆ«ï¼›</p>\n<h2 id=\"å®éªŒç¯å¢ƒ\"><a class=\"anchor\" href=\"#å®éªŒç¯å¢ƒ\">#</a> å®éªŒç¯å¢ƒ</h2>\n<p>Centos 7<br />\nkali</p>\n<h2 id=\"å®éªŒæ­¥éª¤\"><a class=\"anchor\" href=\"#å®éªŒæ­¥éª¤\">#</a> å®éªŒæ­¥éª¤</h2>\n<p>1ã€åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œä¸‹é¢æ“ä½œï¼š</p>\n<p><code>psad - -sig-update</code></p>\n<p><img data-src=\"image001.png\" alt=\"\" /></p>\n<p>2ã€æ„é€ ç«¯å£ä¸º 0 æµé‡ï¼šä¹Ÿå¯ä»¥è‡ªå·±æ„é€ å…¶ä»–æ”»å‡»<br />\nåœ¨æ‰«æè€…ä¸»æœºæ‰§è¡Œä¸‹é¢æ“ä½œ<br />\n <code>hping3 -p 0 192.168.252.136</code>  æˆ–è€…  <code>hping3 -S -t 0 -p 0 192.168.252.136</code></p>\n<p>3ã€æ£€æµ‹ TCP ç«¯å£ 0 æµé‡ï¼ŒæŸ¥çœ‹ psad çš„çŠ¶æ€è¾“å‡º<br />\nåœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œä¸‹é¢æ“ä½œï¼š<br />\n <code>psad â€“S</code></p>\n<p><img data-src=\"image002.png\" alt=\"\" /></p>\n<p>4ã€æŸ¥çœ‹ç”µå­é‚®ä»¶è­¦æŠ¥</p>\n<p>åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œä¸‹é¢æ“ä½œï¼š<br />\n <code>cat /var/spool/mail/root</code>  æˆ–è€…åœ¨ä½ çš„ç”µå­é‚®ç®±é‡ŒæŸ¥çœ‹</p>\n<p><img data-src=\"image003.png\" alt=\"\" /></p>\n<p>5ã€åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œä¸‹é¢æ“ä½œï¼š<br />\n <code>psad  â€“A </code></p>\n<p><img data-src=\"image004.png\" alt=\"\" /></p>\n<p><code>psad  --debug</code></p>\n<p><img data-src=\"image005.png\" alt=\"\" /></p>\n",
            "tags": [
                "Psad"
            ]
        },
        {
            "id": "https://or0kit.github.io/Linux/Linux%E9%98%B2%E7%81%AB%E5%A2%99-psad%E6%A3%80%E6%B5%8B%E5%8F%AF%E7%96%91%E6%B5%81%E9%87%8F/",
            "url": "https://or0kit.github.io/Linux/Linux%E9%98%B2%E7%81%AB%E5%A2%99-psad%E6%A3%80%E6%B5%8B%E5%8F%AF%E7%96%91%E6%B5%81%E9%87%8F/",
            "title": "Linuxé˜²ç«å¢™-psadæ£€æµ‹å¯ç–‘æµé‡",
            "date_published": "2021-12-21T06:09:00.000Z",
            "content_html": "<h1 id=\"æ¥”å­\"><a class=\"anchor\" href=\"#æ¥”å­\">#</a> æ¥”å­</h1>\n<p>Linux é˜²ç«å¢™å®éªŒæŠ¥å‘Š</p>\n<h2 id=\"å®éªŒç›®çš„\"><a class=\"anchor\" href=\"#å®éªŒç›®çš„\">#</a> å®éªŒç›®çš„</h2>\n<p>1. å­¦ä¹  Psad æ˜¯å¦‚ä½•é€šè¿‡è§£æ iptables æ—¥å¿—ä¿¡æ¯æ¥æ£€æµ‹ç«¯å£æ‰«æï¼›<br />\n2. æŒæ¡ psad ç›‘æ§ iptables æ—¥å¿—ä¿¡æ¯æ£€æµ‹æ”»å‡»å’Œå¯ç–‘æµé‡ã€‚</p>\n<h2 id=\"å®éªŒå†…å®¹\"><a class=\"anchor\" href=\"#å®éªŒå†…å®¹\">#</a> å®éªŒå†…å®¹</h2>\n<p>Psad æ£€æµ‹å¯ç–‘æµé‡ï¼›</p>\n<h2 id=\"å®éªŒç¯å¢ƒ\"><a class=\"anchor\" href=\"#å®éªŒç¯å¢ƒ\">#</a> å®éªŒç¯å¢ƒ</h2>\n<p>CentOS-7   IP: 192.168.252.137<br />\nkali       IP: 192.168.252.128</p>\n<h2 id=\"å®éªŒæ­¥éª¤\"><a class=\"anchor\" href=\"#å®éªŒæ­¥éª¤\">#</a> å®éªŒæ­¥éª¤</h2>\n<p>1ã€TCP connect () æ‰«æï¼šæ ‡æ³¨æºå’Œç›®çš„ IP åœ°å€ã€è¢«æ‰«æçš„ TCP ç«¯å£èŒƒå›´ã€å‘é€çš„æ ‡è®°å’Œ psad åˆ†é…ç»™è¯¥æ‰«æè€…çš„å±é™©çº§åˆ«ã€‚</p>\n<p>å¤–éƒ¨æ‰«æè€…ï¼š<br />\n <code>(rootğŸ’€kali)-[~]# nmap -sT -n 192.168.252.136 --max-rtt-timeout 500ms</code></p>\n<p><img data-src=\"image001.png\" alt=\"\" /></p>\n<p>CentOS7: æŸ¥çœ‹æ—¥å¿—ä¿¡æ¯ã€‚<br />\n <code>grep SYN /var/log/messages | tail -n 1</code></p>\n<p><img data-src=\"image002.png\" alt=\"\" /></p>\n<p>2ã€TCP SYN æˆ–åŠå¼€æ”¾æ‰«æ</p>\n<p>å¤–éƒ¨æ‰«æè€…ï¼š<br />\n <code>(rootğŸ’€kali)-[~]# nmap -sS -n 192.168.252.136 --max-rtt-timeout 500ms</code></p>\n<p><img data-src=\"image003.png\" alt=\"\" /></p>\n<p>ç›®æ ‡ä¸»æœºï¼š <code>cat  /var/log/messages</code>      ï¼ˆæ‰¾åˆ°ç›¸åº”çš„æ—¥å¿—ä¿¡æ¯ï¼‰<br />\næ ¹æ®æ—¥å¿—ä¿¡æ¯æ‰¾åˆ°ä¸ connect () æ‰«æä¸­çš„å­—æ®µä¸åŒçš„åŸå› ã€‚å¹¶ç»™å‡ºç›¸åº”çš„æˆªå›¾æ ‡æ³¨ã€‚</p>\n<p><img data-src=\"image004.png\" alt=\"\" /></p>\n<p>3ã€TCP FINã€XMAS å’Œ NULL æ‰«æï¼šæ‰¾å‡ºæ¯ç§æ‰«æä¸­ TCP æ•°æ®åŒ…çš„ iptables æ—¥å¿—ä¿¡æ¯çš„ TCP æ ‡è®°éƒ¨åˆ†</p>\n<p>å¤–éƒ¨æ‰«æè€…ï¼š<br />\n <code>(rootğŸ’€kali)-[~]# nmap â€“sF -n 192.168.252.136</code> <br />\n <code>(rootğŸ’€kali)-[~]# nmap â€“sN -n 192.168.252.136</code> <br />\n <code>(rootğŸ’€kali)-[~]# nmap â€“sX -n 192.168.252.136</code></p>\n<p><img data-src=\"image005.png\" alt=\"\" /></p>\n<p>ç›®æ ‡ä¸»æœºï¼štail /var/log/messages     æ ¹æ®å…·ä½“æƒ…å†µæŸ¥çœ‹æ—¥å¿—ä¿¡æ¯ã€‚</p>\n<p><img data-src=\"image006.png\" alt=\"\" /></p>\n<p>4ã€UDP æ‰«æï¼šå†æˆªå›¾ä¸­çš„åè®®ã€æºå’Œç›®çš„ IP åœ°å€ã€ç«¯å£å·ä»¥åŠæ•°æ®åŒ…é•¿åº¦ç»™ä¸æ˜æ˜¾æ ‡è®°ã€‚<br />\nå¤–éƒ¨æ‰«æè€…ï¼š<br />\n <code>(rootğŸ’€kali)-[~]# nmap -sU -n 192.168.252.136</code></p>\n<p><img data-src=\"image007.png\" alt=\"\" /></p>\n<p>ç›®æ ‡ä¸»æœºï¼š <code>tail  /var/log/messages</code>     æ ¹æ®å…·ä½“æƒ…å†µæŸ¥çœ‹æ—¥å¿—ä¿¡æ¯ã€‚</p>\n<p><img data-src=\"image008.png\" alt=\"\" /></p>\n",
            "tags": [
                "Psad"
            ]
        },
        {
            "id": "https://or0kit.github.io/Linux/Linux%E9%98%B2%E7%81%AB%E5%A2%99-Psad%E5%AE%89%E8%A3%85/",
            "url": "https://or0kit.github.io/Linux/Linux%E9%98%B2%E7%81%AB%E5%A2%99-Psad%E5%AE%89%E8%A3%85/",
            "title": "Linuxé˜²ç«å¢™--Psadå®‰è£…",
            "date_published": "2021-12-21T02:15:58.000Z",
            "content_html": "<h1 id=\"æ¥”å­\"><a class=\"anchor\" href=\"#æ¥”å­\">#</a> æ¥”å­</h1>\n<p>Linux é˜²ç«å¢™å®éªŒ</p>\n<h2 id=\"å®‰è£…psad-è¸©å‘\"><a class=\"anchor\" href=\"#å®‰è£…psad-è¸©å‘\">#</a> å®‰è£… PSad ï¼ˆè¸©å‘ï¼ï¼‰</h2>\n<p>æ‰§è¡Œ <code>yum install perl-IPTables-ChainMgr perl-Date-Calc perl-Unix-Syslog</code>  å‘½ä»¤</p>\n<p>æŠ¥é”™ No package XXX available</p>\n<p>ä¼ä¸šç‰ˆ Linux åº“é…ç½®åŒ…ä¸­å®‰è£…æ‰©å±•åŒ…ï¼š<br />\næ‰§è¡Œ <code>yum install epel-release.noarch</code></p>\n<p>å†æ¬¡æ‰§è¡Œ  <code>yum install perl-IPTables-ChainMgr perl-Date-Calc perl-Unix-Syslog</code>  å‘½ä»¤</p>\n<p><img data-src=\"image001.png\" alt=\"\" /></p>\n<p>ä¸‹è½½ Psad</p>\n<p><code>rpm -Uvh http://www.cipherdyne.org/psad/download/psad-2.4.2-1.x86_64.rpm</code></p>\n<p><img data-src=\"image002.png\" alt=\"\" /></p>\n<p>å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹å¹¶æ£€æŸ¥çŠ¶æ€:<br />\n <code>cd /etc/init.d/</code> <br />\n <code>psad start</code></p>\n<p>åˆæŠ¥é”™  <code>[*] Could not find whois, edit /etc/psad/psad.conf at /usr/sbin/psad line 10928.</code></p>\n<p>å®‰è£… whois<br />\n <code>yum  install whois</code></p>\n<p><img data-src=\"image003.png\" alt=\"\" /></p>\n<p>å®‰è£…å®Œåå†æ¬¡æ‰§è¡Œ <code>psad start</code>  åˆæŠ¥é”™:  <code>Use of uninitialized value $config&#123;&quot;ENABLE_FIREWALLD&quot;&#125; in string eq at /usr/sbin/fwcheck_psad line 139.</code></p>\n<p>Google äº†ä¸€ä¸‹ï¼Œå‘ç°æ˜¯ç‰ˆæœ¬é—®é¢˜ï¼Œç„¯ï¼</p>\n<p><img data-src=\"image004.png\" alt=\"\" /></p>\n<p>Psad çš„åˆ›å§‹äººç›´æ¥æ›´äº†ä¸€ä¸ªç‰ˆæœ¬â€¦â€¦</p>\n<p>æ²¡åŠæ³•åªèƒ½é‡æ–°å¼€å§‹å®‰è£…äº†</p>\n<p>åˆ é™¤ 2.4.2 ç‰ˆæœ¬  <code>rpm -e psad-2.4.2-1.x86_64</code></p>\n<p>å®‰è£…ä¸‹è½½ psad</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root@CentOS7 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cd /usr/local/src</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># wget http://www.cipherdyne.org/psad/download/psad-2.4.6.tar.bz2</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># wget http://www.cipherdyne.org/psad/download/psad-2.4.6.tar.bz2.asc</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># md5sum psad-2.4.6.tar.bz2</span></pre></td></tr></table></figure><p><img data-src=\"image005.png\" alt=\"\" /></p>\n<p>é™„ä¸Š MD5</p>\n<p><img data-src=\"image006.png\" alt=\"\" /></p>\n<p>å¯¼å…¥å¯†é’¥å…¬é’¥ éªŒè¯ ä¸‹è½½å®‰è£… bz2 è§£å‹ç¨‹åº</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># gpg --keyserver http://www.cipherdyne.org/public_key --recv 0D3E7410</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># gpg --verify ./psad-2.4.6.tar.bz2</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># gpg --verify ./psad-2.4.6.tar.bz2.asc </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># yum -y install bzip2</span></pre></td></tr></table></figure><p><img data-src=\"image007.png\" alt=\"\" /></p>\n<p>è§£å‹å¹¶å®‰è£… psad</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># tar -jxvf ./psad-2.4.6.tar.bz2</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 psad-2.4.6<span class=\"token punctuation\">]</span><span class=\"token comment\"># chmod a+x install.pl</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 psad-2.4.6<span class=\"token punctuation\">]</span><span class=\"token comment\"># ./install.pl</span></pre></td></tr></table></figure><p><img data-src=\"image008.png\" alt=\"\" /></p>\n<p>å¯åŠ¨ pasd<br />\n <code>[root@CentOS7 psad-2.4.6]# psad start</code></p>\n<p>æ£€æŸ¥ psad æ˜¯å¦æ²¡æœ‰æ¥æ”¶åˆ°ä»»ä½• iptables æ—¥å¿—æ¶ˆæ¯çš„ç¬¬ä¸€ä»¶äº‹æ˜¯ç¡®ä¿ iptables/ip6tables ç­–ç•¥é…ç½®ä¸ºè®°å½•ä¸åˆæ³•æµé‡æ— å…³çš„æ•°æ®åŒ…ã€‚<br />\nå®‰è£…äº† psad ä¹‹åï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼ˆä»¥ root ç”¨æˆ·èº«ä»½ï¼‰æ¥æµ‹è¯• psad æ˜¯å¦èƒ½å¤ŸæŸ¥çœ‹ iptables æ—¥å¿—æ¶ˆæ¯ã€‚<br />\næ‰§è¡Œ psad -S æˆ–è€… psad â€“Status , æŸ¥çœ‹æ˜¯å¦æœ‰æ¥æ”¶ iptables æ—¥å¿—æ¶ˆæ¯ã€‚</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 psad-2.4.6<span class=\"token punctuation\">]</span><span class=\"token comment\"># iptables -I INPUT -i lo -p tcp --dport 3003 -j LOG --log-prefix \"Inbound \"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 psad-2.4.6<span class=\"token punctuation\">]</span><span class=\"token comment\"># telnet localhost 3003</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 psad-2.4.6<span class=\"token punctuation\">]</span><span class=\"token comment\"># psad -S</span></pre></td></tr></table></figure><p><img data-src=\"image009.png\" alt=\"\" /></p>\n<p>OKï¼Œå®éªŒæˆåŠŸï¼</p>\n<h1 id=\"reference\"><a class=\"anchor\" href=\"#reference\">#</a> Reference</h1>\n<p>æŠ¥é”™ No package XXX available: <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20veGl4aWh1YW5nL3AvNTQwNTE4OC5odG1s\">https://www.cnblogs.com/xixihuang/p/5405188.html</span></p>\n",
            "tags": [
                "Psad"
            ]
        }
    ]
}