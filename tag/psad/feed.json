{
    "version": "https://jsonfeed.org/version/1",
    "title": "Or0kit • All posts by \"psad\" tag",
    "description": "临渊羡鱼，不如退而结网",
    "home_page_url": "https://Or0kit.github.io",
    "items": [
        {
            "id": "https://or0kit.github.io/Linux/Linux%E9%98%B2%E7%81%AB%E5%A2%99-Psad%E7%9A%84%E7%AD%BE%E5%90%8D%E5%8C%B9%E9%85%8D/",
            "url": "https://or0kit.github.io/Linux/Linux%E9%98%B2%E7%81%AB%E5%A2%99-Psad%E7%9A%84%E7%AD%BE%E5%90%8D%E5%8C%B9%E9%85%8D/",
            "title": "Linux防火墙-Psad的签名匹配",
            "date_published": "2021-12-21T07:30:38.000Z",
            "content_html": "<h1 id=\"楔子\"><a class=\"anchor\" href=\"#楔子\">#</a> 楔子</h1>\n<p>Linux 防火墙实验报告</p>\n<h2 id=\"实验目的\"><a class=\"anchor\" href=\"#实验目的\">#</a> 实验目的</h2>\n<p>1. 掌握 Psad 是如何通过解析 iptables 日志信息来进行签名匹配；<br />\n2. 掌握 psad 签名更新、查看 psad 的状态输出、取证和详细 / 调试模式。</p>\n<h2 id=\"实验内容\"><a class=\"anchor\" href=\"#实验内容\">#</a> 实验内容</h2>\n<p>Psad 的高级主题：从签名匹配到操作系统指纹识别；</p>\n<h2 id=\"实验环境\"><a class=\"anchor\" href=\"#实验环境\">#</a> 实验环境</h2>\n<p>Centos 7<br />\nkali</p>\n<h2 id=\"实验步骤\"><a class=\"anchor\" href=\"#实验步骤\">#</a> 实验步骤</h2>\n<p>1、在目标主机上执行下面操作：</p>\n<p><code>psad - -sig-update</code></p>\n<p><img data-src=\"image001.png\" alt=\"\" /></p>\n<p>2、构造端口为 0 流量：也可以自己构造其他攻击<br />\n在扫描者主机执行下面操作<br />\n <code>hping3 -p 0 192.168.252.136</code>  或者  <code>hping3 -S -t 0 -p 0 192.168.252.136</code></p>\n<p>3、检测 TCP 端口 0 流量，查看 psad 的状态输出<br />\n在目标主机上执行下面操作：<br />\n <code>psad –S</code></p>\n<p><img data-src=\"image002.png\" alt=\"\" /></p>\n<p>4、查看电子邮件警报</p>\n<p>在目标主机上执行下面操作：<br />\n <code>cat /var/spool/mail/root</code>  或者在你的电子邮箱里查看</p>\n<p><img data-src=\"image003.png\" alt=\"\" /></p>\n<p>5、在目标主机上执行下面操作：<br />\n <code>psad  –A </code></p>\n<p><img data-src=\"image004.png\" alt=\"\" /></p>\n<p><code>psad  --debug</code></p>\n<p><img data-src=\"image005.png\" alt=\"\" /></p>\n",
            "tags": [
                "Psad"
            ]
        },
        {
            "id": "https://or0kit.github.io/Linux/Linux%E9%98%B2%E7%81%AB%E5%A2%99-psad%E6%A3%80%E6%B5%8B%E5%8F%AF%E7%96%91%E6%B5%81%E9%87%8F/",
            "url": "https://or0kit.github.io/Linux/Linux%E9%98%B2%E7%81%AB%E5%A2%99-psad%E6%A3%80%E6%B5%8B%E5%8F%AF%E7%96%91%E6%B5%81%E9%87%8F/",
            "title": "Linux防火墙-psad检测可疑流量",
            "date_published": "2021-12-21T06:09:00.000Z",
            "content_html": "<h1 id=\"楔子\"><a class=\"anchor\" href=\"#楔子\">#</a> 楔子</h1>\n<p>Linux 防火墙实验报告</p>\n<h2 id=\"实验目的\"><a class=\"anchor\" href=\"#实验目的\">#</a> 实验目的</h2>\n<p>1. 学习 Psad 是如何通过解析 iptables 日志信息来检测端口扫描；<br />\n2. 掌握 psad 监控 iptables 日志信息检测攻击和可疑流量。</p>\n<h2 id=\"实验内容\"><a class=\"anchor\" href=\"#实验内容\">#</a> 实验内容</h2>\n<p>Psad 检测可疑流量；</p>\n<h2 id=\"实验环境\"><a class=\"anchor\" href=\"#实验环境\">#</a> 实验环境</h2>\n<p>CentOS-7   IP: 192.168.252.137<br />\nkali       IP: 192.168.252.128</p>\n<h2 id=\"实验步骤\"><a class=\"anchor\" href=\"#实验步骤\">#</a> 实验步骤</h2>\n<p>1、TCP connect () 扫描：标注源和目的 IP 地址、被扫描的 TCP 端口范围、发送的标记和 psad 分配给该扫描者的危险级别。</p>\n<p>外部扫描者：<br />\n <code>(root💀kali)-[~]# nmap -sT -n 192.168.252.136 --max-rtt-timeout 500ms</code></p>\n<p><img data-src=\"image001.png\" alt=\"\" /></p>\n<p>CentOS7: 查看日志信息。<br />\n <code>grep SYN /var/log/messages | tail -n 1</code></p>\n<p><img data-src=\"image002.png\" alt=\"\" /></p>\n<p>2、TCP SYN 或半开放扫描</p>\n<p>外部扫描者：<br />\n <code>(root💀kali)-[~]# nmap -sS -n 192.168.252.136 --max-rtt-timeout 500ms</code></p>\n<p><img data-src=\"image003.png\" alt=\"\" /></p>\n<p>目标主机： <code>cat  /var/log/messages</code>      （找到相应的日志信息）<br />\n根据日志信息找到与 connect () 扫描中的字段不同的原因。并给出相应的截图标注。</p>\n<p><img data-src=\"image004.png\" alt=\"\" /></p>\n<p>3、TCP FIN、XMAS 和 NULL 扫描：找出每种扫描中 TCP 数据包的 iptables 日志信息的 TCP 标记部分</p>\n<p>外部扫描者：<br />\n <code>(root💀kali)-[~]# nmap –sF -n 192.168.252.136</code> <br />\n <code>(root💀kali)-[~]# nmap –sN -n 192.168.252.136</code> <br />\n <code>(root💀kali)-[~]# nmap –sX -n 192.168.252.136</code></p>\n<p><img data-src=\"image005.png\" alt=\"\" /></p>\n<p>目标主机：tail /var/log/messages     根据具体情况查看日志信息。</p>\n<p><img data-src=\"image006.png\" alt=\"\" /></p>\n<p>4、UDP 扫描：再截图中的协议、源和目的 IP 地址、端口号以及数据包长度给与明显标记。<br />\n外部扫描者：<br />\n <code>(root💀kali)-[~]# nmap -sU -n 192.168.252.136</code></p>\n<p><img data-src=\"image007.png\" alt=\"\" /></p>\n<p>目标主机： <code>tail  /var/log/messages</code>     根据具体情况查看日志信息。</p>\n<p><img data-src=\"image008.png\" alt=\"\" /></p>\n",
            "tags": [
                "Psad"
            ]
        },
        {
            "id": "https://or0kit.github.io/Linux/Linux%E9%98%B2%E7%81%AB%E5%A2%99-Psad%E5%AE%89%E8%A3%85/",
            "url": "https://or0kit.github.io/Linux/Linux%E9%98%B2%E7%81%AB%E5%A2%99-Psad%E5%AE%89%E8%A3%85/",
            "title": "Linux防火墙--Psad安装",
            "date_published": "2021-12-21T02:15:58.000Z",
            "content_html": "<h1 id=\"楔子\"><a class=\"anchor\" href=\"#楔子\">#</a> 楔子</h1>\n<p>Linux 防火墙实验</p>\n<h2 id=\"安装psad-踩坑\"><a class=\"anchor\" href=\"#安装psad-踩坑\">#</a> 安装 PSad （踩坑！）</h2>\n<p>执行 <code>yum install perl-IPTables-ChainMgr perl-Date-Calc perl-Unix-Syslog</code>  命令</p>\n<p>报错 No package XXX available</p>\n<p>企业版 Linux 库配置包中安装扩展包：<br />\n执行 <code>yum install epel-release.noarch</code></p>\n<p>再次执行  <code>yum install perl-IPTables-ChainMgr perl-Date-Calc perl-Unix-Syslog</code>  命令</p>\n<p><img data-src=\"image001.png\" alt=\"\" /></p>\n<p>下载 Psad</p>\n<p><code>rpm -Uvh http://www.cipherdyne.org/psad/download/psad-2.4.2-1.x86_64.rpm</code></p>\n<p><img data-src=\"image002.png\" alt=\"\" /></p>\n<p>启动守护进程并检查状态:<br />\n <code>cd /etc/init.d/</code> <br />\n <code>psad start</code></p>\n<p>又报错  <code>[*] Could not find whois, edit /etc/psad/psad.conf at /usr/sbin/psad line 10928.</code></p>\n<p>安装 whois<br />\n <code>yum  install whois</code></p>\n<p><img data-src=\"image003.png\" alt=\"\" /></p>\n<p>安装完后再次执行 <code>psad start</code>  又报错:  <code>Use of uninitialized value $config&#123;&quot;ENABLE_FIREWALLD&quot;&#125; in string eq at /usr/sbin/fwcheck_psad line 139.</code></p>\n<p>Google 了一下，发现是版本问题，焯！</p>\n<p><img data-src=\"image004.png\" alt=\"\" /></p>\n<p>Psad 的创始人直接更了一个版本……</p>\n<p>没办法只能重新开始安装了</p>\n<p>删除 2.4.2 版本  <code>rpm -e psad-2.4.2-1.x86_64</code></p>\n<p>安装下载 psad</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root@CentOS7 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cd /usr/local/src</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># wget http://www.cipherdyne.org/psad/download/psad-2.4.6.tar.bz2</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># wget http://www.cipherdyne.org/psad/download/psad-2.4.6.tar.bz2.asc</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># md5sum psad-2.4.6.tar.bz2</span></pre></td></tr></table></figure><p><img data-src=\"image005.png\" alt=\"\" /></p>\n<p>附上 MD5</p>\n<p><img data-src=\"image006.png\" alt=\"\" /></p>\n<p>导入密钥公钥 验证 下载安装 bz2 解压程序</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># gpg --keyserver http://www.cipherdyne.org/public_key --recv 0D3E7410</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># gpg --verify ./psad-2.4.6.tar.bz2</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># gpg --verify ./psad-2.4.6.tar.bz2.asc </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># yum -y install bzip2</span></pre></td></tr></table></figure><p><img data-src=\"image007.png\" alt=\"\" /></p>\n<p>解压并安装 psad</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 src<span class=\"token punctuation\">]</span><span class=\"token comment\"># tar -jxvf ./psad-2.4.6.tar.bz2</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 psad-2.4.6<span class=\"token punctuation\">]</span><span class=\"token comment\"># chmod a+x install.pl</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 psad-2.4.6<span class=\"token punctuation\">]</span><span class=\"token comment\"># ./install.pl</span></pre></td></tr></table></figure><p><img data-src=\"image008.png\" alt=\"\" /></p>\n<p>启动 pasd<br />\n <code>[root@CentOS7 psad-2.4.6]# psad start</code></p>\n<p>检查 psad 是否没有接收到任何 iptables 日志消息的第一件事是确保 iptables/ip6tables 策略配置为记录与合法流量无关的数据包。<br />\n安装了 psad 之后，可以执行以下操作（以 root 用户身份）来测试 psad 是否能够查看 iptables 日志消息。<br />\n执行 psad -S 或者 psad –Status , 查看是否有接收 iptables 日志消息。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 psad-2.4.6<span class=\"token punctuation\">]</span><span class=\"token comment\"># iptables -I INPUT -i lo -p tcp --dport 3003 -j LOG --log-prefix \"Inbound \"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 psad-2.4.6<span class=\"token punctuation\">]</span><span class=\"token comment\"># telnet localhost 3003</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@CentOS7 psad-2.4.6<span class=\"token punctuation\">]</span><span class=\"token comment\"># psad -S</span></pre></td></tr></table></figure><p><img data-src=\"image009.png\" alt=\"\" /></p>\n<p>OK，实验成功！</p>\n<h1 id=\"reference\"><a class=\"anchor\" href=\"#reference\">#</a> Reference</h1>\n<p>报错 No package XXX available: <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20veGl4aWh1YW5nL3AvNTQwNTE4OC5odG1s\">https://www.cnblogs.com/xixihuang/p/5405188.html</span></p>\n",
            "tags": [
                "Psad"
            ]
        }
    ]
}