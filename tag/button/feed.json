{
    "version": "https://jsonfeed.org/version/1",
    "title": "Or0kit • All posts by \"button\" tag",
    "description": "临渊羡鱼，不如退而结网",
    "home_page_url": "https://Or0kit.github.io",
    "items": [
        {
            "id": "https://or0kit.github.io/Programming/MFC/MFC-01%E6%8C%89%E9%92%AE%E6%8E%A7%E4%BB%B6/",
            "url": "https://or0kit.github.io/Programming/MFC/MFC-01%E6%8C%89%E9%92%AE%E6%8E%A7%E4%BB%B6/",
            "title": "MFC-01按钮控件",
            "date_published": "2022-03-18T11:42:30.000Z",
            "content_html": "<h1 id=\"楔子\"><a class=\"anchor\" href=\"#楔子\">#</a> 楔子</h1>\n<p>之前学习了 win32 的窗口编程，如今想进一步学习一下，C++ 的图形化编程。</p>\n<h1 id=\"创建一个mfc对话框工程\"><a class=\"anchor\" href=\"#创建一个mfc对话框工程\">#</a> 创建一个 MFC 对话框工程</h1>\n<p>这里我遇到了一个问题，用 VS2019 创建 MFC 工程，<strong>对 COM 组件的调用返回了错误 HRESULT E_FAIL</strong> 上网查了些文章，按着方法也照做了，可是还是不行，后来找到了原因，是因为项目名字中有下划线……，为了保险起见，我把放 MFC 代码的文件夹也取消下划线了。</p>\n<p>因为是初学者，暂时先设置成这样：</p>\n<p><img data-src=\"image001.png\" alt=\"\" /></p>\n<h1 id=\"button控件\"><a class=\"anchor\" href=\"#button控件\">#</a> button 控件</h1>\n<p>因为之前有 win32 的基础，所以只记下没有学过的一些内容。</p>\n<h2 id=\"禁用按钮\"><a class=\"anchor\" href=\"#禁用按钮\">#</a> 禁用按钮</h2>\n<p>相关函数：  <code>EnableWindow</code></p>\n<p>主要代码如下，不要在意函数名。</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token class-name\">CMFCCStringDlg</span><span class=\"token operator\">::</span><span class=\"token function\">OnBnClickedButton3</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token comment\">// TODO: 在此添加控件通知处理程序代码</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token comment\">// MFC 获取控件句柄</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token comment\">// 此函数有两个重名的，在全局上有一个，在 MFC 中也有，我们这里调用全局的，加上全局作用域</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token comment\">// win32 sdk api</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\tHWND hButton2 <span class=\"token operator\">=</span> <span class=\"token operator\">::</span><span class=\"token function\">GetDlgItem</span><span class=\"token punctuation\">(</span><span class=\"token function\">GetSafeHwnd</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> IDC_BTN_Test<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hButton2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t\t<span class=\"token operator\">::</span><span class=\"token function\">EnableWindow</span><span class=\"token punctuation\">(</span>hButton2<span class=\"token punctuation\">,</span> FALSE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token class-name\">CMFCCStringDlg</span><span class=\"token operator\">::</span><span class=\"token function\">OnBnClickedButton4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t<span class=\"token comment\">// TODO: 在此添加控件通知处理程序代码</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t<span class=\"token comment\">// 这次使用 MFC 的函数</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\tCWnd<span class=\"token operator\">*</span> pButtonCWnd <span class=\"token operator\">=</span> <span class=\"token function\">GetDlgItem</span><span class=\"token punctuation\">(</span>IDC_BTN_Test<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pButtonCWnd<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t\tpButtonCWnd<span class=\"token operator\">-></span><span class=\"token function\">EnableWindow</span><span class=\"token punctuation\">(</span>TRUE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\t\t<span class=\"token comment\">//::EnableWindow(pButtonCWnd->GetSafeHwnd(), TRUE);</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>点击之后变成了这样：</p>\n<p><img data-src=\"image002.png\" alt=\"\" /></p>\n<h2 id=\"绑定控件类型变量\"><a class=\"anchor\" href=\"#绑定控件类型变量\">#</a> 绑定控件类型变量</h2>\n<p>我们想对按钮控件启用或者禁用之前必须先获得按钮控件的窗口句柄，也就是说如果以后要对这个按钮控件进行任何操作，都得先获取他的窗口句柄，之后才能操作，也就是都得调用这句话：HWND hBtn = ::GetDlgItem (m_hWnd, IDC_BTN_1);</p>\n<p>比较麻烦，有什么简单点的办法吗？这就需要了解绑定控件类型变量了。</p>\n<p>选择控件对其点击右键， 选择添加变量，就会出现如下界面：</p>\n<p><img data-src=\"image003.png\" alt=\"\" /></p>\n<p>用看控件类型变量来实现上面的禁用操作：</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token class-name\">CMFCCStringDlg</span><span class=\"token operator\">::</span><span class=\"token function\">OnBnClickedButton3</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token comment\">// TODO: 在此添加控件通知处理程序代码</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token comment\">//// MFC 获取控件句柄</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token comment\">//// 此函数有两个重名的，在全局上有一个，在 MFC 中也有，我们这里调用全局的，加上全局作用域</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token comment\">//// win32 sdk api</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token comment\">//HWND hButton2 = ::GetDlgItem(GetSafeHwnd(), IDC_BTN_Test);</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token comment\">//if (hButton2)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token comment\">//&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token comment\">//\t::EnableWindow(hButton2, FALSE);</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token comment\">//&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\tBTN_Test<span class=\"token punctuation\">.</span><span class=\"token function\">EnableWindow</span><span class=\"token punctuation\">(</span>FALSE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token class-name\">CMFCCStringDlg</span><span class=\"token operator\">::</span><span class=\"token function\">OnBnClickedButton4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t<span class=\"token comment\">// TODO: 在此添加控件通知处理程序代码</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t<span class=\"token comment\">//// 这次使用 MFC 的函数</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t<span class=\"token comment\">//CWnd* pButtonCWnd = GetDlgItem(IDC_BTN_Test);</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t<span class=\"token comment\">//if (pButtonCWnd)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t<span class=\"token comment\">//&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\t<span class=\"token comment\">//\tpButtonCWnd->EnableWindow(TRUE);</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\t<span class=\"token comment\">//\t//::EnableWindow(pButtonCWnd->GetSafeHwnd(), TRUE);</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>\t<span class=\"token comment\">//&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\t<span class=\"token comment\">// 有缺省值 默认为 1</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\tBTN_Test<span class=\"token punctuation\">.</span><span class=\"token function\">EnableWindow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"控件的美化\"><a class=\"anchor\" href=\"#控件的美化\">#</a> 控件的美化</h2>\n<p>简单了解一下了。</p>\n<p>先把要设置的按钮行为属性中的 <strong>所有者描述</strong> 改为 TURE，英文是 Owner Draw。</p>\n<p><img data-src=\"image004.png\" alt=\"\" /></p>\n<p>因为要自己绘图，直接在网上用现成的了：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY29kZXByb2plY3QuY29tL0FydGljbGVzLzUwMzEvTWFraW5nLUNvb2wtQnV0dG9uLXVzaW5nLUltYWdlcw==\">https://www.codeproject.com/Articles/5031/Making-Cool-Button-using-Images</span></p>\n<p>结果如下：</p>\n<p><img data-src=\"image005.png\" alt=\"\" /></p>\n",
            "tags": [
                "button"
            ]
        }
    ]
}