{
    "version": "https://jsonfeed.org/version/1",
    "title": "Or0kit â€¢ All posts by \"çº¿ç¨‹ç›¸å…³api\" tag",
    "description": "ä¸´æ¸Šç¾¡é±¼ï¼Œä¸å¦‚é€€è€Œç»“ç½‘",
    "home_page_url": "https://Or0kit.github.io",
    "items": [
        {
            "id": "https://or0kit.github.io/Bin/Win32/Win%E7%BA%BF%E7%A8%8B/",
            "url": "https://or0kit.github.io/Bin/Win32/Win%E7%BA%BF%E7%A8%8B/",
            "title": "Winçº¿ç¨‹",
            "date_published": "2021-05-26T11:49:21.000Z",
            "content_html": "<h1 id=\"ä»€ä¹ˆæ˜¯çº¿ç¨‹\"><a class=\"anchor\" href=\"#ä»€ä¹ˆæ˜¯çº¿ç¨‹\">#</a> ä»€ä¹ˆæ˜¯çº¿ç¨‹</h1>\n<ul>\n<li>çº¿ç¨‹æ˜¯é™„å±åœ¨è¿›ç¨‹ä¸Šçš„æ‰§è¡Œå®ä½“ï¼Œæ˜¯ä»£ç çš„æ‰§è¡Œæµç¨‹</li>\n<li>ä¸€ä¸ªè¿›ç¨‹è¯¾ä»¥åŒ…å«å¤šä¸ªçº¿ç¨‹ï¼Œä½†ä¸€ä¸ªè¿›ç¨‹è‡³å°‘è¦åŒ…å«ä¸€ä¸ªçº¿ç¨‹ã€‚</li>\n</ul>\n<p>æ»´æ°´è€å¸ˆï¼šè¿›ç¨‹æ˜¯ä¸€ç§ç©ºé—´ä¸Šçš„æ¦‚å¿µï¼Œå®ƒä»£è¡¨çš„æ˜¯ 4GB çš„è™šæ‹Ÿå†…å­˜ã€‚çº¿ç¨‹æ˜¯ä¸€ç§æ—¶é—´ä¸Šçš„æ¦‚å¿µï¼Œçº¿ç¨‹å°±æ˜¯å½“å‰æ­£åœ¨è¿è¡Œçš„ä»£ç ã€‚</p>\n<h1 id=\"åˆ›å»ºçº¿ç¨‹\"><a class=\"anchor\" href=\"#åˆ›å»ºçº¿ç¨‹\">#</a> åˆ›å»ºçº¿ç¨‹</h1>\n<h2 id=\"createthreadå‡½æ•°\"><a class=\"anchor\" href=\"#createthreadå‡½æ•°\">#</a> CreateThread å‡½æ•°</h2>\n<p>è¿”å›å€¼ï¼šå‡½æ•°æˆåŠŸï¼Œè¿”å›çº¿ç¨‹å¥æŸ„ï¼›å‡½æ•°å¤±è´¥è¿”å› falseã€‚è‹¥ä¸æƒ³è¿”å›çº¿ç¨‹ ID, è®¾ç½®å€¼ä¸º NULLã€‚<br />\nå‡½æ•°è¯´æ˜ï¼š<br />\nåˆ›å»ºä¸€ä¸ªçº¿ç¨‹ã€‚<br />\nè¯­æ³•ï¼š<br />\n <code>hThread = CreateThread (&amp;security_attributes, dwStackSize, ThreadProc,pParam, dwFlags, &amp;idThread);</code></p>\n<p><img data-src=\"image001.png\" alt=\"\" /></p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>WINBASEAPI</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>_Ret_maybenull_</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>HANDLE</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>WINAPI</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">CreateThread</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t_In_opt_ LPSECURITY_ATTRIBUTES lpThreadAttributes<span class=\"token punctuation\">,</span>\t\t<span class=\"token comment\">// å®‰å…¨è®¾ç½®</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t_In_ SIZE_T dwStackSize<span class=\"token punctuation\">,</span>\t\t\t\t\t\t\t\t<span class=\"token comment\">// å †æ ˆå¤§å°</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t_In_ LPTHREAD_START_ROUTINE lpStartAddress<span class=\"token punctuation\">,</span>\t\t\t\t<span class=\"token comment\">// è¦æ‰§è¡Œçš„çº¿ç¨‹å‡½æ•°</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t_In_opt_ __drv_aliasesMem LPVOID lpParameter<span class=\"token punctuation\">,</span>\t\t\t<span class=\"token comment\">// è¦æ‰§è¡Œçš„çº¿ç¨‹å‡½æ•°çš„å‚æ•°ï¼Œç±»å‹ä¸º LPVOID</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t_In_ DWORD dwCreationFlags<span class=\"token punctuation\">,</span>\t\t\t\t\t\t\t\t<span class=\"token comment\">// å¯åŠ¨é€‰é¡¹</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t_Out_opt_ LPDWORD lpThreadId\t\t\t\t\t\t\t<span class=\"token comment\">// è¾“å‡ºçº¿ç¨‹ ID</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"token comment\">// å‡½æ•°è¿”å›çº¿ç¨‹çš„å¥æŸ„</span></pre></td></tr></table></figure><h2 id=\"å‚æ•°è¯´æ˜\"><a class=\"anchor\" href=\"#å‚æ•°è¯´æ˜\">#</a> å‚æ•°è¯´æ˜</h2>\n<p>å…³äºè¿™ä¸ªå‡½æ•°çš„è¯´æ˜ï¼Œç™¾åº¦ç™¾ç§‘å¾ˆè¯¦ç»†<span class=\"exturl\" data-url=\"aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS9DcmVhdGVUaHJlYWQvODIyMjY1Mg==\"> https://baike.baidu.com/item/CreateThread/8222652</span></p>\n<h3 id=\"lpthreadattributes\"><a class=\"anchor\" href=\"#lpthreadattributes\">#</a> lpThreadAttributes</h3>\n<p>lpThreadAttributesï¼šæŒ‡å‘ SECURITY_ATTRIBUTES å‹æ€çš„ç»“æ„çš„æŒ‡é’ˆã€‚åœ¨ Windows 98 ä¸­å¿½ç•¥è¯¥å‚æ•°ã€‚åœ¨ Windows NT ä¸­ï¼ŒNULL ä½¿ç”¨é»˜è®¤å®‰å…¨æ€§ï¼Œä¸å¯ä»¥è¢«å­çº¿ç¨‹ç»§æ‰¿ï¼Œå¦åˆ™éœ€è¦å®šä¹‰ä¸€ä¸ªç»“æ„ä½“å°†å®ƒçš„ bInheritHandle æˆå‘˜åˆå§‹åŒ–ä¸º TRUE<br />\ndwStackSizeï¼Œè®¾ç½®åˆå§‹æ ˆçš„å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œå¦‚æœä¸º 0ï¼Œé‚£ä¹ˆé»˜è®¤å°†ä½¿ç”¨ä¸è°ƒç”¨è¯¥å‡½æ•°çš„çº¿ç¨‹ç›¸åŒçš„æ ˆç©ºé—´å¤§å°ã€‚ä»»ä½•æƒ…å†µä¸‹ï¼ŒWindows æ ¹æ®éœ€è¦åŠ¨æ€å»¶é•¿å †æ ˆçš„å¤§å°ã€‚</p>\n<h3 id=\"lpstartaddress\"><a class=\"anchor\" href=\"#lpstartaddress\">#</a> lpStartAddress</h3>\n<p>lpStartAddressï¼ŒæŒ‡å‘çº¿ç¨‹å‡½æ•°çš„æŒ‡é’ˆï¼Œå½¢å¼ï¼š@å‡½æ•°åï¼Œå‡½æ•°åç§°æ²¡æœ‰é™åˆ¶ï¼Œ<br />\nçº¿ç¨‹æœ‰ä¸¤ç§å£°æ˜æ–¹å¼<br />\nï¼ˆ1ï¼‰DWORD WINAPI å‡½æ•°å (LPVOID lpParam); // æ ‡å‡†æ ¼å¼</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>DWORD WINAPI å‡½æ•°å <span class=\"token punctuation\">(</span>LPVOID lpParam<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">CreateThread</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> å‡½æ•°å<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰void å‡½æ•°å ();<br />\n ä½¿ç”¨ void å‡½æ•°å () æ­¤ç§çº¿ç¨‹å£°æ˜æ–¹å¼æ—¶ï¼ŒlpStartAddress éœ€è¦åŠ å…¥ LPTHREAD_START_ROUTINE è½¬æ¢ï¼Œå¦‚</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> å‡½æ•°å<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">CreateThread</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>LPTHREAD_START_ROUTINE<span class=\"token punctuation\">)</span>å‡½æ•°å<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"lpparameter\"><a class=\"anchor\" href=\"#lpparameter\">#</a> lpParameter</h3>\n<p>lpParameterï¼šå‘çº¿ç¨‹å‡½æ•°ä¼ é€’çš„å‚æ•°ï¼Œæ˜¯ä¸€ä¸ªæŒ‡å‘ç»“æ„çš„æŒ‡é’ˆï¼Œä¸éœ€ä¼ é€’å‚æ•°æ—¶ï¼Œä¸º NULLã€‚</p>\n<h3 id=\"dwcreationflags\"><a class=\"anchor\" href=\"#dwcreationflags\">#</a> dwCreationFlags</h3>\n<p>dwCreationFlags ï¼šçº¿ç¨‹æ ‡å¿—ï¼Œå¯å–å€¼å¦‚ä¸‹<br />\nï¼ˆ1ï¼‰CREATE_SUSPENDED (0x00000004)ï¼šåˆ›å»ºä¸€ä¸ªæŒ‚èµ·çš„çº¿ç¨‹ï¼Œ<br />\nï¼ˆ2ï¼‰0ï¼šè¡¨ç¤ºåˆ›å»ºåç«‹å³æ¿€æ´»ã€‚<br />\nï¼ˆ3ï¼‰STACK_SIZE_PARAM_IS_A_RESERVATION (0x00010000)ï¼šdwStackSize å‚æ•°æŒ‡å®šåˆå§‹çš„ä¿ç•™å †æ ˆ çš„å¤§å°ï¼Œå¦åˆ™ï¼ŒdwStackSize æŒ‡å®šæäº¤çš„å¤§å°ã€‚è¯¥æ ‡è®°å€¼åœ¨ Windows 2000/NT and Windows Me/98/95 ä¸Šä¸æ”¯æŒã€‚</p>\n<h3 id=\"lpthreadid\"><a class=\"anchor\" href=\"#lpthreadid\">#</a> lpThreadId</h3>\n<p>lpThreadId: ä¿å­˜æ–°çº¿ç¨‹çš„ idã€‚</p>\n<h2 id=\"å®ä¾‹ä»£ç \"><a class=\"anchor\" href=\"#å®ä¾‹ä»£ç \">#</a> å®ä¾‹ä»£ç </h2>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span><span class=\"token string\">&lt;iostream></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span><span class=\"token string\">&lt;stdlib.h></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span><span class=\"token string\">&lt;windows.h></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> std<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>DWORD WINAPI <span class=\"token function\">ThreadProc</span><span class=\"token punctuation\">(</span>LPVOID lpParameter<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token comment\">// å¼ºè½¬ä¼ é€’çš„å‚æ•°çš„ç±»å‹</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token keyword\">int</span><span class=\"token operator\">*</span> p <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>lpParameter<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token comment\">//cout &lt;&lt; *p &lt;&lt; endl;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token operator\">*</span>p<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t\t<span class=\"token function\">Sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t\tcout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"å­+++++\"</span> <span class=\"token operator\">&lt;&lt;</span> i <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\">// å‚æ•°</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">int</span> n <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\tHANDLE hThread <span class=\"token operator\">=</span> <span class=\"token function\">CreateThread</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> ThreadProc<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>LPVOID<span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>n<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\t<span class=\"token comment\">//1. è¿”å›çš„æ˜¯çº¿ç¨‹å¥æŸ„</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\t<span class=\"token comment\">//2. ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¦æ‰§è¡Œçš„çº¿ç¨‹å‡½æ•°</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\t<span class=\"token comment\">//3. ç¬¬å››ä¸ªå‚æ•°æ˜¯è¦æ‰§è¡Œçš„çº¿ç¨‹å‡½æ•°çš„å‚æ•°ï¼Œç±»å‹ä¸º LPVOID</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>\t<span class=\"token comment\">//hThread </span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\t<span class=\"token comment\">//cout &lt;&lt; hThread &lt;&lt; endl;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\t<span class=\"token function\">CloseHandle</span><span class=\"token punctuation\">(</span>hThread<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>\t\t<span class=\"token function\">Sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"çˆ¶------%d\\n\"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>\t<span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pause\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h1 id=\"çº¿ç¨‹æ§åˆ¶api\"><a class=\"anchor\" href=\"#çº¿ç¨‹æ§åˆ¶api\">#</a> çº¿ç¨‹æ§åˆ¶ API</h1>\n<h2 id=\"å¦‚ä½•è®©çº¿ç¨‹åœä¸‹æ¥\"><a class=\"anchor\" href=\"#å¦‚ä½•è®©çº¿ç¨‹åœä¸‹æ¥\">#</a> å¦‚ä½•è®©çº¿ç¨‹åœä¸‹æ¥</h2>\n<p>è®©è‡ªå·±åœä¸‹æ¥:<br />\n <code>Sleep()</code> <br />\n è®©åˆ«äººåœä¸‹æ¥:<br />\n <code>SuspendThread()</code> <br />\n çº¿ç¨‹æ¢å¤:<br />\n <code>ResumeThread()</code></p>\n<hr />\n<p><span class=\"label info\">ç¤ºä¾‹</span></p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span><span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span><span class=\"token string\">&lt;stdlib.h></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span><span class=\"token string\">&lt;windows.h></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>DWORD WINAPI <span class=\"token function\">ThreadProc</span><span class=\"token punctuation\">(</span>LPVOID lpParameter<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token keyword\">int</span><span class=\"token operator\">*</span> p <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>lpParameter<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token operator\">*</span>p<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t\t<span class=\"token function\">Sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"+++++%d \\n\"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">int</span> n <span class=\"token operator\">=</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\tHANDLE hThread<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\thThread <span class=\"token operator\">=</span> <span class=\"token function\">CreateThread</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> ThreadProc<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>LPVOID<span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>n<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t<span class=\"token function\">Sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">5000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t<span class=\"token function\">SuspendThread</span><span class=\"token punctuation\">(</span>hThread<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    <span class=\"token comment\">// æŒ‚èµ·çº¿ç¨‹</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t<span class=\"token function\">Sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">5000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\t<span class=\"token function\">ResumeThread</span><span class=\"token punctuation\">(</span>hThread<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t   <span class=\"token comment\">// æ¢å¤çº¿ç¨‹</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\t<span class=\"token function\">getchar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                 <span class=\"token comment\">// é˜²æ­¢ä¸»çº¿ç¨‹ç»“æŸ</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\t<span class=\"token function\">CloseHandle</span><span class=\"token punctuation\">(</span>hThread<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>\t<span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pause\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\t<span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"ç›¸å…³å‡½æ•°\"><a class=\"anchor\" href=\"#ç›¸å…³å‡½æ•°\">#</a> ç›¸å…³å‡½æ•°</h2>\n<p>åœ¨å¤šçº¿ç¨‹ä¸‹é¢ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ä¼šå¸Œæœ›ç­‰å¾…æŸä¸€çº¿ç¨‹å®Œæˆäº†å†ç»§ç»­åšå…¶ä»–äº‹æƒ…ï¼Œè¦å®ç°è¿™ä¸ªç›®çš„ï¼Œå¯ä»¥ä½¿ç”¨ Windows API å‡½æ•° <code>WaitForSingleObject</code> ï¼Œæˆ–è€… <code>WaitForMultipleObjects</code> ã€‚è¿™ä¸¤ä¸ªå‡½æ•°éƒ½ä¼šç­‰å¾…  <code>Object</code>  è¢«æ ‡ä¸ºæœ‰ä¿¡å· (signaled) æ—¶æ‰è¿”å›çš„ã€‚<br />\né‚£ä¹ˆï¼Œä»€ä¹ˆæ˜¯ä¿¡å·å‘¢ï¼Ÿ<br />\nç®€å•æ¥è¯´ï¼ŒWindows ä¸‹åˆ›å»ºçš„ <code>Object</code>  éƒ½ä¼šè¢«èµ‹äºˆä¸€ä¸ªçŠ¶æ€é‡ã€‚å¦‚æœ <code>Object</code>  è¢«æ¿€æ´»äº†ï¼Œæˆ–è€…æ­£åœ¨ä½¿ç”¨ï¼Œé‚£ä¹ˆè¯¥ <code>Object</code>  å°±æ˜¯æ— ä¿¡å·ï¼Œä¹Ÿå°±æ˜¯ä¸å¯ç”¨ï¼›å¦ä¸€æ–¹é¢ï¼Œå¦‚æœ <code>Object</code>  å¯ç”¨äº†ï¼Œé‚£ä¹ˆå®ƒå°±æ¢å¤æœ‰ä¿¡å·äº†ã€‚<br />\nè¿™ä¸¤ä¸ªå‡½æ•°çš„ä¼˜ç‚¹æ˜¯å®ƒä»¬åœ¨ç­‰å¾…çš„è¿‡ç¨‹ä¸­ä¼šè¿›å…¥ä¸€ä¸ªéå¸¸é«˜æ•ˆæ²‰ç¡çŠ¶æ€ï¼Œåªå ç”¨æå°‘çš„ CPU æ—¶é—´ç‰‡ã€‚ï¼ˆè¿™ä¸¤ä¸ªå‡½æ•°éƒ½æ˜¯åœ¨å†…æ ¸çŠ¶æ€ä¸‹ç­‰å¾…å†…æ ¸å¯¹è±¡ï¼Œä¸åˆ‡æ¢åˆ°ç”¨æˆ·æ¨¡å¼ä¸‹ï¼Œå› è€Œæ•ˆç‡å¾ˆé«˜ï¼‰</p>\n<h3 id=\"waitforsingleobject\"><a class=\"anchor\" href=\"#waitforsingleobject\">#</a> WaitForSingleObject</h3>\n<ol>\n<li>æ ¼å¼</li>\n</ol>\n<p><code>DWORD WaitForSingleObject( HANDLE hHandle, DWORDdwMilliseconds);</code></p>\n<p>æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ <code>THandle</code>  å’Œ <code>Timeout</code>  (æ¯«ç§’å•ä½)ã€‚</p>\n<p>å¦‚æœæƒ³è¦ç­‰å¾…ä¸€æ¡çº¿ç¨‹ï¼Œé‚£ä¹ˆä½ éœ€è¦æŒ‡å®šçº¿ç¨‹çš„ <code>Handle</code> ï¼Œä»¥åŠç›¸åº”çš„ <code>Timeout</code>  æ—¶é—´ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æƒ³æ— é™ç­‰å¾…ä¸‹å»ï¼Œ <code>Timeout</code>  å‚æ•°å¯ä»¥æŒ‡å®šç³»ç»Ÿå¸¸é‡ <code>INFINITE</code> ã€‚</p>\n<ol start=\"2\">\n<li>ä½¿ç”¨å¯¹è±¡</li>\n</ol>\n<p>å®ƒå¯ä»¥ç­‰å¾…å¦‚ä¸‹å‡ ç§ç±»å‹çš„å¯¹è±¡ï¼š</p>\n<p><code>Event</code> ï¼Œ <code>Mutex</code> ï¼Œ <code>Semaphore</code> ï¼Œ <code>Process</code> ï¼Œ <code>Thread</code></p>\n<ol start=\"3\">\n<li>è¿”å›ç±»å‹</li>\n</ol>\n<p>æœ‰ä¸‰ç§è¿”å›ç±»å‹ï¼š</p>\n<p><code>WAIT_OBJECT_0</code> , è¡¨ç¤ºç­‰å¾…çš„å¯¹è±¡æœ‰ä¿¡å·ï¼ˆå¯¹çº¿ç¨‹æ¥è¯´ï¼Œè¡¨ç¤ºæ‰§è¡Œç»“æŸï¼‰ï¼›</p>\n<p><code>WAIT_TIMEOUT</code> , è¡¨ç¤ºç­‰å¾…æŒ‡å®šæ—¶é—´å†…ï¼Œå¯¹è±¡ä¸€ç›´æ²¡æœ‰ä¿¡å·ï¼ˆçº¿ç¨‹æ²¡æ‰§è¡Œå®Œï¼‰ï¼›</p>\n<p><code>WAIT_ABANDONED</code>  è¡¨ç¤ºå¯¹è±¡æœ‰ä¿¡å·ï¼Œä½†è¿˜æ˜¯ä¸èƒ½æ‰§è¡Œ Â ä¸€èˆ¬æ˜¯å› ä¸ºæœªè·å–åˆ°é”æˆ–å…¶ä»–åŸå› </p>\n<hr />\n<p><span class=\"label info\">ç¤ºä¾‹</span></p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;windows.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;iostream.h></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre> </pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// å£°æ˜å‡½æ•°  åˆ›å»ºçº¿ç¨‹</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>DWORD WINAPI <span class=\"token function\">FunProc</span><span class=\"token punctuation\">(</span> LPVOID lpParameter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"7\"></td><td><pre> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\tHANDLE hThread<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\thThread<span class=\"token operator\">=</span><span class=\"token function\">CreateThread</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>FunProc<span class=\"token punctuation\">,</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\tDWORD dwRet<span class=\"token operator\">=</span><span class=\"token function\">WaitForSingleObject</span><span class=\"token punctuation\">(</span>hThread<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>dwRet<span class=\"token operator\">==</span>WAIT_OBJECT_0<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"åˆ›å»ºçš„çº¿ç¨‹æ‰§è¡Œç»“æŸ\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>dwRet<span class=\"token operator\">==</span>WAIT_TIMEOUT<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ç­‰å¾…è¶…æ—¶\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>dwRet<span class=\"token operator\">==</span>WAIT_ABANDONED<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Abandoned\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t<span class=\"token function\">CloseHandle</span><span class=\"token punctuation\">(</span>hThread<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre> </pre></td></tr><tr><td data-num=\"28\"></td><td><pre>DWORD WINAPI <span class=\"token function\">FunProc</span><span class=\"token punctuation\">(</span> LPVOID lpParameter <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token punctuation\">&#123;</span>\t</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\t<span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>\t<span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span><span class=\"token number\">1000</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d  \"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span> <span class=\"token punctuation\">(</span>i<span class=\"token operator\">%</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\t\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"waitformultipleobjecct\"><a class=\"anchor\" href=\"#waitformultipleobjecct\">#</a> WaitForMultipleObjecct</h3>\n<p>ç›¸å¯¹æ¥è¯´ï¼Œ <code>WaitForMultipleObjects</code>  è¦å¤æ‚ç‚¹ç‚¹</p>\n<p>æ ¼å¼ä¸ºï¼š</p>\n<p><code>DWORD WaitForMultipleObjects(DWORD nCount, CONST HANDLE *lpHandles, BOOL bWaitAll, DWORD dwMilliseconds);</code></p>\n<p>å››ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ï¼š</p>\n<ol>\n<li><code>nCount</code> ï¼ŒDWORD ç±»å‹ï¼Œç”¨äºæŒ‡å®šå¥æŸ„æ•°ç»„çš„æ•°é‡</li>\n<li><code>lphObjects</code> ï¼ŒPointer ç±»å‹ï¼Œç”¨äºæŒ‡å®šå¥æŸ„æ•°ç»„çš„å†…å­˜åœ°å€</li>\n<li><code>bWaitAll</code> ï¼ŒBool ç±»å‹ï¼Œ  <code>TRUE</code>  è¡¨ç¤ºå‡½æ•°ç­‰å¾…æ‰€æœ‰æŒ‡å®šå¥æŸ„çš„ <code>Object</code>  æœ‰ä¿¡å·ä¸ºæ­¢ï¼Œ <code>FALSE</code>  å½“æœ‰å…¶ä¸­ä¸€ä¸ªä¿¡å·é‡æœ‰æ•ˆæ—¶å°±å‘ä¸‹æ‰§è¡Œ</li>\n<li><code>dwTimeout</code> ï¼ŒDWORD ç±»å‹ï¼Œç”¨äºæŒ‡å®šç­‰å¾…çš„ Timeout æ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼Œå¯ä»¥æ˜¯ <code>INFINITE</code></li>\n</ol>\n<hr />\n<p><span class=\"label info\">ç¤ºä¾‹</span></p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;windows.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;iostream></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// å£°æ˜å‡½æ•°  åˆ›å»ºçº¿ç¨‹</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>DWORD WINAPI <span class=\"token function\">FunProc</span><span class=\"token punctuation\">(</span>LPVOID lpParameter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>DWORD WINAPI <span class=\"token function\">FunProc1</span><span class=\"token punctuation\">(</span>LPVOID lpParameter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\tHANDLE hThread<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\thThread<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">CreateThread</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> FunProc<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\thThread<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">CreateThread</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> FunProc1<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t<span class=\"token function\">WaitForMultipleObjects</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> hThread<span class=\"token punctuation\">,</span> TRUE<span class=\"token punctuation\">,</span> INFINITE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token comment\">// çº¿ç¨‹æ‰§è¡Œç»“æŸåæ‰“å°</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\tstd<span class=\"token operator\">::</span>cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"End of thread execution!!!\"</span> <span class=\"token operator\">&lt;&lt;</span> std<span class=\"token operator\">::</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t<span class=\"token function\">CloseHandle</span><span class=\"token punctuation\">(</span>hThread<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t<span class=\"token function\">CloseHandle</span><span class=\"token punctuation\">(</span>hThread<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>DWORD WINAPI <span class=\"token function\">FunProc</span><span class=\"token punctuation\">(</span>LPVOID lpParameter<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\t<span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"**************%d  \\n\"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>DWORD WINAPI <span class=\"token function\">FunProc1</span><span class=\"token punctuation\">(</span>LPVOID lpParameter<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\t<span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-------------%d  \\n\"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"terminatethread\"><a class=\"anchor\" href=\"#terminatethread\">#</a> TerminateThread</h3>\n<p>TerminateThread åœ¨çº¿ç¨‹å¤–ç»ˆæ­¢ä¸€ä¸ªçº¿ç¨‹ï¼Œç”¨äºå¼ºåˆ¶ç»ˆæ­¢çº¿ç¨‹ã€‚</p>\n<h4 id=\"å£°æ˜\"><a class=\"anchor\" href=\"#å£°æ˜\">#</a> å£°æ˜</h4>\n<p><code>BOOLTerminateThread( HANDLEhThread,DWORDdwExitCode);</code></p>\n<h4 id=\"å‚æ•°è¯¦è§£\"><a class=\"anchor\" href=\"#å‚æ•°è¯¦è§£\">#</a> å‚æ•°è¯¦è§£</h4>\n<p><code>HANDLE hThread</code> ï¼šè¢«ç»ˆæ­¢çš„çº¿ç¨‹çš„å¥æŸ„ï¼Œä¸º <code>CWinThread</code>  æŒ‡é’ˆã€‚<br />\n <code>DWORD dwExitCode</code> ï¼šé€€å‡ºç ã€‚</p>\n<h4 id=\"è¿”å›å€¼\"><a class=\"anchor\" href=\"#è¿”å›å€¼\">#</a> è¿”å›å€¼</h4>\n<p>å‡½æ•°æ‰§è¡ŒæˆåŠŸåˆ™è¿”å›éé›¶å€¼ï¼Œæ‰§è¡Œå¤±è´¥è¿”å› 0ã€‚è°ƒç”¨ GetLastError è·å¾—è¿”å›çš„å€¼ã€‚</p>\n<hr />\n<p><span class=\"label danger\">ğŸ’”æ³¨æ„</span><br />\n TerminateThread å¼ºçƒˆä¸å»ºè®®ä½¿ç”¨ï¼Œå› ä¸ºè¿™ä¸ªå‡½æ•°çš„æ‰§è¡Œæ˜¯å¼‚æ­¥çš„ï¼Œ<br />\nä½ æ— æ³•ä¿è¯è°ƒç”¨ä¹‹åä¼šç«‹å³é€€å‡ºï¼ŒåŒæ—¶çº¿ç¨‹çš„å †æ ˆå‡ä¸ä¼šè¢«é”€æ¯ï¼Œ<br />\nå¯¼è‡´å†…å­˜æ³„éœ²ã€‚å¦‚æœè°ƒç”¨äº†è¿™ä¸ªå‡½æ•°ï¼Œè¯·ç¡®ä¿ä½¿ç”¨ WaitForSingleObject æ¥ç­‰å¾…çº¿ç¨‹å¯¹è±¡çš„ç»“æŸã€‚</p>\n<h3 id=\"getexitcodethread\"><a class=\"anchor\" href=\"#getexitcodethread\">#</a> GetExitCodeThread</h3>\n<p>GetExitCodeThread () å°†ä¼ å›çº¿ç¨‹å‡½æ•°çš„è¿”å›å€¼ã€‚ç„¶è€Œï¼ŒGetExitCodeThread () çš„ä¸€ä¸ªç³Ÿç³•è¡Œä¸ºæ˜¯ï¼Œå½“çº¿ç¨‹è¿˜åœ¨è¿›è¡Œï¼Œå°šæœªæœ‰æ‰€è°“ç»“æŸä»£ç æ—¶ï¼Œå®ƒä¼šä¼ å› TRUE è¡¨ç¤ºæˆåŠŸã€‚å¦‚æœè¿™æ ·ï¼ŒIpExitCode æŒ‡å‘çš„å†…å­˜åŒºåŸŸä¸­åº”è¯¥æ”¾çš„æ˜¯ STILL-ACTIVE, ä½ å¿…é¡»å°å¿ƒè¿™ç§è¡Œä¸ºï¼Œä¹Ÿå°±æ˜¯è¯´ä½ ä¸å¯èƒ½ä»å…¶è¿”å›å€¼ä¸­çŸ¥é“ â€œåˆ°åº•æ˜¯çº¿ç¨‹è¿˜åœ¨è¿è¡Œå‘¢ï¼Œè¿˜æ˜¯å®ƒå·²ç»“æŸï¼Œä½†è¿”å›å€¼ä¸º STILL_ACTIVEâ€ã€‚</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>BOOL   <span class=\"token function\">GetExitCodeThread</span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>HANDLE    hThread<span class=\"token punctuation\">,</span>                 <span class=\"token comment\">//in, çº¿ç¨‹ handle, ä¹Ÿå°±æ˜¯ CreateThread () çš„è¿”å›å€¼</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>LPDWORD   lpExitCode               <span class=\"token comment\">//out, å­˜å‚¨çº¿ç¨‹ç»“æŸä»£ç ï¼Œä¹Ÿå°±æ˜¯çº¿ç¨‹çš„è¿”å›å€¼</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>è¯´æ˜ï¼šæ­¤å‡½æ•°è°ƒç”¨æˆåŠŸè¿”å› <code>TRUE</code> , å¤±è´¥è¿”å› <code>FALSE</code> , åªè¡¨ç¤ºè¿™ä¸ªå‡½æ•°æ˜¯å¦è°ƒç”¨æˆåŠŸè€Œå·±ï¼Œä¸èƒ½æ ¹æ®è¿”å›å€¼æ¥åˆ¤æ–­ä¸€ä¸ªçº¿ç¨‹æ˜¯å¦ç»“æŸï¼Œè€Œè¦æ ¹æ® <code>lpExitCode</code>  çš„å€¼æ¥ç¡®å®šã€‚</p>\n<p><code>lpExitCode</code>  å€¼ä¸º <code>STILL_ACTIVE</code>  è¡¨ç¤ºçº¿ç¨‹æ­£åœ¨è¿è¡Œï¼Œè‹¥çº¿ç¨‹å·±ç»ç»“æŸï¼Œåˆ™ <code>lpExitCode</code>  ä¸­å­˜å‚¨æŒ‡å®šçº¿ç¨‹çš„è¿”å›å€¼.</p>\n<hr />\n<p><span class=\"label info\">ç¤ºä¾‹</span></p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;windows.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;iostream></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// å£°æ˜å‡½æ•°  åˆ›å»ºçº¿ç¨‹</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>DWORD WINAPI <span class=\"token function\">FunProc</span><span class=\"token punctuation\">(</span>LPVOID lpParameter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>DWORD WINAPI <span class=\"token function\">FunProc1</span><span class=\"token punctuation\">(</span>LPVOID lpParameter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\tHANDLE hThread<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\tDWORD  dwResult<span class=\"token punctuation\">,</span> dwResult1<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\thThread<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">CreateThread</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> FunProc<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\thThread<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">CreateThread</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> FunProc1<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token function\">WaitForMultipleObjects</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> hThread<span class=\"token punctuation\">,</span> TRUE<span class=\"token punctuation\">,</span> INFINITE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t<span class=\"token function\">GetExitCodeThread</span><span class=\"token punctuation\">(</span>hThread<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>dwResult<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t<span class=\"token function\">GetExitCodeThread</span><span class=\"token punctuation\">(</span>hThread<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>dwResult1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t<span class=\"token comment\">// çº¿ç¨‹æ‰§è¡Œç»“æŸåæ‰“å°</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\tstd<span class=\"token operator\">::</span>cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"End of thread execution!!!\"</span> <span class=\"token operator\">&lt;&lt;</span> std<span class=\"token operator\">::</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\t<span class=\"token comment\">// æ‰“å°è¿”å›å€¼</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\tstd<span class=\"token operator\">::</span>cout <span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">\"Thread return: \"</span><span class=\"token operator\">&lt;&lt;</span> dwResult <span class=\"token operator\">&lt;&lt;</span> std<span class=\"token operator\">::</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\tstd<span class=\"token operator\">::</span>cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"Thread1 return: \"</span> <span class=\"token operator\">&lt;&lt;</span> dwResult1 <span class=\"token operator\">&lt;&lt;</span> std<span class=\"token operator\">::</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>\t<span class=\"token function\">CloseHandle</span><span class=\"token punctuation\">(</span>hThread<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>\t<span class=\"token function\">CloseHandle</span><span class=\"token punctuation\">(</span>hThread<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>DWORD WINAPI <span class=\"token function\">FunProc</span><span class=\"token punctuation\">(</span>LPVOID lpParameter<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>\t<span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"**************%d  \\n\"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>DWORD WINAPI <span class=\"token function\">FunProc1</span><span class=\"token punctuation\">(</span>LPVOID lpParameter<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>\t<span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-------------%d  \\n\"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h1 id=\"context-ç»“æ„ä½“\"><a class=\"anchor\" href=\"#context-ç»“æ„ä½“\">#</a> CONTEXT ç»“æ„ä½“</h1>\n<p>å½“çº¿ç¨‹è¿›è¡Œåˆ‡æ¢çš„æ—¶å€™ï¼Œä¸Šä¸€ä¸ªæœªæ‰§è¡Œå®Œæ¯•çš„çº¿ç¨‹çš„çŠ¶æ€ä¼šä¿å­˜åœ¨ CONTEXT ç»“æ„ä½“ä¸­ã€‚</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_CONTEXT</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    DWORD           ContextFlags    <span class=\"token comment\">// -|               +00h</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    DWORD           Dr0             <span class=\"token comment\">//  |               +04h</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    DWORD           Dr1             <span class=\"token comment\">//  |               +08h</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    DWORD           Dr2             <span class=\"token comment\">//  > è°ƒè¯•å¯„å­˜å™¨     +0Ch</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    DWORD           Dr3             <span class=\"token comment\">//  |               +10h</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    DWORD           Dr6             <span class=\"token comment\">//  |               +14h</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    DWORD           Dr7             <span class=\"token comment\">// -|               +18h</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    FLOATING_SAVE_AREA FloatSave<span class=\"token punctuation\">;</span>   <span class=\"token comment\">// æµ®ç‚¹å¯„å­˜å™¨åŒº      +1Ch~~~88h</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    DWORD           SegGs           <span class=\"token comment\">//-|                +8Ch</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    DWORD           SegFs           <span class=\"token comment\">// |\\ æ®µå¯„å­˜å™¨       +90h</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    DWORD           SegEs           <span class=\"token comment\">// |/               +94h</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    DWORD           SegDs           <span class=\"token comment\">//-|                +98h</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    DWORD           Edi             <span class=\"token comment\">//________          +9Ch</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    DWORD           Esi             <span class=\"token comment\">// |  é€šç”¨          +A0h</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    DWORD           Ebx             <span class=\"token comment\">// |   å¯„           +A4h</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    DWORD           Edx             <span class=\"token comment\">// |   å­˜           +A8h</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    DWORD           Ecx             <span class=\"token comment\">// |   å™¨           +ACh</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    DWORD           Eax             <span class=\"token comment\">//_|___ç»„_          +B0h</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    DWORD           Ebp             <span class=\"token comment\">//++++++            +B4h</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    DWORD           Eip             <span class=\"token comment\">// | æ§åˆ¶            +B8h</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    DWORD           SegCs           <span class=\"token comment\">// | å¯„å­˜            +BCh</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    DWORD           EFlag           <span class=\"token comment\">// | å™¨ç»„            +C0h</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    DWORD           Esp             <span class=\"token comment\">// |                +C4h</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    DWORD           SegSs           <span class=\"token comment\">//++++++            +C8h</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    BYTE    ExtendedRegisters<span class=\"token punctuation\">[</span>MAXIMUM_SUPPORTED_EXTENSION<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token punctuation\">&#125;</span> CONTEXT<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token keyword\">typedef</span>     CONTEXT     <span class=\"token operator\">*</span>PCONTEXT<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span>     <span class=\"token macro-name\">MAXIMUM_SUPPORTED_EXTENSION</span>     <span class=\"token expression\"><span class=\"token number\">512</span></span></span></pre></td></tr></table></figure><h2 id=\"è·å–å’Œè®¾ç½®çº¿ç¨‹ä¸Šä¸‹æ–‡\"><a class=\"anchor\" href=\"#è·å–å’Œè®¾ç½®çº¿ç¨‹ä¸Šä¸‹æ–‡\">#</a> è·å–å’Œè®¾ç½®çº¿ç¨‹ä¸Šä¸‹æ–‡</h2>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// è·å–</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>BOOL <span class=\"token function\">GetThreadContext</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tHANDLE hThread<span class=\"token punctuation\">,</span> \t\t<span class=\"token comment\">// handle to thread with context</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tLPCONTEXT IpContext \t<span class=\"token comment\">// context structure</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// è®¾ç½®</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>BOOL <span class=\"token function\">SetThreadContext</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\tHANDLE hThread<span class=\"token punctuation\">,</span>\t     \t<span class=\"token comment\">// handle to thread</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\tCONST CONTEXT <span class=\"token operator\">*</span>lpContext    <span class=\"token comment\">//context structure</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;windows.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">// å£°æ˜å‡½æ•°  åˆ›å»ºçº¿ç¨‹</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>DWORD WINAPI <span class=\"token function\">FunProc</span><span class=\"token punctuation\">(</span>LPVOID lpParameter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>DWORD WINAPI <span class=\"token function\">FunProc1</span><span class=\"token punctuation\">(</span>LPVOID lpParameter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\tHANDLE hThread<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\tCONTEXT context<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\thThread<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">CreateThread</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> FunProc<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\thThread<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">CreateThread</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> FunProc1<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token function\">SuspendThread</span><span class=\"token punctuation\">(</span>hThread<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t<span class=\"token comment\">// éœ€è¦å“ªä¸ªå€¼èµ‹ç»™å“ªä¸ªå€¼</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\tcontext<span class=\"token punctuation\">.</span>ContextFlags <span class=\"token operator\">=</span> CONTEXT_INTEGER<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t<span class=\"token function\">GetThreadContext</span><span class=\"token punctuation\">(</span>hThread<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>context<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"EAX:%#X\\nECX:%#X\\n\"</span><span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">.</span>Eax<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">.</span>Ecx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t<span class=\"token function\">CloseHandle</span><span class=\"token punctuation\">(</span>hThread<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\t<span class=\"token function\">CloseHandle</span><span class=\"token punctuation\">(</span>hThread<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>DWORD WINAPI <span class=\"token function\">FunProc</span><span class=\"token punctuation\">(</span>LPVOID lpParameter<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\t<span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"**************%d  \\n\"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>DWORD WINAPI <span class=\"token function\">FunProc1</span><span class=\"token punctuation\">(</span>LPVOID lpParameter<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>\t<span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-------------%d  \\n\"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h1 id=\"reference\"><a class=\"anchor\" href=\"#reference\">#</a> Reference</h1>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3hpYW9iYWkxNTkzL2FydGljbGUvZGV0YWlscy82NjcyMTkz\">https://blog.csdn.net/xiaobai1593/article/details/6672193</span></p>\n",
            "tags": [
                "åˆ›å»ºçº¿ç¨‹",
                "çº¿ç¨‹æ§åˆ¶",
                "çº¿ç¨‹ç›¸å…³API",
                "çº¿ç¨‹ä¸Šä¸‹æ–‡",
                "CONTEXTç»“æ„ä½“"
            ]
        }
    ]
}