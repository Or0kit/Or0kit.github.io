{
    "version": "https://jsonfeed.org/version/1",
    "title": "Or0kit • All posts by \"centos7配置vsftp\" tag",
    "description": "临渊羡鱼，不如退而结网",
    "home_page_url": "https://Or0kit.github.io",
    "items": [
        {
            "id": "https://or0kit.github.io/Linux/Linux%E9%85%8D%E7%BD%AEvsftp/",
            "url": "https://or0kit.github.io/Linux/Linux%E9%85%8D%E7%BD%AEvsftp/",
            "title": "Linux配置vsftp",
            "date_published": "2021-04-20T02:41:51.000Z",
            "content_html": "<h1 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h1>\n<p>Linux 网络服务课的作业。虽然简单，但也让我踩了不少坑，记个笔记吧。<br />\n作业的内容是可以匿名上传或删除文件就可。</p>\n<h1 id=\"正文\"><a class=\"anchor\" href=\"#正文\">#</a> 正文</h1>\n<p>先换个 yum 的源，下载的快一点。<br />\n <code>wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</code></p>\n<p>换源前也可以先备份一下。<br />\n这里的详细内容可以参考<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3d1ZGluYW5peWEvYXJ0aWNsZS9kZXRhaWxzLzEwNTc1ODczOQ==\"> https://blog.csdn.net/wudinaniya/article/details/105758739</span></p>\n<h2 id=\"下载vsftp\"><a class=\"anchor\" href=\"#下载vsftp\">#</a> 下载 vsftp</h2>\n<p><code>yum -y install vsftpd</code></p>\n<h2 id=\"查看是否安装成功\"><a class=\"anchor\" href=\"#查看是否安装成功\">#</a> 查看是否安装成功</h2>\n<p><code>rpm -qa|grep vsftpd</code></p>\n<h2 id=\"关闭一切墙策略selinux\"><a class=\"anchor\" href=\"#关闭一切墙策略selinux\">#</a> 关闭一切墙 | 策略 | SELINUX</h2>\n<p><code>systemctl stop firewalld</code> <br />\n <code>iptables -F</code></p>\n<p>关闭 SELINUX，有两种方法：<br />\n临时关闭：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># getenforce</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Enforcing</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># setenforce 0</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># getenforce</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>Permissive</pre></td></tr></table></figure><p>永久关闭：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># vim /etc/sysconfig/selinux</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token assign-left variable\">SELINUX</span><span class=\"token operator\">=</span>enforcing 改为 <span class=\"token assign-left variable\">SELINUX</span><span class=\"token operator\">=</span>disabled</pre></td></tr></table></figure><p>重启服务 reboot</p>\n<h2 id=\"修改vsftpdconfig\"><a class=\"anchor\" href=\"#修改vsftpdconfig\">#</a> 修改 vsftpd.config</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>修改配置文件 /etc/vsftpd.conf</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token assign-left variable\">anonymous_enable</span><span class=\"token operator\">=</span>YES  <span class=\"token comment\"># 允许匿名访问</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token assign-left variable\">write_enable</span><span class=\"token operator\">=</span>YES  <span class=\"token comment\"># 允许写文件</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token assign-left variable\">anon_upload_enable</span><span class=\"token operator\">=</span>YES  <span class=\"token comment\"># 允许匿名用户上传文件</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token assign-left variable\">anon_mkdir_write_enable</span><span class=\"token operator\">=</span>YES  <span class=\"token comment\"># 允许匿名用户创建目录和写权限</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token assign-left variable\">anon_other_write_enable</span><span class=\"token operator\">=</span>YES  <span class=\"token comment\"># 允许匿名用户删除、重命名等其它权限  这个在配置文件里默认找不到</span></pre></td></tr></table></figure><h2 id=\"这里附上详细的vsftpconfig配置\"><a class=\"anchor\" href=\"#这里附上详细的vsftpconfig配置\">#</a> 这里附上详细的 vsftp.config 配置</h2>\n<p>vsftpd 的配置文件在为 vsftpd.conf，一般在 /etc/vsftpd/ 目录下。</p>\n<table>\n    <tr>\n        <th>属性</th>\n        <th>属性值</th>\n        <th align=\"left\">含义</th>\n    </tr>\n    <tr>\n        <td>anonymous_enable</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">是否允许匿名用户（anonymous）登录 <code>FTP</code>，如果该设置被注释，则默认允许</td>\n    </tr>\n    <tr>\n        <td>local_enable</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">是否允许本地系统用户登录</td>\n    </tr>\n    <tr>\n        <td>write_enable</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">是否开启任何形式的 <code>FTP</code> 写入命令，上传文件</td>\n    </tr>\n    <tr>\n        <td>local_umask</td>\n        <td>xxx</td>\n        <td align=\"left\">本地用户的 <code>umask</code> 设置，如果注释该设置则默认为 <code>077</code>，但一般都设置成 <code>022</code></td>\n    </tr>\n    <tr>\n        <td>anon_upload_enable</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">是否允许匿名用户上传文件，如果要设置为允许，则需要先开启 <code>write_enable</code>，否则无效，此外对应目录还要具有写权限</td>\n    </tr>\n    <tr>\n        <td>anon_mkdir_write_enable</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">是否允许匿名用户创建新目录</td>\n    </tr>\n    <tr>\n        <td>dirmessage_enable</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">当进入某个目录时，发送信息提示给远程用户</td>\n    </tr>\n    <tr>\n        <td>xferlog_enable</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">是否开启 上传/下载 的日志记录</td>\n    </tr>\n    <tr>\n        <td>connect_from_port_20</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">是否使用 <code>20</code> 端口来连接 <code>FTP</code></td>\n    </tr>\n    <tr>\n        <td>chown_uploads</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">匿名上传的文件是否由某一指定用户 <code>chown_username</code> 所有</td>\n    </tr>\n    <tr>\n        <td>chown_username</td>\n        <td>有效用户名</td>\n        <td align=\"left\">匿名上传的文件由该设定用户所有</td>\n    </tr>\n    <tr>\n        <td>xferlog_file</td>\n        <td>有效路径</td>\n        <td align=\"left\">设置日志文件的保存位置，默认为 <code>/var/log/xferlog</code></td>\n    </tr>\n    <tr>\n        <td>xferlog_std_format</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">是否使用标准的 <code>ftpd xferlog</code>日志格式，该格式日志默认保存在 <code>/var/log/xferlog</code></td>\n    </tr>\n    <tr>\n        <td>idle_session_timeout</td>\n        <td>数值</td>\n        <td align=\"left\">设置空闲连接的超时时间，单位 秒</td>\n    </tr>\n    <tr>\n        <td>data_connection_timeout</td>\n        <td>数值</td>\n        <td align=\"left\">设置等待数据传输的最大时间，单位 秒（<code>data_connection_timeout</code> 与 <code>idle_session_timeout</code>\n            在同一时间只有一个有效）\n        </td>\n    </tr>\n    <tr>\n        <td>nopriv_user</td>\n        <td>有效用户名</td>\n        <td align=\"left\">指定一个非特权用户，用于运行 <code>vsftpd</code></td>\n    </tr>\n    <tr>\n        <td>async_abor_enable</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">是否支持异步 <code>ABOR</code> 请求</td>\n    </tr>\n    <tr>\n        <td>ascii_upload_enable</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">是否开启 <code>ASCII</code> 模式进行文件上传，一般不开启</td>\n    </tr>\n    <tr>\n        <td>ascii_download_enable</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">是否开启 <code>ASCII</code> 模式进行文件下载，一般不开启</td>\n    </tr>\n    <tr>\n        <td>ftpd_banner</td>\n        <td>…</td>\n        <td align=\"left\">自定义登录标语</td>\n    </tr>\n    <tr>\n        <td>deny_email_enable</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">如果匿名登录，则会要求输入 email 地址，如果不希望一些 email 地址具有登录权限，则可以开启此项，并在 <code>banned_email_file</code>\n            指定的文件中写入对应的 email 地址\n        </td>\n    </tr>\n    <tr>\n        <td>banned_email_file</td>\n        <td>有效文件</td>\n        <td align=\"left\">当开启 <code>deny_email_enable</code> 时，需要通过此项指定一个保存登录无效 email 的文件</td>\n    </tr>\n    <tr>\n        <td>chroot_local_user</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">是否将所有用户限制在主目录，当为 <code>NO</code> 时， <code>FTP</code> 用户可以切换到其他目录</td>\n    </tr>\n    <tr>\n        <td>chroot_list_enable</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">是否启用限制用户的名单列表</td>\n    </tr>\n    <tr>\n        <td>chroot_list_file</td>\n        <td>有效文件</td>\n        <td align=\"left\">用户列表，其作用与 <code>chroot_local_user</code> 和 <code>chroot_local_user</code> 的组合有关，详见下表</td>\n    </tr>\n    <tr>\n        <td>allow_writeable_chroot</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">是否允许用户对 ftp 根目录具有写权限，如果设置成不允许而目录实际上却具备写权限，则会报错</td>\n    </tr>\n    <tr>\n        <td>ls_recurse_enable</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">是否允许 <code>ls -R</code> 指令来递归查询，递归查询比较耗资源</td>\n    </tr>\n    <tr>\n        <td>listen</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">如果为 <code>YES</code>，<code>vsftpd</code> 将以独立模式运行并监听 <code>IPv4</code> 的套接字，处理相关连接请求（该指令不能与\n            <code>listen_ipv6</code> 一起使用）\n        </td>\n    </tr>\n    <tr>\n        <td>listen_ipv6</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">是否允许监听 <code>IPv6</code> 套接字</td>\n    </tr>\n    <tr>\n        <td>pam_service_name</td>\n        <td>…</td>\n        <td align=\"left\">设置 <code>PAM</code> 外挂模块提供的认证服务所使用的配置文件名 ，即 <code>/etc/pam.d/vsftpd</code> 文件，此文件中 <code>file=/etc/vsftpd/ftpusers</code>\n            字段，说明了 <code>PAM</code> 模块能抵挡的帐号内容来自文件 <code>/etc/vsftpd/ftpusers</code> 中\n        </td>\n    </tr>\n    <tr>\n        <td>userlist_enable</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">是否启用 <code>user_list</code> 文件来控制用户登录</td>\n    </tr>\n    <tr>\n        <td>userlist_deny</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">是否拒绝 <code>user_list</code> 中的用户登录，此属性设置需在 <code>userlist_enable = YES</code> 时才有效</td>\n    </tr>\n    <tr>\n        <td>tcp_wrappers</td>\n        <td><code>YES</code>/<code>NO</code></td>\n        <td align=\"left\">是否使用 <code>tcp_wrappers</code> 作为主机访问控制方式</td>\n    </tr>\n    <tr>\n        <td>max_clients</td>\n        <td>数值</td>\n        <td align=\"left\">同一时间允许的最大连接数</td>\n    </tr>\n    <tr>\n        <td>max_per_ip</td>\n        <td>数值</td>\n        <td align=\"left\">同一个IP客户端连接的最大值</td>\n    </tr>\n    <tr>\n        <td>local_root</td>\n        <td>有效目录</td>\n        <td align=\"left\">系统用户登录后的根目录</td>\n    </tr>\n    <tr>\n        <td>anon_root</td>\n        <td>有效目录</td>\n        <td align=\"left\">匿名用户登录后的根目录</td>\n    </tr>\n    <tr>\n        <td>user_config_dir</td>\n        <td>有效目录</td>\n        <td align=\"left\">用户单独配置文件存放目录，该目录下用户的文件名就是对应用户名</td>\n    </tr>\n</table>\n<h2 id=\"以上搞完之后还要把ftp目录的权限给更改\"><a class=\"anchor\" href=\"#以上搞完之后还要把ftp目录的权限给更改\">#</a> 以上搞完之后还要把 ftp 目录的权限给更改</h2>\n<p><code>chmod 777 /var/ftp/pub</code></p>\n<p>这里只能更改 ftp 目录下的子目录的权限。这就是个坑，当更改 /etc/ftp/ 这个目录的权限时，都没法登陆这个 ftp 服务器了。<br />\n当然是可以更改 ftp 下的目录的，在 vsftpd.config 中配置。</p>\n",
            "tags": [
                "CentOS7配置vsftp"
            ]
        }
    ]
}