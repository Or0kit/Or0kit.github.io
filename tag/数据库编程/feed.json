{
    "version": "https://jsonfeed.org/version/1",
    "title": "Or0kit • All posts by \"数据库编程\" tag",
    "description": "临渊羡鱼，不如退而结网",
    "home_page_url": "https://Or0kit.github.io",
    "items": [
        {
            "id": "https://or0kit.github.io/Programming/Python/python%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B/",
            "url": "https://or0kit.github.io/Programming/Python/python%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B/",
            "title": "python数据库编程",
            "date_published": "2021-02-07T08:36:30.000Z",
            "content_html": "<h1 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h1>\n<p>在看《python 网络编程从入门到精通》，顺便做个笔记。</p>\n<h1 id=\"正文\"><a class=\"anchor\" href=\"#正文\">#</a> 正文</h1>\n<p><ins>本章以 MySQL 为例说明</ins></p>\n<p>python 操作数据库主要涉及 connection 和 cursor 两个对象，操作流程图如下：</p>\n<p><img data-src=\"image001.png\" alt=\"\" /></p>\n<h2 id=\"connection对象\"><a class=\"anchor\" href=\"#connection对象\">#</a> connection 对象</h2>\n<p>connection 对象，与数据源唯一的会话，可以使用 connection 对象的集合、方法、属性实现与数据的连接。</p>\n<p><span class=\"label\">connection 参数列表</span></p>\n<table>\n<tbody>\n<tr>\n<td style=\"text-align:left\">参数名</td>\n<td style=\"text-align:left\">类型</td>\n<td style=\"text-align:left\">说明</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">host</td>\n<td style=\"text-align:left\">字符串</td>\n<td style=\"text-align:left\">连接数据库服务器主机名，默认为本地主机 (localhost)</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">port</td>\n<td style=\"text-align:left\">数字</td>\n<td style=\"text-align:left\">MySQL 服务器端口号，默认是 3306</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">user</td>\n<td style=\"text-align:left\">字符串</td>\n<td style=\"text-align:left\">连接数据库的用户名</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">password</td>\n<td style=\"text-align:left\">字符串</td>\n<td style=\"text-align:left\">连接数据库的密码</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">db</td>\n<td style=\"text-align:left\">字符串</td>\n<td style=\"text-align:left\">数据库名称</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">charset</td>\n<td style=\"text-align:left\">字符串</td>\n<td style=\"text-align:left\">连接编码</td>\n</tr>\n</tbody>\n</table>\n<p><span class=\"label\">connection 方法列表</span></p>\n<table>\n<tbody>\n<tr>\n<td style=\"text-align:left\">方法名</td>\n<td style=\"text-align:left\">说明</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">cursor()</td>\n<td style=\"text-align:left\">使用该连接创建并返回游标</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">commit()</td>\n<td style=\"text-align:left\">提交当前事务</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">rollback()</td>\n<td style=\"text-align:left\">回滚当前事务</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">close()</td>\n<td style=\"text-align:left\">关闭连接</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"cursor对象\"><a class=\"anchor\" href=\"#cursor对象\">#</a> cursor 对象</h2>\n<p>cursor 对象是游标对象，用户可以用它查询和获取结果。</p>\n<p><span class=\"label\">cursor 对象方法列表</span></p>\n<table>\n<tbody>\n<tr>\n<td style=\"text-align:left\">方法名</td>\n<td style=\"text-align:left\">说明</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">execute</td>\n<td style=\"text-align:left\">执行一个数据库命令</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">fecthone</td>\n<td style=\"text-align:left\">取结果集下一行</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">fechmany(size)</td>\n<td style=\"text-align:left\">取结果集下几行</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">fechall()</td>\n<td style=\"text-align:left\">取结果集中剩余的所有行</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">rowcount</td>\n<td style=\"text-align:left\">最近一次 execute 返回数据的行数或影响行数</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">close()</td>\n<td style=\"text-align:left\">关闭游标对象</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"一个例子\"><a class=\"anchor\" href=\"#一个例子\">#</a> 一个例子</h2>\n<p>搬一个菜鸟教程里<ins>插入操作</ins>的例子。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#!/usr/bin/python</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># -*- coding: UTF-8 -*-</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> MySQLdb</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># 打开数据库连接</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>db <span class=\"token operator\">=</span> MySQLdb<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span><span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"testuser\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"test123\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"TESTDB\"</span><span class=\"token punctuation\">,</span> charset<span class=\"token operator\">=</span><span class=\"token string\">'utf8'</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># 使用 cursor () 方法获取操作游标 </span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>cursor <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span>cursor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># SQL 插入语句</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>sql <span class=\"token operator\">=</span> \"INSERT INTO EMPLOYEE<span class=\"token punctuation\">(</span>FIRST_NAME<span class=\"token punctuation\">,</span> \\</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>       LAST_NAME<span class=\"token punctuation\">,</span> AGE<span class=\"token punctuation\">,</span> SEX<span class=\"token punctuation\">,</span> INCOME<span class=\"token punctuation\">)</span> \\</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>       VALUES <span class=\"token punctuation\">(</span><span class=\"token operator\">%</span>s<span class=\"token punctuation\">,</span> <span class=\"token operator\">%</span>s<span class=\"token punctuation\">,</span> <span class=\"token operator\">%</span>s<span class=\"token punctuation\">,</span> <span class=\"token operator\">%</span>s<span class=\"token punctuation\">,</span> <span class=\"token operator\">%</span>s <span class=\"token punctuation\">)</span>\" <span class=\"token operator\">%</span> \\</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>       <span class=\"token punctuation\">(</span><span class=\"token string\">'Mac'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Mohan'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'M'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2000</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>   <span class=\"token comment\"># 执行 sql 语句</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>   cursor<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>   <span class=\"token comment\"># 提交到数据库执行</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>   db<span class=\"token punctuation\">.</span>commit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>   <span class=\"token comment\"># 发生错误时回滚</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>   db<span class=\"token punctuation\">.</span>rollback<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\"># 关闭数据库连接</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>db<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure>",
            "tags": [
                "数据库编程"
            ]
        }
    ]
}