<!-- build time:Tue Mar 21 2023 06:41:55 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="Or0kit" href="https://or0kit.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="Or0kit" href="https://or0kit.github.io/atom.xml"><link rel="alternate" type="application/json" title="Or0kit" href="https://or0kit.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="提权,调用门,调用门描述符"><link rel="canonical" href="https://or0kit.github.io/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E8%B0%83%E7%94%A8%E9%97%A8%E6%8F%90%E6%9D%83/"><title>保护模式-调用门提权 - 保护模式 - Xp内核分析 - 内核学习 - 逆向 | Or0kit = Or0kit</title><meta name="generator" content="Hexo 5.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">保护模式-调用门提权</h1><div class="meta"><span class="item" title="创建时间：2021-08-09 12:02:20"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2021-08-09T12:02:20+08:00">2021-08-09</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>3.4k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>3 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Or0kit</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1gicitht3xtj20zk0m8k5v.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1giclhfehz7j20zk0m8u0x.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1giclfw2t96j20zk0m8x6p.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1giciundwu5j20zk0m8n9e.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1giclil3m4ej20zk0m8tn8.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1gicli3sbvtj20zk0m8x6p.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Bin/" itemprop="item" rel="index" title="分类于 逆向"><span itemprop="name">逆向</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Bin/Core/" itemprop="item" rel="index" title="分类于 内核学习"><span itemprop="name">内核学习</span></a><meta itemprop="position" content="2"></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Bin/Core/WindowsXp/" itemprop="item" rel="index" title="分类于 Xp内核分析"><span itemprop="name">Xp内核分析</span></a><meta itemprop="position" content="3"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Bin/Core/WindowsXp/Protect-Mode/" itemprop="item" rel="index" title="分类于 保护模式"><span itemprop="name">保护模式</span></a><meta itemprop="position" content="4"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://or0kit.github.io/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E8%B0%83%E7%94%A8%E9%97%A8%E6%8F%90%E6%9D%83/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Or0kit"><meta itemprop="description" content=", 临渊羡鱼，不如退而结网"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Or0kit"></span><div class="body md" itemprop="articleBody"><h1 id="前言"><a class="anchor" href="#前言">#</a> 前言</h1><p>在学习长调用时没有用实例具体分析，因为牵扯到了调用门的知识。</p><h1 id="调用门"><a class="anchor" href="#调用门">#</a> 调用门</h1><h2 id="调用门的作用"><a class="anchor" href="#调用门的作用">#</a> 调用门的作用</h2><p>调用门可以用来提权，通过提权可以实现访问高地址空间等 RING0（内核）层才能进行的操作</p><hr><h2 id="调用门和长调用关系"><a class="anchor" href="#调用门和长调用关系">#</a> 调用门和长调用关系</h2><p>回顾先前的笔记可知：</p><p>长调用 CALL FAR CS:EIP 指令要<strong>调用的地址</strong>是由 CS 段选择子查 GDT 得到的<strong>调用门</strong> 段描述符得来的，后面的 EIP 不发挥作用</p><h2 id="调用门执行流程"><a class="anchor" href="#调用门执行流程">#</a> 调用门执行流程</h2><ol><li>根据 CS 的值 查 GDT，找到对应的段描述符 这个描述符是一个调用门</li><li>在调用门描述符中存储另一个代码段的选择子</li><li>选择子指向的段 段.Base + 偏移地址 就是真正要执行的地址</li></ol><h2 id="调用门描述符"><a class="anchor" href="#调用门描述符">#</a> 调用门描述符</h2><h3 id="对比段描述符"><a class="anchor" href="#对比段描述符">#</a> 对比段描述符</h3><p><img data-src="image001.png" alt=""></p><p>调用门描述符结构</p><p><img data-src="image002.png" alt=""></p><hr><p>当一个段描述符是一个调用门描述符时，有以下特征：</p><ul><li>S 位为 0，表示该段描述符为系统段描述符（调用门描述符属于系统段描述符）</li><li>Type 域为 1100，表示该段描述符为 32 位调用门</li><li>低 16 位到 31 位由原本的基地址变为存储一个段选择子，该段选择子才和代码<strong>真正要调用的地址</strong>相关</li><li>真正要调用的地址 = 段选择子所指向的段.Base + 32 位的段中偏移 （段中偏移分为两部分：高位 31-16 位和低位 15-0 位）</li><li>段.Base 默认为 0，故真正要调用的地址 = 32 位的段中偏移</li></ul><hr><p>给出段描述符和调用门描述符各部分的对比：</p><hr><h2 id="段描述符"><a class="anchor" href="#段描述符">#</a> 段描述符</h2><table><thead><tr><th>数据位</th><th>31-24</th><th>23</th><th>22</th><th>21</th><th>20</th><th>19-16</th><th>15</th><th>14-13</th><th>12</th><th>11-8</th><th>7-0</th><th></th></tr></thead><tbody><tr><td>含义</td><td>Base</td><td>G</td><td>D/B</td><td>0</td><td>AVL</td><td>Seg.Limit</td><td>P</td><td>DPL</td><td>S</td><td>Type</td><td>Base</td><td></td></tr><tr><td>解释</td><td>基地址</td><td>粒度</td><td>默认操作大小</td><td>固定为 0</td><td>用于系统软件使用</td><td>段大小限制</td><td>有效位</td><td>特权等级</td><td>描述符类型</td><td>段类型</td><td>基地址</td><td></td></tr></tbody><tbody><tr><td>数据位</td><td>31-16</td><td>15</td><td>14-13</td><td>12</td><td>11-8</td><td>7-5</td><td>4-0</td></tr><tr><td>------</td><td>--------</td><td>------</td><td>--------</td><td>-----</td><td>--------</td><td>-------</td><td>-----------</td></tr><tr><td>含义</td><td>offset</td><td>P</td><td>DPL</td><td>S</td><td>Type</td><td>无</td><td>param.count</td></tr><tr><td>解释</td><td>段中偏移</td><td>有效位</td><td>特权等级</td><td>值为 0</td><td>值为 1100</td><td>值为 000</td><td>参数计数</td></tr></tbody></table><hr><h2 id="调用门描述符-2"><a class="anchor" href="#调用门描述符-2">#</a> 调用门描述符</h2><table><thead><tr><th>数据位</th><th>31-16</th><th>15-0</th></tr></thead><tbody><tr><td>含义</td><td>Base Adress</td><td>Segment Limit</td></tr><tr><td>解释</td><td>基地址</td><td>段大小限制</td></tr><tr><td></td><td></td><td></td></tr><tr><td>数据位</td><td>31-16</td><td>15-0</td></tr><tr><td>含义</td><td>selector</td><td>offset</td></tr><tr><td>解释</td><td>段选择子</td><td>段中偏移</td></tr></tbody></table><h2 id="构造无参调用门描述符"><a class="anchor" href="#构造无参调用门描述符">#</a> 构造无参调用门描述符</h2><p>了解了调用门描述符的结构后，尝试自己构造一个无参的调用门描述符，如下：</p><table><thead><tr><th>数据位</th><th>31-16</th><th>15</th><th>14-13</th><th>12</th><th>11-8</th><th>7-5</th><th>4-0</th></tr></thead><tbody><tr><td>含义</td><td>offset</td><td>P</td><td>DPL</td><td>S</td><td>Type</td><td>无</td><td>param</td></tr><tr><td>解释</td><td>段中偏移</td><td>有效位</td><td>特权等级</td><td>值为 0</td><td>值为 1100</td><td>值为 000</td><td>参数</td></tr><tr><td>值（二进制）</td><td>0</td><td>1</td><td>11</td><td>0</td><td>1100</td><td>000</td><td>0000</td></tr></tbody><tbody><tr><td>数据位</td><td>31-16</td><td>15-0</td></tr><tr><td>:-------------</td><td>--------</td><td>--------</td></tr><tr><td>含义</td><td>selector</td><td>offset</td></tr><tr><td>解释</td><td>段选择子</td><td>段中偏移</td></tr><tr><td>值（十六进制）</td><td>0x0008</td><td>0</td></tr></tbody></table><p>得到调用门描述符为：0000EC00`00080000</p><p>段中偏移暂时不明确要调用的代码段，先置 0</p><h3 id="示例代码"><a class="anchor" href="#示例代码">#</a> 示例代码</h3><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">__declspec</span><span class="token punctuation">(</span>naked<span class="token punctuation">)</span> <span class="token keyword">void</span> <span class="token function">callGate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>         _asm<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>                 <span class="token keyword">int</span> <span class="token number">3</span>                                <span class="token comment">// 软中断</span></pre></td></tr><tr><td data-num="4"></td><td><pre>                 retf                                <span class="token comment">// 注意这里长调用对应长返回</span></pre></td></tr><tr><td data-num="5"></td><td><pre>         <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="6"></td><td><pre> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token keyword">char</span> buff<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token comment">//*(DWORD*)&amp;buff [0]= 0x12345678;        // 低地址 32 位为 0x12345678，EIP 已废弃，故随便填即可</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token comment">//*(DWORD*)&amp;buff [4]=0x48;                        // 高地址 16 位为 0x48，段选择子</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token comment">// 也可以换作这种写法</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        _asm<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>                mov dword ptr ds<span class="token operator">:</span><span class="token punctuation">[</span>buff<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0x12345678</span>        <span class="token comment">// 低 32 位赋值废弃 EIP</span></pre></td></tr><tr><td data-num="17"></td><td><pre>                lea eax<span class="token punctuation">,</span>dword ptr ds<span class="token operator">:</span><span class="token punctuation">[</span>buff<span class="token punctuation">]</span>                        <span class="token comment">// 将 buff 地址给 EAX</span></pre></td></tr><tr><td data-num="18"></td><td><pre>                add eax<span class="token punctuation">,</span><span class="token number">4</span>                                                        <span class="token comment">// 地址 + 4，即得到高地址</span></pre></td></tr><tr><td data-num="19"></td><td><pre>                mov word ptr ds<span class="token operator">:</span><span class="token punctuation">[</span>eax<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0x48</span>                        <span class="token comment">// 高 16 位赋值段选择子 selector</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token comment">// 使用 调用门</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        _asm<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>                call fword ptr ds<span class="token operator">:</span><span class="token punctuation">[</span>buff<span class="token punctuation">]</span>                        <span class="token comment">//fword 数据宽度为 6 字节</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="代码说明"><a class="anchor" href="#代码说明">#</a> 代码说明</h3><p>代码十分简单，主要分为两部分：</p><ul><li>callGate：调用门真正要调用的函数，先软中断，然后长返回</li><li>main：先构造一个 CS:EIP，这里为 0x48:0x12345678，然后使用调用门</li></ul><p>当我们发动调用门技能时，程序会跳转到我们构造的调用门描述符中预先设置的地址，并且我们的权限会提升到我们设置的权限！！可以做一些操作系统才能做的事情。</p><h3 id="实验过程"><a class="anchor" href="#实验过程">#</a> 实验过程</h3><p>目前一些重要操作只能手动……</p><ol><li>确定要跳转的函数的地址</li></ol><p><img data-src="image003.png" alt=""></p><ol start="2"><li>构造 Call-Gate 描述符</li></ol><p>要跳转的地址为： <code>0x00401020</code></p><p>Call-Gate Descriptor: <code>0040ec00`00081020</code></p><ol start="3"><li>修改 GDT 表</li></ol><p><img data-src="image004.png" alt=""></p><p>修改 <code>0x8003f048</code> 这个地址，因为这是一个没有被用到的段描述符。</p><p><code>eq 8003f048 0040ec00`00081020</code></p><ol start="4"><li>在调试机中执行上面的代码</li></ol><p>如果没有意外的话，调试机会被中断。</p><h2 id="构造有参的调用门"><a class="anchor" href="#构造有参的调用门">#</a> 构造有参的调用门</h2><p>在构造调用门描述符时要说明参数个数，关于这个参数个数，需要注意的是，它的值共 5 位（5 个比特位）。</p><h3 id="代码"><a class="anchor" href="#代码">#</a> 代码</h3><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;windows.h></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>DWORD x<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>DWORD y<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>DWORD z<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre> <span class="token function">__declspec</span><span class="token punctuation">(</span>naked<span class="token punctuation">)</span> <span class="token keyword">void</span> <span class="token function">callGate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        _asm<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>                pushad                        <span class="token comment">// 将所有 32 位通用寄存器压入堆栈</span></pre></td></tr><tr><td data-num="13"></td><td><pre>                pushfd                        <span class="token comment">// 将 32 位标志寄存器 EFLFAGS 压入堆栈</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>                mov eax<span class="token punctuation">,</span><span class="token punctuation">[</span>esp<span class="token operator">+</span><span class="token number">0x24</span><span class="token operator">+</span><span class="token number">0x8</span><span class="token operator">+</span><span class="token number">0x8</span><span class="token punctuation">]</span>    <span class="token comment">// 从堆栈中取出第一个参数</span></pre></td></tr><tr><td data-num="16"></td><td><pre>                mov dword ptr ds<span class="token operator">:</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">,</span>eax      <span class="token comment">// 将取出的参数赋值给全局变量 x</span></pre></td></tr><tr><td data-num="17"></td><td><pre>                mov eax<span class="token punctuation">,</span><span class="token punctuation">[</span>esp<span class="token operator">+</span><span class="token number">0x24</span><span class="token operator">+</span><span class="token number">0x8</span><span class="token operator">+</span><span class="token number">0x4</span><span class="token punctuation">]</span>    <span class="token comment">// 从堆栈中取出第二个参数</span></pre></td></tr><tr><td data-num="18"></td><td><pre>                mov dword ptr ds<span class="token operator">:</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">,</span>eax      <span class="token comment">// 将取出的参数赋值给全局变量 y</span></pre></td></tr><tr><td data-num="19"></td><td><pre>                mov eax<span class="token punctuation">,</span><span class="token punctuation">[</span>esp<span class="token operator">+</span><span class="token number">0x24</span><span class="token operator">+</span><span class="token number">8</span><span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token comment">// 从堆栈中取出第三个参数</span></pre></td></tr><tr><td data-num="20"></td><td><pre>                mov dword ptr ds<span class="token operator">:</span><span class="token punctuation">[</span>z<span class="token punctuation">]</span><span class="token punctuation">,</span>eax      <span class="token comment">// 将取出的参数赋值给全局变量 z</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>                popfd                         <span class="token comment">// 将所有 32 位通用寄存器出栈</span></pre></td></tr><tr><td data-num="23"></td><td><pre>                popad                         <span class="token comment">// 将所有 32 位标志寄存器 EFLFAGS 出栈</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre>                retf <span class="token number">0xC</span>                      <span class="token comment">// 注意这里长调用对应长返回，堆栈平衡 0xC=12=3*4 = 参数个数 * 参数的数据宽度（单位字节）</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token keyword">char</span> buff<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token operator">*</span><span class="token punctuation">(</span>DWORD<span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>buff <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span> <span class="token number">0x12345678</span><span class="token punctuation">;</span>        <span class="token comment">// 低地址 32 位为 0x12345678，EIP 已废弃，故随便填即可</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token operator">*</span><span class="token punctuation">(</span>DWORD<span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>buff <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0x48</span><span class="token punctuation">;</span>                        <span class="token comment">// 高地址 16 位为 0x48，段选择子</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token comment">// 也可以换作这种写法</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token comment">//_asm&#123;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token comment">//        mov dword ptr ds:[buff],0x12345678        // 低 32 位赋值废弃 EIP</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        <span class="token comment">//        lea eax,dword ptr ds:[buff]                        // 将 buff 地址给 EAX</span></pre></td></tr><tr><td data-num="39"></td><td><pre>        <span class="token comment">//        add eax,4                                                        // 地址 + 4，即得到高地址</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token comment">//        mov word ptr ds:[eax],0x48                        // 高 16 位赋值段选择子 selector</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token comment">//&#125;</span></pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token comment">// 使用 调用门</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        _asm<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>                push <span class="token number">1</span></pre></td></tr><tr><td data-num="46"></td><td><pre>                push <span class="token number">2</span></pre></td></tr><tr><td data-num="47"></td><td><pre>                push <span class="token number">3</span></pre></td></tr><tr><td data-num="48"></td><td><pre>                call fword ptr<span class="token punctuation">[</span>buff<span class="token punctuation">]</span>                        <span class="token comment">//fword 数据宽度为 6 字节</span></pre></td></tr><tr><td data-num="49"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="50"></td><td><pre></pre></td></tr><tr><td data-num="51"></td><td><pre>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%X\t%X\t%X\n"</span><span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="代码说明-2"><a class="anchor" href="#代码说明-2">#</a> 代码说明</h3><p>与构造无参调用门描述符相比，主要变化为：</p><p>在使用调用门前压入了三个参数：1、2、3<br>调用代码作用为：①保护现场（压入所有通用寄存器和标志寄存器）；②从堆栈中取出对应的参数；③将取出的参数赋值给对应的全局变量<br>调用代码最后要平衡堆栈，ret 0xC 0xC=12=3*4 = 参数个数 * 参数的数据宽度（单位字节）<br>在调用结束后，输出调用后被赋值的全局变量，验证参数是否成功传递</p><h3 id="实验过程-2"><a class="anchor" href="#实验过程-2">#</a> 实验过程</h3><p>与无参基本一样。描述符中记加参数个数。<br>注意观察堆栈变化。</p><h2 id="总结"><a class="anchor" href="#总结">#</a> 总结</h2><p>当通过门，权限不变的时候，只会 PUSH 两个值：①CS（新的 CS 的值由调用门决定） ；②返回地址<br>当通过门，权限改变的时候，会 PUSH 四个值：①SS；② ESP；③ CS ；④ 返回地址 （新的 CS 的值由调用门决定 新的 SS 和 ESP 由 TSS 提供）<br>通过门调用时，要执行代码的地址由调用门中的选择子决定；使用 RETF 返回时，由堆栈中压入的返回地址决定</p><h1 id="reference"><a class="anchor" href="#reference">#</a> Reference</h1><p>详细参见：<span class="exturl" data-url="aHR0cHM6Ly93d3cuNTJwb2ppZS5jbi90aHJlYWQtMTQ1NDM1My0xLTEuaHRtbA==">https://www.52pojie.cn/thread-1454353-1-1.html</span></p><div class="tags"><a href="/tags/%E6%8F%90%E6%9D%83/" rel="tag"><i class="ic i-tag"></i> 提权</a> <a href="/tags/%E8%B0%83%E7%94%A8%E9%97%A8/" rel="tag"><i class="ic i-tag"></i> 调用门</a> <a href="/tags/%E8%B0%83%E7%94%A8%E9%97%A8%E6%8F%8F%E8%BF%B0%E7%AC%A6/" rel="tag"><i class="ic i-tag"></i> 调用门描述符</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2022-07-27 14:40:35" itemprop="dateModified" datetime="2022-07-27T14:40:35+08:00">2022-07-27</time> </span><span id="Bin/Core/WindowsXp/Protect-Mode/保护模式-调用门提权/" class="item leancloud_visitors" data-flag-title="保护模式-调用门提权" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/reward.jpg" alt="Or0kit 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Or0kit <i class="ic i-at"><em>@</em></i>Or0kit</li><li class="link"><strong>本文链接：</strong> <a href="https://or0kit.github.io/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E8%B0%83%E7%94%A8%E9%97%A8%E6%8F%90%E6%9D%83/" title="保护模式-调用门提权">https://or0kit.github.io/Bin/Core/WindowsXp/Protect-Mode/保护模式-调用门提权/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E9%95%BF%E8%B0%83%E7%94%A8%E4%B8%8E%E7%9F%AD%E8%B0%83%E7%94%A8/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva2.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipev1x5e4j20zk0m8b29.jpg" title="保护模式-长调用与短调用"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 保护模式</span><h3>保护模式-长调用与短调用</h3></a></div><div class="item right"><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E4%B8%AD%E6%96%AD%E9%97%A8/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva2.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gicm0n457cj20zk0m8e81.jpg" title="保护模式-中断门"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 保护模式</span><h3>保护模式-中断门</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E9%97%A8"><span class="toc-number">2.</span> <span class="toc-text">调用门</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E9%97%A8%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">2.1.</span> <span class="toc-text">调用门的作用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E9%97%A8%E5%92%8C%E9%95%BF%E8%B0%83%E7%94%A8%E5%85%B3%E7%B3%BB"><span class="toc-number">2.2.</span> <span class="toc-text">调用门和长调用关系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E9%97%A8%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="toc-number">2.3.</span> <span class="toc-text">调用门执行流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E9%97%A8%E6%8F%8F%E8%BF%B0%E7%AC%A6"><span class="toc-number">2.4.</span> <span class="toc-text">调用门描述符</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E6%AF%94%E6%AE%B5%E6%8F%8F%E8%BF%B0%E7%AC%A6"><span class="toc-number">2.4.1.</span> <span class="toc-text">对比段描述符</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AE%B5%E6%8F%8F%E8%BF%B0%E7%AC%A6"><span class="toc-number">2.5.</span> <span class="toc-text">段描述符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E9%97%A8%E6%8F%8F%E8%BF%B0%E7%AC%A6-2"><span class="toc-number">2.6.</span> <span class="toc-text">调用门描述符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E6%97%A0%E5%8F%82%E8%B0%83%E7%94%A8%E9%97%A8%E6%8F%8F%E8%BF%B0%E7%AC%A6"><span class="toc-number">2.7.</span> <span class="toc-text">构造无参调用门描述符</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81"><span class="toc-number">2.7.1.</span> <span class="toc-text">示例代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E8%AF%B4%E6%98%8E"><span class="toc-number">2.7.2.</span> <span class="toc-text">代码说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B"><span class="toc-number">2.7.3.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E6%9C%89%E5%8F%82%E7%9A%84%E8%B0%83%E7%94%A8%E9%97%A8"><span class="toc-number">2.8.</span> <span class="toc-text">构造有参的调用门</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81"><span class="toc-number">2.8.1.</span> <span class="toc-text">代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E8%AF%B4%E6%98%8E-2"><span class="toc-number">2.8.2.</span> <span class="toc-text">代码说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-2"><span class="toc-number">2.8.3.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">2.9.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#reference"><span class="toc-number">3.</span> <span class="toc-text">Reference</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E6%AE%B5%E5%AF%84%E5%AD%98%E5%99%A8%E7%BB%93%E6%9E%84%E3%80%81%E6%AE%B5%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E6%AE%B5%E9%80%89%E6%8B%A9%E5%AD%90/" rel="bookmark" title="保护模式--段寄存器结构、段描述符、段选择子">保护模式--段寄存器结构、段描述符、段选择子</a></li><li><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E6%AE%B5%E6%9D%83%E9%99%90%E6%A3%80%E6%B5%8B/" rel="bookmark" title="保护模式--段权限检测">保护模式--段权限检测</a></li><li><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E4%BB%A3%E7%A0%81%E8%B7%A8%E6%AE%B5%E8%B7%B3%E8%BD%AC/" rel="bookmark" title="保护模式-代码跨段跳转">保护模式-代码跨段跳转</a></li><li><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E9%95%BF%E8%B0%83%E7%94%A8%E4%B8%8E%E7%9F%AD%E8%B0%83%E7%94%A8/" rel="bookmark" title="保护模式-长调用与短调用">保护模式-长调用与短调用</a></li><li class="active"><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E8%B0%83%E7%94%A8%E9%97%A8%E6%8F%90%E6%9D%83/" rel="bookmark" title="保护模式-调用门提权">保护模式-调用门提权</a></li><li><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E4%B8%AD%E6%96%AD%E9%97%A8/" rel="bookmark" title="保护模式-中断门">保护模式-中断门</a></li><li><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E9%99%B7%E9%98%B1%E9%97%A8/" rel="bookmark" title="保护模式-陷阱门">保护模式-陷阱门</a></li><li><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E4%BB%BB%E5%8A%A1%E6%AE%B5/" rel="bookmark" title="保护模式-任务段">保护模式-任务段</a></li><li><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E4%BB%BB%E5%8A%A1%E9%97%A8/" rel="bookmark" title="保护模式-任务门">保护模式-任务门</a></li><li><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%E2%80%9410-10-12%E5%88%86%E9%A1%B5/" rel="bookmark" title="保护模式—10-10-12分页">保护模式—10-10-12分页</a></li><li><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%E2%80%94PDE-PTE/" rel="bookmark" title="保护模式—PDE_PTE">保护模式—PDE_PTE</a></li><li><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E9%A1%B5%E7%9B%AE%E5%BD%95%E8%A1%A8%E4%B8%8E%E9%A1%B5%E8%A1%A8%E7%9A%84%E5%9F%BA%E5%9D%80/" rel="bookmark" title="保护模式-页目录表与页表的基址">保护模式-页目录表与页表的基址</a></li><li><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E6%89%A9%E5%B1%95-%E4%BD%BF%E7%94%A8LDT/" rel="bookmark" title="保护模式-扩展-使用LDT">保护模式-扩展-使用LDT</a></li><li><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90MmIsAddressValid%E5%87%BD%E6%95%B0-10-10-12/" rel="bookmark" title="保护模式-逆向分析MmIsAddressValid函数(10-10-12)">保护模式-逆向分析MmIsAddressValid函数(10-10-12)</a></li><li><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-2-9-9-12%E5%88%86%E9%A1%B5/" rel="bookmark" title="保护模式-2-9-9-12分页">保护模式-2-9-9-12分页</a></li><li><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-TLB/" rel="bookmark" title="保护模式-TLB">保护模式-TLB</a></li><li><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E4%B8%AD%E6%96%AD%E4%B8%8E%E5%BC%82%E5%B8%B8/" rel="bookmark" title="保护模式-中断与异常">保护模式-中断与异常</a></li><li><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E6%8E%A7%E5%88%B6%E5%AF%84%E5%AD%98%E5%99%A8/" rel="bookmark" title="保护模式-控制寄存器">保护模式-控制寄存器</a></li><li><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-PWT%E4%B8%8EPCD%E5%B1%9E%E6%80%A7/" rel="bookmark" title="保护模式-PWT与PCD属性">保护模式-PWT与PCD属性</a></li><li><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E9%98%B6%E6%AE%B5%E6%B5%8B%E8%AF%95/" rel="bookmark" title="保护模式-阶段测试">保护模式-阶段测试</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Or0kit" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Or0kit</p><div class="description" itemprop="description">临渊羡鱼，不如退而结网</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">215</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">49</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">398</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29t" title="https:&#x2F;&#x2F;github.com"><i class="ic i-github"></i></span> <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;twitter.com&#x2F;yourname"><i class="ic i-twitter"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;yourname"><i class="ic i-zhihu"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPXlvdXJuYW1l" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;yourname"><i class="ic i-cloud-music"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20veW91cm5hbWU=" title="https:&#x2F;&#x2F;weibo.com&#x2F;yourname"><i class="ic i-weibo"></i></span> <span class="exturl item youtube" data-url="aHR0cHM6Ly95b3V0dWJlLmNvbS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;youtube.com&#x2F;yourname"><i class="ic i-youtube"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>links</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E9%95%BF%E8%B0%83%E7%94%A8%E4%B8%8E%E7%9F%AD%E8%B0%83%E7%94%A8/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E4%B8%AD%E6%96%AD%E9%97%A8/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/Diary/" title="分类于 Diary">Diary</a></div><span><a href="/2021-8-14%E6%99%9A/" title="2021-8-14晚">2021-8-14晚</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Bin/" title="分类于 逆向">逆向</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/IDA/" title="分类于 IDA">IDA</a></div><span><a href="/Bin/IDA%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/" title="IDA入门学习">IDA入门学习</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Bin/" title="分类于 逆向">逆向</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/Core/" title="分类于 内核学习">内核学习</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/Core/WindowsXp/" title="分类于 Xp内核分析">Xp内核分析</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/Core/WindowsXp/MemoryManagement/" title="分类于 内存管理">内存管理</a></div><span><a href="/Bin/Core/WindowsXp/MemoryManagement/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86-04%E7%89%A9%E7%90%86%E5%86%85%E5%AD%98%E7%9A%84%E7%AE%A1%E7%90%86/" title="内存管理-04物理内存的管理">内存管理-04物理内存的管理</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Bin/" title="分类于 逆向">逆向</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/Core/" title="分类于 内核学习">内核学习</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/Core/WindowsXp/" title="分类于 Xp内核分析">Xp内核分析</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/Core/WindowsXp/Process-Thread/" title="分类于 进程与线程">进程与线程</a></div><span><a href="/Bin/Core/WindowsXp/Process-Thread/%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B-Windows%E7%BA%BF%E7%A8%8B%E5%88%87%E6%8D%A2/" title="进程与线程-Windows线程切换">进程与线程-Windows线程切换</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Programming/" title="分类于 编程">编程</a> <i class="ic i-angle-right"></i> <a href="/categories/Programming/Python/" title="分类于 Python">Python</a></div><span><a href="/Programming/Python/numpy%E5%BA%93%E5%AD%A6%E4%B9%A0/" title="numpy库学习">numpy库学习</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8/" title="分类于 移动安全">移动安全</a></div><span><a href="/%E9%80%9A%E8%BF%87ADB%E6%8F%90%E5%8F%96app%E9%87%8C%E7%9A%84%E8%B5%84%E6%BA%90/" title="通过ADB提取app里的资源">通过ADB提取app里的资源</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Programming/" title="分类于 编程">编程</a> <i class="ic i-angle-right"></i> <a href="/categories/Programming/STL/" title="分类于 STL">STL</a></div><span><a href="/Programming/STL/STL-hash/" title="STL-hash">STL-hash</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Markdown/" title="分类于 Markdown">Markdown</a></div><span><a href="/%E5%88%9D%E5%AD%A6Markdown%E8%AF%AD%E6%B3%95/" title="初学Markdown语法">初学Markdown语法</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Bin/" title="分类于 逆向">逆向</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/MalwareAnalysis/" title="分类于 恶意代码分析">恶意代码分析</a></div><span><a href="/Bin/MalwareAnalysis/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98-%E7%AC%AC03%E7%AB%A0/" title="恶意代码分析实战-第03章动态分析技术基础">恶意代码分析实战-第03章动态分析技术基础</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Programming/" title="分类于 编程">编程</a> <i class="ic i-angle-right"></i> <a href="/categories/Programming/Python/" title="分类于 Python">Python</a></div><span><a href="/Programming/Python/py-socket-experiment/" title="Python-socket编程">Python-socket编程</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Or0kit @ Or0kit</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">1.5m 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">21:59</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"Bin/Core/WindowsXp/Protect-Mode/保护模式-调用门提权/",favicon:{show:"╰(*°▽°*)╯正在变强中",hide:"(ー`′ー)快回来"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{scale:1,hHeadPos:.5,vHeadPos:.618,jsonPath:"/live2dw/assets/koharu.model.json"},display:{superSample:2,width:150,height:300,position:"right",hOffset:0,vOffset:-20},mobile:{show:!0,scale:.5},react:{opacityDefault:.7,opacityOnHover:.8},log:!1})</script></body></html><!-- rebuild by hrmmi -->