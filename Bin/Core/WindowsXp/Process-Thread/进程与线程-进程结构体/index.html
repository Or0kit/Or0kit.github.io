<!-- build time:Fri Oct 07 2022 17:37:55 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="Or0kit" href="https://or0kit.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="Or0kit" href="https://or0kit.github.io/atom.xml"><link rel="alternate" type="application/json" title="Or0kit" href="https://or0kit.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="EPROCESS,KPROCESS"><link rel="canonical" href="https://or0kit.github.io/Bin/Core/WindowsXp/Process-Thread/%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B-%E8%BF%9B%E7%A8%8B%E7%BB%93%E6%9E%84%E4%BD%93/"><title>进程与线程-进程结构体 - 进程与线程 - Xp内核分析 - 内核学习 - 逆向 | Or0kit</title><meta name="generator" content="Hexo 5.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">进程与线程-进程结构体</h1><div class="meta"><span class="item" title="创建时间：2022-01-01 08:53:20"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-01-01T08:53:20+08:00">2022-01-01</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>8.8k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>8 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Or0kit</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1giclip4jbpj20zk0m87cv.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1gipetlbztpj20zk0m84qp.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1gicmnywqgpj20zk0m8dwx.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1giciundwu5j20zk0m8n9e.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1giclhtuo6nj20zk0m8ttm.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1gicli3sbvtj20zk0m8x6p.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Bin/" itemprop="item" rel="index" title="分类于 逆向"><span itemprop="name">逆向</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Bin/Core/" itemprop="item" rel="index" title="分类于 内核学习"><span itemprop="name">内核学习</span></a><meta itemprop="position" content="2"></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Bin/Core/WindowsXp/" itemprop="item" rel="index" title="分类于 Xp内核分析"><span itemprop="name">Xp内核分析</span></a><meta itemprop="position" content="3"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Bin/Core/WindowsXp/Process-Thread/" itemprop="item" rel="index" title="分类于 进程与线程"><span itemprop="name">进程与线程</span></a><meta itemprop="position" content="4"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://or0kit.github.io/Bin/Core/WindowsXp/Process-Thread/%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B-%E8%BF%9B%E7%A8%8B%E7%BB%93%E6%9E%84%E4%BD%93/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Or0kit"><meta itemprop="description" content=", 临渊羡鱼，不如退而结网"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Or0kit"></span><div class="body md" itemprop="articleBody"><h1 id="进程"><a class="anchor" href="#进程">#</a> 进程</h1><p>进程最重要的作用是提供了 CR3，10-10-12 分页下 CR3 指向页目录表，2-9-9-12 分页下 CR3 指向页目录指针表。<br>每个进程至少有一个线程。<br>本质上，没有进程切换，只有线程切换。线程切换时会判断是否是同一个进程的线程，若不是同一进程则切换 CR3，这样看来进程也就切换了。<br>我们说进程是空间概念，进程为它的线程提供了 CR3，那么它的线程访问同一个线性地址时，就能访问到同一个物理页。<br>windbg 中的 <code>attach</code> 和 <code>.process</code> 本质就是切换 CR3。</p><h1 id="进程结构体-eproccess"><a class="anchor" href="#进程结构体-eproccess">#</a> 进程结构体 EPROCCESS</h1><figure class="highlight raw"><figcaption data-lang=""></figcaption><table><tr><td data-num="1"></td><td><pre>kd&gt; dt _EPROCESS </pre></td></tr><tr><td data-num="2"></td><td><pre>nt!_EPROCESS</pre></td></tr><tr><td data-num="3"></td><td><pre>   +0x000 Pcb              : _KPROCESS</pre></td></tr><tr><td data-num="4"></td><td><pre>   +0x06c ProcessLock      : _EX_PUSH_LOCK</pre></td></tr><tr><td data-num="5"></td><td><pre>   +0x070 CreateTime       : _LARGE_INTEGER</pre></td></tr><tr><td data-num="6"></td><td><pre>   +0x078 ExitTime         : _LARGE_INTEGER</pre></td></tr><tr><td data-num="7"></td><td><pre>   +0x080 RundownProtect   : _EX_RUNDOWN_REF</pre></td></tr><tr><td data-num="8"></td><td><pre>   +0x084 UniqueProcessId  : Ptr32 Void</pre></td></tr><tr><td data-num="9"></td><td><pre>   +0x088 ActiveProcessLinks : _LIST_ENTRY</pre></td></tr><tr><td data-num="10"></td><td><pre>   +0x090 QuotaUsage       : [3] Uint4B</pre></td></tr><tr><td data-num="11"></td><td><pre>   +0x09c QuotaPeak        : [3] Uint4B</pre></td></tr><tr><td data-num="12"></td><td><pre>   +0x0a8 CommitCharge     : Uint4B</pre></td></tr><tr><td data-num="13"></td><td><pre>   +0x0ac PeakVirtualSize  : Uint4B</pre></td></tr><tr><td data-num="14"></td><td><pre>   +0x0b0 VirtualSize      : Uint4B</pre></td></tr><tr><td data-num="15"></td><td><pre>   +0x0b4 SessionProcessLinks : _LIST_ENTRY</pre></td></tr><tr><td data-num="16"></td><td><pre>   +0x0bc DebugPort        : Ptr32 Void</pre></td></tr><tr><td data-num="17"></td><td><pre>   +0x0c0 ExceptionPort    : Ptr32 Void</pre></td></tr><tr><td data-num="18"></td><td><pre>   +0x0c4 ObjectTable      : Ptr32 _HANDLE_TABLE</pre></td></tr><tr><td data-num="19"></td><td><pre>   +0x0c8 Token            : _EX_FAST_REF</pre></td></tr><tr><td data-num="20"></td><td><pre>   +0x0cc WorkingSetLock   : _FAST_MUTEX</pre></td></tr><tr><td data-num="21"></td><td><pre>   +0x0ec WorkingSetPage   : Uint4B</pre></td></tr><tr><td data-num="22"></td><td><pre>   +0x0f0 AddressCreationLock : _FAST_MUTEX</pre></td></tr><tr><td data-num="23"></td><td><pre>   +0x110 HyperSpaceLock   : Uint4B</pre></td></tr><tr><td data-num="24"></td><td><pre>   +0x114 ForkInProgress   : Ptr32 _ETHREAD</pre></td></tr><tr><td data-num="25"></td><td><pre>   +0x118 HardwareTrigger  : Uint4B</pre></td></tr><tr><td data-num="26"></td><td><pre>   +0x11c VadRoot          : Ptr32 Void</pre></td></tr><tr><td data-num="27"></td><td><pre>   +0x120 VadHint          : Ptr32 Void</pre></td></tr><tr><td data-num="28"></td><td><pre>   +0x124 CloneRoot        : Ptr32 Void</pre></td></tr><tr><td data-num="29"></td><td><pre>   +0x128 NumberOfPrivatePages : Uint4B</pre></td></tr><tr><td data-num="30"></td><td><pre>   +0x12c NumberOfLockedPages : Uint4B</pre></td></tr><tr><td data-num="31"></td><td><pre>   +0x130 Win32Process     : Ptr32 Void</pre></td></tr><tr><td data-num="32"></td><td><pre>   +0x134 Job              : Ptr32 _EJOB</pre></td></tr><tr><td data-num="33"></td><td><pre>   +0x138 SectionObject    : Ptr32 Void</pre></td></tr><tr><td data-num="34"></td><td><pre>   +0x13c SectionBaseAddress : Ptr32 Void</pre></td></tr><tr><td data-num="35"></td><td><pre>   +0x140 QuotaBlock       : Ptr32 _EPROCESS_QUOTA_BLOCK</pre></td></tr><tr><td data-num="36"></td><td><pre>   +0x144 WorkingSetWatch  : Ptr32 _PAGEFAULT_HISTORY</pre></td></tr><tr><td data-num="37"></td><td><pre>   +0x148 Win32WindowStation : Ptr32 Void</pre></td></tr><tr><td data-num="38"></td><td><pre>   +0x14c InheritedFromUniqueProcessId : Ptr32 Void</pre></td></tr><tr><td data-num="39"></td><td><pre>   +0x150 LdtInformation   : Ptr32 Void</pre></td></tr><tr><td data-num="40"></td><td><pre>   +0x154 VadFreeHint      : Ptr32 Void</pre></td></tr><tr><td data-num="41"></td><td><pre>   +0x158 VdmObjects       : Ptr32 Void</pre></td></tr><tr><td data-num="42"></td><td><pre>   +0x15c DeviceMap        : Ptr32 Void</pre></td></tr><tr><td data-num="43"></td><td><pre>   +0x160 PhysicalVadList  : _LIST_ENTRY</pre></td></tr><tr><td data-num="44"></td><td><pre>   +0x168 PageDirectoryPte : _HARDWARE_PTE</pre></td></tr><tr><td data-num="45"></td><td><pre>   +0x168 Filler           : Uint8B</pre></td></tr><tr><td data-num="46"></td><td><pre>   +0x170 Session          : Ptr32 Void</pre></td></tr><tr><td data-num="47"></td><td><pre>   +0x174 ImageFileName    : [16] UChar</pre></td></tr><tr><td data-num="48"></td><td><pre>   +0x184 JobLinks         : _LIST_ENTRY</pre></td></tr><tr><td data-num="49"></td><td><pre>   +0x18c LockedPagesList  : Ptr32 Void</pre></td></tr><tr><td data-num="50"></td><td><pre>   +0x190 ThreadListHead   : _LIST_ENTRY</pre></td></tr><tr><td data-num="51"></td><td><pre>   +0x198 SecurityPort     : Ptr32 Void</pre></td></tr><tr><td data-num="52"></td><td><pre>   +0x19c PaeTop           : Ptr32 Void</pre></td></tr><tr><td data-num="53"></td><td><pre>   +0x1a0 ActiveThreads    : Uint4B</pre></td></tr><tr><td data-num="54"></td><td><pre>   +0x1a4 GrantedAccess    : Uint4B</pre></td></tr><tr><td data-num="55"></td><td><pre>   +0x1a8 DefaultHardErrorProcessing : Uint4B</pre></td></tr><tr><td data-num="56"></td><td><pre>   +0x1ac LastThreadExitStatus : Int4B</pre></td></tr><tr><td data-num="57"></td><td><pre>   +0x1b0 Peb              : Ptr32 _PEB</pre></td></tr><tr><td data-num="58"></td><td><pre>   +0x1b4 PrefetchTrace    : _EX_FAST_REF</pre></td></tr><tr><td data-num="59"></td><td><pre>   +0x1b8 ReadOperationCount : _LARGE_INTEGER</pre></td></tr><tr><td data-num="60"></td><td><pre>   +0x1c0 WriteOperationCount : _LARGE_INTEGER</pre></td></tr><tr><td data-num="61"></td><td><pre>   +0x1c8 OtherOperationCount : _LARGE_INTEGER</pre></td></tr><tr><td data-num="62"></td><td><pre>   +0x1d0 ReadTransferCount : _LARGE_INTEGER</pre></td></tr><tr><td data-num="63"></td><td><pre>   +0x1d8 WriteTransferCount : _LARGE_INTEGER</pre></td></tr><tr><td data-num="64"></td><td><pre>   +0x1e0 OtherTransferCount : _LARGE_INTEGER</pre></td></tr><tr><td data-num="65"></td><td><pre>   +0x1e8 CommitChargeLimit : Uint4B</pre></td></tr><tr><td data-num="66"></td><td><pre>   +0x1ec CommitChargePeak : Uint4B</pre></td></tr><tr><td data-num="67"></td><td><pre>   +0x1f0 AweInfo          : Ptr32 Void</pre></td></tr><tr><td data-num="68"></td><td><pre>   +0x1f4 SeAuditProcessCreationInfo : _SE_AUDIT_PROCESS_CREATION_INFO</pre></td></tr><tr><td data-num="69"></td><td><pre>   +0x1f8 Vm               : _MMSUPPORT</pre></td></tr><tr><td data-num="70"></td><td><pre>   +0x238 LastFaultCount   : Uint4B</pre></td></tr><tr><td data-num="71"></td><td><pre>   +0x23c ModifiedPageCount : Uint4B</pre></td></tr><tr><td data-num="72"></td><td><pre>   +0x240 NumberOfVads     : Uint4B</pre></td></tr><tr><td data-num="73"></td><td><pre>   +0x244 JobStatus        : Uint4B</pre></td></tr><tr><td data-num="74"></td><td><pre>   +0x248 Flags            : Uint4B</pre></td></tr><tr><td data-num="75"></td><td><pre>   +0x248 CreateReported   : Pos 0, 1 Bit</pre></td></tr><tr><td data-num="76"></td><td><pre>   +0x248 NoDebugInherit   : Pos 1, 1 Bit</pre></td></tr><tr><td data-num="77"></td><td><pre>   +0x248 ProcessExiting   : Pos 2, 1 Bit</pre></td></tr><tr><td data-num="78"></td><td><pre>   +0x248 ProcessDelete    : Pos 3, 1 Bit</pre></td></tr><tr><td data-num="79"></td><td><pre>   +0x248 Wow64SplitPages  : Pos 4, 1 Bit</pre></td></tr><tr><td data-num="80"></td><td><pre>   +0x248 VmDeleted        : Pos 5, 1 Bit</pre></td></tr><tr><td data-num="81"></td><td><pre>   +0x248 OutswapEnabled   : Pos 6, 1 Bit</pre></td></tr><tr><td data-num="82"></td><td><pre>   +0x248 Outswapped       : Pos 7, 1 Bit</pre></td></tr><tr><td data-num="83"></td><td><pre>   +0x248 ForkFailed       : Pos 8, 1 Bit</pre></td></tr><tr><td data-num="84"></td><td><pre>   +0x248 HasPhysicalVad   : Pos 9, 1 Bit</pre></td></tr><tr><td data-num="85"></td><td><pre>   +0x248 AddressSpaceInitialized : Pos 10, 2 Bits</pre></td></tr><tr><td data-num="86"></td><td><pre>   +0x248 SetTimerResolution : Pos 12, 1 Bit</pre></td></tr><tr><td data-num="87"></td><td><pre>   +0x248 BreakOnTermination : Pos 13, 1 Bit</pre></td></tr><tr><td data-num="88"></td><td><pre>   +0x248 SessionCreationUnderway : Pos 14, 1 Bit</pre></td></tr><tr><td data-num="89"></td><td><pre>   +0x248 WriteWatch       : Pos 15, 1 Bit</pre></td></tr><tr><td data-num="90"></td><td><pre>   +0x248 ProcessInSession : Pos 16, 1 Bit</pre></td></tr><tr><td data-num="91"></td><td><pre>   +0x248 OverrideAddressSpace : Pos 17, 1 Bit</pre></td></tr><tr><td data-num="92"></td><td><pre>   +0x248 HasAddressSpace  : Pos 18, 1 Bit</pre></td></tr><tr><td data-num="93"></td><td><pre>   +0x248 LaunchPrefetched : Pos 19, 1 Bit</pre></td></tr><tr><td data-num="94"></td><td><pre>   +0x248 InjectInpageErrors : Pos 20, 1 Bit</pre></td></tr><tr><td data-num="95"></td><td><pre>   +0x248 VmTopDown        : Pos 21, 1 Bit</pre></td></tr><tr><td data-num="96"></td><td><pre>   +0x248 Unused3          : Pos 22, 1 Bit</pre></td></tr><tr><td data-num="97"></td><td><pre>   +0x248 Unused4          : Pos 23, 1 Bit</pre></td></tr><tr><td data-num="98"></td><td><pre>   +0x248 VdmAllowed       : Pos 24, 1 Bit</pre></td></tr><tr><td data-num="99"></td><td><pre>   +0x248 Unused           : Pos 25, 5 Bits</pre></td></tr><tr><td data-num="100"></td><td><pre>   +0x248 Unused1          : Pos 30, 1 Bit</pre></td></tr><tr><td data-num="101"></td><td><pre>   +0x248 Unused2          : Pos 31, 1 Bit</pre></td></tr><tr><td data-num="102"></td><td><pre>   +0x24c ExitStatus       : Int4B</pre></td></tr><tr><td data-num="103"></td><td><pre>   +0x250 NextPageColor    : Uint2B</pre></td></tr><tr><td data-num="104"></td><td><pre>   +0x252 SubSystemMinorVersion : UChar</pre></td></tr><tr><td data-num="105"></td><td><pre>   +0x253 SubSystemMajorVersion : UChar</pre></td></tr><tr><td data-num="106"></td><td><pre>   +0x252 SubSystemVersion : Uint2B</pre></td></tr><tr><td data-num="107"></td><td><pre>   +0x254 PriorityClass    : UChar</pre></td></tr><tr><td data-num="108"></td><td><pre>   +0x255 WorkingSetAcquiredUnsafe : UChar</pre></td></tr><tr><td data-num="109"></td><td><pre>   +0x258 Cookie           : Uint4B</pre></td></tr></table></figure><p>其中第一个成员也是一个结构体 _KPROCESS</p><figure class="highlight raw"><figcaption data-lang=""></figcaption><table><tr><td data-num="1"></td><td><pre>kd&gt; dt _KPROCESS</pre></td></tr><tr><td data-num="2"></td><td><pre>ntdll!_KPROCESS</pre></td></tr><tr><td data-num="3"></td><td><pre>   +0x000 Header           : _DISPATCHER_HEADER</pre></td></tr><tr><td data-num="4"></td><td><pre>   +0x010 ProfileListHead  : _LIST_ENTRY</pre></td></tr><tr><td data-num="5"></td><td><pre>   +0x018 DirectoryTableBase : [2] Uint4B</pre></td></tr><tr><td data-num="6"></td><td><pre>   +0x020 LdtDescriptor    : _KGDTENTRY</pre></td></tr><tr><td data-num="7"></td><td><pre>   +0x028 Int21Descriptor  : _KIDTENTRY</pre></td></tr><tr><td data-num="8"></td><td><pre>   +0x030 IopmOffset       : Uint2B</pre></td></tr><tr><td data-num="9"></td><td><pre>   +0x032 Iopl             : UChar</pre></td></tr><tr><td data-num="10"></td><td><pre>   +0x033 Unused           : UChar</pre></td></tr><tr><td data-num="11"></td><td><pre>   +0x034 ActiveProcessors : Uint4B</pre></td></tr><tr><td data-num="12"></td><td><pre>   +0x038 KernelTime       : Uint4B</pre></td></tr><tr><td data-num="13"></td><td><pre>   +0x03c UserTime         : Uint4B</pre></td></tr><tr><td data-num="14"></td><td><pre>   +0x040 ReadyListHead    : _LIST_ENTRY</pre></td></tr><tr><td data-num="15"></td><td><pre>   +0x048 SwapListEntry    : _SINGLE_LIST_ENTRY</pre></td></tr><tr><td data-num="16"></td><td><pre>   +0x04c VdmTrapcHandler  : Ptr32 Void</pre></td></tr><tr><td data-num="17"></td><td><pre>   +0x050 ThreadListHead   : _LIST_ENTRY</pre></td></tr><tr><td data-num="18"></td><td><pre>   +0x058 ProcessLock      : Uint4B</pre></td></tr><tr><td data-num="19"></td><td><pre>   +0x05c Affinity         : Uint4B</pre></td></tr><tr><td data-num="20"></td><td><pre>   +0x060 StackCount       : Uint2B</pre></td></tr><tr><td data-num="21"></td><td><pre>   +0x062 BasePriority     : Char</pre></td></tr><tr><td data-num="22"></td><td><pre>   +0x063 ThreadQuantum    : Char</pre></td></tr><tr><td data-num="23"></td><td><pre>   +0x064 AutoAlignment    : UChar</pre></td></tr><tr><td data-num="24"></td><td><pre>   +0x065 State            : UChar</pre></td></tr><tr><td data-num="25"></td><td><pre>   +0x066 ThreadSeed       : UChar</pre></td></tr><tr><td data-num="26"></td><td><pre>   +0x067 DisableBoost     : UChar</pre></td></tr><tr><td data-num="27"></td><td><pre>   +0x068 PowerState       : UChar</pre></td></tr><tr><td data-num="28"></td><td><pre>   +0x069 DisableQuantum   : UChar</pre></td></tr><tr><td data-num="29"></td><td><pre>   +0x06a IdealNode        : UChar</pre></td></tr><tr><td data-num="30"></td><td><pre>   +0x06b Flags            : _KEXECUTE_OPTIONS</pre></td></tr><tr><td data-num="31"></td><td><pre>   +0x06b ExecuteOptions   : UChar</pre></td></tr></table></figure><h2 id="kprocess主要成员介绍"><a class="anchor" href="#kprocess主要成员介绍">#</a> KPROCESS 主要成员介绍</h2><p>内核层的进程对象。K 开头的是内核层的。</p><h3 id="0x000-header-_dispatcher_header"><a class="anchor" href="#0x000-header-_dispatcher_header">#</a> <strong>+0x000 Header : _DISPATCHER_HEADER</strong></h3><p>分发器对象 （dispatcher object），现在只需知道进程是可以被等待的就行。“可等待” 对象，比如 Mutex 互斥体、Event 事件等（WaitForSingleObject）</p><h3 id="0x018-directorytablebase-2-uint4b"><a class="anchor" href="#0x018-directorytablebase-2-uint4b">#</a> <strong>+0x018 DirectoryTableBase : [2] Uint4B</strong></h3><p>一个只有两项的数组，其中第一项指向该进程的也目录表地址，第二项指向该进程的超空间（hyper space）的页目录表地址。</p><h3 id="0x020-ldtdescriptor-_kgdtentry-0x028-int21descriptor-_kidtentry"><a class="anchor" href="#0x020-ldtdescriptor-_kgdtentry-0x028-int21descriptor-_kidtentry">#</a> <strong>【+0x020 LdtDescriptor : _KGDTENTRY】、【+0x028 Int21Descriptor : _KIDTENTRY】</strong></h3><p>历史遗留，16 位 Windows 段选择子不够 每个进程都有一个 LDT 表<br>Int21Descriptor 是 DOS 下要用的</p><h3 id="0x034-activeprocessors-uint4b"><a class="anchor" href="#0x034-activeprocessors-uint4b">#</a> <strong>+0x034 ActiveProcessors : Uint4B</strong></h3><p>ActiveProcessors 域记录了当前进程正在哪些处理器上运行。</p><h3 id="0x038-kerneltime-uint4b-0x03c-usertime-uint4b"><a class="anchor" href="#0x038-kerneltime-uint4b-0x03c-usertime-uint4b">#</a> <strong>【+0x038 KernelTime : Uint4B】、【+0x03c UserTime : Uint4B】</strong></h3><p>统计信息 记录了一个进程在内核模式 / 用户模式下所花的时间。进程的 <code>KernelTime</code> 和 <code>UserTime</code> 时间值等于所属线程对应的 <code>KernelTime</code> 和 <code>UserTime</code> 值的和。但是，由于仅当一个线程结束时才更新其进程的这两个时间值，所以，若一个进程中尚未有任何一个线程结束，则这两个域中的值为 0。</p><h3 id="0x040-readylisthead-_list_entry"><a class="anchor" href="#0x040-readylisthead-_list_entry">#</a> <strong>+0x040 ReadyListHead : _LIST_ENTRY</strong></h3><p><code>ReadyListHead</code> 是一个双向链表的表头，该链表记录了这个进程中处于就绪状态但尚未被加入全局就绪链表的线程，这个域的意义在于，当一个进程被换出内存以后，它所属的线程一旦就绪，则被挂到此链表中，并要求换入该进程；以后，当该进程被换入内存时， <code>ReadyListHead</code> 中的所有线程被加入到系统全局的就绪线程链表中。注意， <code>ReadyListHead</code> 链表中的每一项都是一个指向 <code>KTHREAD</code> 对象的 <code>WaitlistEntry</code> 域的地址，所以，从链表中的每一项都可以定位到对应的线程对象。例如，下面的代码片段是从 <code>KilnSwapProcesses</code> 函数中摘录的，从代码中可以看到 <code>ReadyListHead</code> 链表的用法。这段代码的意图是，将链表中的每个线程加入到全局就绪线程链表中（通过调用 <code>KiReadyThread</code> 来完成）。</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre>Process<span class="token operator">-></span>State<span class="token operator">=</span>ProcessInMemory；</pre></td></tr><tr><td data-num="2"></td><td><pre>NextEntry<span class="token operator">=</span>Process<span class="token operator">-></span>ReadyListHead<span class="token punctuation">.</span>Flink<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">while</span><span class="token punctuation">(</span>NextEntry l<span class="token operator">=</span><span class="token operator">&amp;</span>Process<span class="token operator">-></span>ReadyListHead<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  Thread<span class="token operator">=</span><span class="token function">CONTAINING_RECORD</span><span class="token punctuation">(</span>NextEntry<span class="token punctuation">,</span>KTHREAD<span class="token punctuation">,</span>WaitListEntry<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token function">RemoveEntryList</span><span class="token punctuation">(</span>NextEntry<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  Thread<span class="token operator">-></span>ProcessReadyQueue <span class="token operator">=</span>FALSE；</pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token function">KiReadyThread</span><span class="token punctuation">(</span>Thread<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  NextEntry<span class="token operator">=</span>Process<span class="token operator">-></span>ReadyListHead<span class="token punctuation">.</span>Flink<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="0x048-swaplistentry-_single_list_entry"><a class="anchor" href="#0x048-swaplistentry-_single_list_entry">#</a> <strong>+0x048 SwapListEntry : _SINGLE_LIST_ENTRY</strong></h3><p>SwapListEntry 域是一个单链表项，当一个进程要被换出内存时，它通过此域加入到以 KiProcessOurSwapListHead 为链头的单链表中；当一个进程要被换入内存时，它通过此域加入到以 KiProcessInSwapListHead 为链头的单链表中。这里，KiProcessOurSwapListHead 和 KiProcessInSwapListHead 是全局变量。</p><h3 id="0x05c-affinity-uint4b"><a class="anchor" href="#0x05c-affinity-uint4b">#</a> <strong>+0x05c Affinity : Uint4B</strong></h3><p>Affinity 域指定了该进程的线程可以在哪些处理器上运行，其类型是 KAFFINITY, 这是一个 32 位或 64 位整数，其二进制表示的每位分别对应于当前机器上的一个处理器 (或核)。</p><p>规定进程里面的所有线程能在哪个 CPU 上跑，如果值为 1，那这个进程的所以线程只能在 0 号 CPU 上跑 (00000001)<br>如果值为 3，那这个进程的所以线程能在 0、1 号 CPU 上跑 (000000011)<br>如果值为 4，那这个进程的所以线程能在 2 号 CPU 上跑 (000000100)<br>如果值为 5，那这个进程的所以线程能在 0，2 号 CPU 上跑 (000000101)<br>4 个字节共 32 位 所以最多 32 核 Windows64 位 就 64 核<br>如果只有一个 CPU 把这个设置为 4 那么这个进程就死了</p><h3 id="0x062-basepriority-char"><a class="anchor" href="#0x062-basepriority-char">#</a> <strong>+0x062 BasePriority : Char</strong></h3><p>基础优先级或最低优先级 该进程中的所有线程最起码的优先级.</p><h3 id="0x065-state-uchar"><a class="anchor" href="#0x065-state-uchar">#</a> <strong>+0x065 State : UChar</strong></h3><p>State 域说明了一个进程是否在内存中，共有六种可能的状态： <code>ProcessInMemory</code> 、 <code>ProcessOutOfMemory</code> 、 <code>ProcessInTransition</code> 、 <code>ProcessOutTransition</code> 、 <code>ProcessInSwap</code> 和 <code>ProcessOutSwap</code> 。所谓一个进程在内存中，或者已被换出，或者正在转移过程中，是指该进程的虚拟地址空间需要占据足够的物理内存，或者虚拟空间中的内容已被换出物理内存，或者正在换入或换出过程之中。</p><h2 id="eprocess其他成员"><a class="anchor" href="#eprocess其他成员">#</a> EPROCESS 其他成员</h2><p>执行体层的进程和线程对象。E 开头的。</p><h3 id="0x070-createtime-_large_integer-0x078-exittime-_large_integer"><a class="anchor" href="#0x070-createtime-_large_integer-0x078-exittime-_large_integer">#</a> <strong>【+0x070 CreateTime : _LARGE_INTEGER】、【+0x078 ExitTime : _LARGE_INTEGER】</strong></h3><p>进程的创建 / 退出时间。 没什么用，不准确。</p><h3 id="0x084-uniqueprocessid-ptr32-void"><a class="anchor" href="#0x084-uniqueprocessid-ptr32-void">#</a> <strong>+0x084 UniqueProcessId : Ptr32 Void</strong></h3><p>进程的编号 任务管理器中的 PID</p><h3 id="0x088-activeprocesslinks-_list_entry"><a class="anchor" href="#0x088-activeprocesslinks-_list_entry">#</a> <strong>+0x088 ActiveProcessLinks : _LIST_ENTRY</strong></h3><p>双向链表 所有的活动进程都连接在一起，构成了一个链表<br>PsActiveProcessHead 指向全局链表头</p><p><img data-src="image001.png" alt=""></p><h3 id="0x090-quotausage-3-uint4b-0x09c-quotapeak-3-uint4b"><a class="anchor" href="#0x090-quotausage-3-uint4b-0x09c-quotapeak-3-uint4b">#</a> <strong>【+0x090 QuotaUsage : [3] Uint4B】、【+0x09c QuotaPeak : [3] Uint4B】</strong></h3><p>物理页相关的统计信息</p><h3 id="0x0a8-commitcharge-uint4b-0x0ac-peakvirtualsize-uint4b-0x0b0-virtualsize-uint4b"><a class="anchor" href="#0x0a8-commitcharge-uint4b-0x0ac-peakvirtualsize-uint4b-0x0b0-virtualsize-uint4b">#</a> <strong>【+0x0a8 CommitCharge : Uint4B】、【+0x0ac PeakVirtualSize : Uint4B】、【+0x0b0 VirtualSize : Uint4B】</strong></h3><p>虚拟内存相关的统计信息</p><h3 id="0x11c-vadroot-ptr32-void"><a class="anchor" href="#0x11c-vadroot-ptr32-void">#</a> <strong>+0x11c VadRoot : Ptr32 Void</strong></h3><p>标识 0-2G 哪些地址被占用了</p><h3 id="0x0bc-debugport-ptr32-void-0x0c0-exceptionport-ptr32-void"><a class="anchor" href="#0x0bc-debugport-ptr32-void-0x0c0-exceptionport-ptr32-void">#</a> <strong>【+0x0bc DebugPort : Ptr32 Void】、【+0x0c0 ExceptionPort : Ptr32 Void】</strong></h3><p>调试相关</p><h3 id="0x0c4-objecttable-ptr32-_handle_table"><a class="anchor" href="#0x0c4-objecttable-ptr32-_handle_table">#</a> <strong>+0x0c4 ObjectTable : Ptr32 _HANDLE_TABLE</strong></h3><p>句柄表</p><h3 id="0x174-imagefilename-16-uchar"><a class="anchor" href="#0x174-imagefilename-16-uchar">#</a> <strong>+0x174 ImageFileName : [16] UChar</strong></h3><p>进程镜像文件名 最多 16 个字节</p><h3 id="0x1a0-activethreads-uint4b"><a class="anchor" href="#0x1a0-activethreads-uint4b">#</a> <strong>+0x1a0 ActiveThreads : Uint4B</strong></h3><p>活动线程的数量</p><h3 id="0x1b0-peb-ptr32-_peb"><a class="anchor" href="#0x1b0-peb-ptr32-_peb">#</a> <strong>+0x1b0 Peb : Ptr32 _PEB</strong></h3><p>PEB ((Process Environment Block 进程环境块)：进程在 3 环的一个结构体，里面包含了进程的模块列表、是否处于调试状态等信息。</p><p>关于 PEB 或者其他成员更加详细的说明：参考 潘爱民老师《Windows 内核原理与实现》 中的第 3 章</p><h1 id="本章总结"><a class="anchor" href="#本章总结">#</a> 本章总结</h1><p>0 环查看当前进程<br>通过 KPCR 找当前线程，然后找其 + 0x220 找当前进程。<br>后面通过学习进程的创建，来观察进程结构体是如何填充的。</p><h1 id="实验练习"><a class="anchor" href="#实验练习">#</a> 实验练习</h1><blockquote><ol><li>体会 DebugPort 的作用：用调试器（调试器最好没有插件）调试程序，然后把 进程结构体的 DebugPort 清零，在调试器里接着调试，观察会发生什么。</li></ol></blockquote><p>就不写代码更改了，直接用 windbg 修改了。<br>调试时 DebugPort 的值：</p><p><img data-src="image002.png" alt=""></p><p><img data-src="image003.png" alt=""></p><p>清空这个值后，在调试器里执行单步：</p><p><img data-src="image004.png" alt=""></p><p>直接报异常了。</p><blockquote><ol start="2"><li>0 环进程断链</li></ol></blockquote><p>代码如下：</p><p>没有写恢复的。</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;ntddk.h></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>VOID <span class="token function">DriverUnload</span><span class="token punctuation">(</span>PDRIVER_OBJECT pDriver<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>	<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"我是驱动，我卸载了\t\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>NTSTATUS <span class="token function">EProcessBreakChain</span><span class="token punctuation">(</span>PUCHAR ProcessName<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>	ULONG Pro<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>	<span class="token comment">// 由 KPCR+0x124 的位置得到当前 CPU 正在处理的线程的结构体的指针，_KTHREAD + 0x44 的位置能够得到此线程的进程结构体的地址</span></pre></td></tr><tr><td data-num="12"></td><td><pre>	__asm <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>		mov eax<span class="token punctuation">,</span> fs<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0x124</span><span class="token punctuation">]</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>		mov ecx<span class="token punctuation">,</span> <span class="token punctuation">[</span>eax <span class="token operator">+</span> <span class="token number">0x44</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>		mov Pro<span class="token punctuation">,</span> ecx<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>	<span class="token comment">// 进程结构体 EPROCESS +0x88 的位置是一个链接所有进程的双向链表</span></pre></td></tr><tr><td data-num="18"></td><td><pre>	PLIST_ENTRY pListProcess <span class="token operator">=</span> <span class="token punctuation">(</span>PLIST_ENTRY<span class="token punctuation">)</span><span class="token punctuation">(</span>Pro <span class="token operator">+</span> <span class="token number">0x88</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>	<span class="token comment">// 遍历进程</span></pre></td></tr><tr><td data-num="20"></td><td><pre>	<span class="token keyword">while</span> <span class="token punctuation">(</span>pListProcess<span class="token operator">-></span>Flink <span class="token operator">!=</span> <span class="token punctuation">(</span>PLIST_ENTRY<span class="token punctuation">)</span><span class="token punctuation">(</span>Pro <span class="token operator">+</span> <span class="token number">0x88</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>		<span class="token comment">//EPROCESS 结构体</span></pre></td></tr><tr><td data-num="23"></td><td><pre>		ULONG NextProcess <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ULONG<span class="token punctuation">)</span><span class="token punctuation">(</span>pListProcess<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0x88</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre>		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>ProcessName<span class="token punctuation">,</span> <span class="token punctuation">(</span>PCHAR<span class="token punctuation">)</span><span class="token punctuation">(</span>NextProcess <span class="token operator">+</span> <span class="token number">0x174</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>			<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"FindProcess:%s PEPROCESS:%X\t\n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>PCHAR<span class="token punctuation">)</span>NextProcess <span class="token operator">+</span> <span class="token number">0x174</span><span class="token punctuation">)</span><span class="token punctuation">,</span> NextProcess<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>			<span class="token comment">// 断链</span></pre></td></tr><tr><td data-num="29"></td><td><pre>			PLIST_ENTRY CurPro <span class="token operator">=</span> <span class="token punctuation">(</span>PLIST_ENTRY<span class="token punctuation">)</span><span class="token punctuation">(</span>NextProcess<span class="token operator">+</span> <span class="token number">0x88</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>			PLIST_ENTRY BlinkPro <span class="token operator">=</span> CurPro<span class="token operator">-></span>Blink<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>			PLIST_ENTRY FlinkPro <span class="token operator">=</span> CurPro<span class="token operator">-></span>Flink<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>			BlinkPro<span class="token operator">-></span>Flink <span class="token operator">=</span> FlinkPro<span class="token operator">-></span>Flink<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>			FlinkPro<span class="token operator">-></span>Blink <span class="token operator">=</span> BlinkPro<span class="token operator">-></span>Flink<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>			<span class="token keyword">return</span> STATUS_SUCCESS<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>		pListProcess <span class="token operator">=</span> pListProcess<span class="token operator">-></span>Flink<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>	<span class="token keyword">return</span> STATUS_UNSUCCESSFUL<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>NTSTATUS <span class="token function">DriverEntry</span><span class="token punctuation">(</span>PDRIVER_OBJECT pDriver<span class="token punctuation">,</span> PUNICODE_STRING pRegPath<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>	NTSTATUS ntStatus <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>	pDriver<span class="token operator">-></span>DriverUnload <span class="token operator">=</span> DriverUnload<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>	<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"我是驱动,我运行了\t\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre></pre></td></tr><tr><td data-num="45"></td><td><pre>	<span class="token comment">//r0 进程断链</span></pre></td></tr><tr><td data-num="46"></td><td><pre></pre></td></tr><tr><td data-num="47"></td><td><pre>	<span class="token comment">// 遍历进程	 断链</span></pre></td></tr><tr><td data-num="48"></td><td><pre>	ntStatus <span class="token operator">=</span> <span class="token function">EProcessBreakChain</span><span class="token punctuation">(</span><span class="token string">"Dbgview.exe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre></pre></td></tr><tr><td data-num="50"></td><td><pre>	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>ntStatus<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="51"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>		<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"断链失败！！\t\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>		<span class="token keyword">return</span> ntStatus<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>	<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"断链成功！！\t\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>	<span class="token keyword">return</span> STATUS_SUCCESS<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="image001.png" alt=""></p><h1 id="reference"><a class="anchor" href="#reference">#</a> Reference</h1><p>潘爱民前辈的《Windows 内核原理与实现》一书。</p><div class="tags"><a href="/tags/EPROCESS/" rel="tag"><i class="ic i-tag"></i> EPROCESS</a> <a href="/tags/KPROCESS/" rel="tag"><i class="ic i-tag"></i> KPROCESS</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2022-07-27 14:40:35" itemprop="dateModified" datetime="2022-07-27T14:40:35+08:00">2022-07-27</time> </span><span id="Bin/Core/WindowsXp/Process-Thread/进程与线程-进程结构体/" class="item leancloud_visitors" data-flag-title="进程与线程-进程结构体" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/reward.jpg" alt="Or0kit 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Or0kit <i class="ic i-at"><em>@</em></i>Or0kit</li><li class="link"><strong>本文链接：</strong> <a href="https://or0kit.github.io/Bin/Core/WindowsXp/Process-Thread/%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B-%E8%BF%9B%E7%A8%8B%E7%BB%93%E6%9E%84%E4%BD%93/" title="进程与线程-进程结构体">https://or0kit.github.io/Bin/Core/WindowsXp/Process-Thread/进程与线程-进程结构体/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/Bin/Core/WindowsXp/SystemCall/%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8-%E8%AF%BE%E5%90%8E%E7%BB%83%E4%B9%A0/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva2.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gicli9lfebj20zk0m84qp.jpg" title="系统调用-课后练习"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 系统调用</span><h3>系统调用-课后练习</h3></a></div><div class="item right"><a href="/Bin/Core/WindowsXp/Process-Thread/%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B-%E7%BA%BF%E7%A8%8B%E7%BB%93%E6%9E%84%E4%BD%93/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva2.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipesng5oej20zk0m87d4.jpg" title="进程与线程-线程结构体"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 进程与线程</span><h3>进程与线程-线程结构体</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B"><span class="toc-number">1.</span> <span class="toc-text">进程</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E7%BB%93%E6%9E%84%E4%BD%93-eproccess"><span class="toc-number">2.</span> <span class="toc-text">进程结构体 EPROCCESS</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#kprocess%E4%B8%BB%E8%A6%81%E6%88%90%E5%91%98%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.1.</span> <span class="toc-text">KPROCESS 主要成员介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0x000-header-_dispatcher_header"><span class="toc-number">2.1.1.</span> <span class="toc-text">+0x000 Header : _DISPATCHER_HEADER</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x018-directorytablebase-2-uint4b"><span class="toc-number">2.1.2.</span> <span class="toc-text">+0x018 DirectoryTableBase : [2] Uint4B</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x020-ldtdescriptor-_kgdtentry-0x028-int21descriptor-_kidtentry"><span class="toc-number">2.1.3.</span> <span class="toc-text">【+0x020 LdtDescriptor : _KGDTENTRY】、【+0x028 Int21Descriptor : _KIDTENTRY】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x034-activeprocessors-uint4b"><span class="toc-number">2.1.4.</span> <span class="toc-text">+0x034 ActiveProcessors : Uint4B</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x038-kerneltime-uint4b-0x03c-usertime-uint4b"><span class="toc-number">2.1.5.</span> <span class="toc-text">【+0x038 KernelTime : Uint4B】、【+0x03c UserTime : Uint4B】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x040-readylisthead-_list_entry"><span class="toc-number">2.1.6.</span> <span class="toc-text">+0x040 ReadyListHead : _LIST_ENTRY</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x048-swaplistentry-_single_list_entry"><span class="toc-number">2.1.7.</span> <span class="toc-text">+0x048 SwapListEntry : _SINGLE_LIST_ENTRY</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x05c-affinity-uint4b"><span class="toc-number">2.1.8.</span> <span class="toc-text">+0x05c Affinity : Uint4B</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x062-basepriority-char"><span class="toc-number">2.1.9.</span> <span class="toc-text">+0x062 BasePriority : Char</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x065-state-uchar"><span class="toc-number">2.1.10.</span> <span class="toc-text">+0x065 State : UChar</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#eprocess%E5%85%B6%E4%BB%96%E6%88%90%E5%91%98"><span class="toc-number">2.2.</span> <span class="toc-text">EPROCESS 其他成员</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0x070-createtime-_large_integer-0x078-exittime-_large_integer"><span class="toc-number">2.2.1.</span> <span class="toc-text">【+0x070 CreateTime : _LARGE_INTEGER】、【+0x078 ExitTime : _LARGE_INTEGER】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x084-uniqueprocessid-ptr32-void"><span class="toc-number">2.2.2.</span> <span class="toc-text">+0x084 UniqueProcessId : Ptr32 Void</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x088-activeprocesslinks-_list_entry"><span class="toc-number">2.2.3.</span> <span class="toc-text">+0x088 ActiveProcessLinks : _LIST_ENTRY</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x090-quotausage-3-uint4b-0x09c-quotapeak-3-uint4b"><span class="toc-number">2.2.4.</span> <span class="toc-text">【+0x090 QuotaUsage : [3] Uint4B】、【+0x09c QuotaPeak : [3] Uint4B】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x0a8-commitcharge-uint4b-0x0ac-peakvirtualsize-uint4b-0x0b0-virtualsize-uint4b"><span class="toc-number">2.2.5.</span> <span class="toc-text">【+0x0a8 CommitCharge : Uint4B】、【+0x0ac PeakVirtualSize : Uint4B】、【+0x0b0 VirtualSize : Uint4B】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x11c-vadroot-ptr32-void"><span class="toc-number">2.2.6.</span> <span class="toc-text">+0x11c VadRoot : Ptr32 Void</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x0bc-debugport-ptr32-void-0x0c0-exceptionport-ptr32-void"><span class="toc-number">2.2.7.</span> <span class="toc-text">【+0x0bc DebugPort : Ptr32 Void】、【+0x0c0 ExceptionPort : Ptr32 Void】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x0c4-objecttable-ptr32-_handle_table"><span class="toc-number">2.2.8.</span> <span class="toc-text">+0x0c4 ObjectTable : Ptr32 _HANDLE_TABLE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x174-imagefilename-16-uchar"><span class="toc-number">2.2.9.</span> <span class="toc-text">+0x174 ImageFileName : [16] UChar</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x1a0-activethreads-uint4b"><span class="toc-number">2.2.10.</span> <span class="toc-text">+0x1a0 ActiveThreads : Uint4B</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x1b0-peb-ptr32-_peb"><span class="toc-number">2.2.11.</span> <span class="toc-text">+0x1b0 Peb : Ptr32 _PEB</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%AC%E7%AB%A0%E6%80%BB%E7%BB%93"><span class="toc-number">3.</span> <span class="toc-text">本章总结</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%BB%83%E4%B9%A0"><span class="toc-number">4.</span> <span class="toc-text">实验练习</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#reference"><span class="toc-number">5.</span> <span class="toc-text">Reference</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/Bin/Core/WindowsXp/Process-Thread/%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B-%E8%BF%9B%E7%A8%8B%E7%BB%93%E6%9E%84%E4%BD%93/" rel="bookmark" title="进程与线程-进程结构体">进程与线程-进程结构体</a></li><li><a href="/Bin/Core/WindowsXp/Process-Thread/%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B-%E7%BA%BF%E7%A8%8B%E7%BB%93%E6%9E%84%E4%BD%93/" rel="bookmark" title="进程与线程-线程结构体">进程与线程-线程结构体</a></li><li><a href="/Bin/Core/WindowsXp/Process-Thread/%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B-KPCR/" rel="bookmark" title="进程与线程-KPCR">进程与线程-KPCR</a></li><li><a href="/Bin/Core/WindowsXp/Process-Thread/%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B-%E7%AD%89%E5%BE%85%E9%93%BE%E8%A1%A8%E4%B8%8E%E8%B0%83%E5%BA%A6%E9%93%BE%E8%A1%A8/" rel="bookmark" title="进程与线程-等待链表与调度链表">进程与线程-等待链表与调度链表</a></li><li><a href="/Bin/Core/WindowsXp/Process-Thread/%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B-%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%88%9B%E5%BB%BA/" rel="bookmark" title="进程与线程-进程的创建">进程与线程-进程的创建</a></li><li><a href="/Bin/Core/WindowsXp/Process-Thread/%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B-%E6%A8%A1%E6%8B%9F%E7%BA%BF%E7%A8%8B%E5%88%87%E6%8D%A2/" rel="bookmark" title="进程与线程-模拟线程切换">进程与线程-模拟线程切换</a></li><li><a href="/Bin/Core/WindowsXp/Process-Thread/%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B-Windows%E7%BA%BF%E7%A8%8B%E5%88%87%E6%8D%A2/" rel="bookmark" title="进程与线程-Windows线程切换">进程与线程-Windows线程切换</a></li><li><a href="/Bin/Core/WindowsXp/Process-Thread/%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B-%E8%BF%9B%E7%A8%8B%E6%8C%82%E9%9D%A0%E5%92%8C%E8%B7%A8%E8%BF%9B%E7%A8%8B%E8%AF%BB%E5%86%99%E5%86%85%E5%AD%98/" rel="bookmark" title="进程与线程-进程挂靠和跨进程读写内存">进程与线程-进程挂靠和跨进程读写内存</a></li><li><a href="/Bin/Core/WindowsXp/Process-Thread/%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B-%E5%BB%B6%E8%BF%9F%E8%BF%87%E7%A8%8B%E8%B0%83%E7%94%A8-DPC/" rel="bookmark" title="进程与线程-延迟过程调用(DPC)">进程与线程-延迟过程调用(DPC)</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Or0kit" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Or0kit</p><div class="description" itemprop="description">临渊羡鱼，不如退而结网</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">213</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">48</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">386</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29t" title="https:&#x2F;&#x2F;github.com"><i class="ic i-github"></i></span> <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;twitter.com&#x2F;yourname"><i class="ic i-twitter"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;yourname"><i class="ic i-zhihu"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPXlvdXJuYW1l" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;yourname"><i class="ic i-cloud-music"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20veW91cm5hbWU=" title="https:&#x2F;&#x2F;weibo.com&#x2F;yourname"><i class="ic i-weibo"></i></span> <span class="exturl item youtube" data-url="aHR0cHM6Ly95b3V0dWJlLmNvbS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;youtube.com&#x2F;yourname"><i class="ic i-youtube"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>links</a></li></ul></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/Bin/Core/WindowsXp/SystemCall/%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8-%E8%AF%BE%E5%90%8E%E7%BB%83%E4%B9%A0/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/Bin/Core/WindowsXp/Process-Thread/%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B-%E7%BA%BF%E7%A8%8B%E7%BB%93%E6%9E%84%E4%BD%93/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/%E5%AF%86%E7%A0%81%E7%BC%96%E7%A0%81%E5%AD%A6%E4%B8%8E%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" title="分类于 密码编码学与网络安全">密码编码学与网络安全</a></div><span><a href="/%E5%AF%86%E7%A0%81%E5%AD%A6%E6%95%B0%E8%AE%BA%E5%9F%BA%E7%A1%80/" title="密码学数论基础">密码学数论基础</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/PenetrationTest/" title="分类于 渗透测试">渗透测试</a> <i class="ic i-angle-right"></i> <a href="/categories/PenetrationTest/Reference/" title="分类于 转载">转载</a></div><span><a href="/PenetrationTest/Reference/awesome-web-security/" title="Awesome Web Security【转】">Awesome Web Security【转】</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/web/" title="分类于 web">web</a></div><span><a href="/PenetrationTest/Web-Security/apache%E8%AE%BF%E9%97%AE%E6%97%A5%E5%BF%97%E8%AF%A6%E8%A7%A3%E3%80%90%E8%BD%AC%E3%80%91/" title="apache访问日志详解【转】">apache访问日志详解【转】</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Linux/" title="分类于 Linux">Linux</a></div><span><a href="/Linux/Linux%E9%98%B2%E7%81%AB%E5%A2%99-fwsnort%E7%9A%84%E5%AE%89%E8%A3%85/" title="Linux防火墙-fwsnort的安装">Linux防火墙-fwsnort的安装</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Bin/" title="分类于 逆向">逆向</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/Core/" title="分类于 内核学习">内核学习</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/Core/WindowsXp/" title="分类于 Xp内核分析">Xp内核分析</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/Core/WindowsXp/SystemCall/" title="分类于 系统调用">系统调用</a></div><span><a href="/Bin/Core/WindowsXp/SystemCall/%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8-%E6%80%BB%E7%BB%93/" title="系统调用-总结">系统调用-总结</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Bin/" title="分类于 逆向">逆向</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/Win32/" title="分类于 Win32">Win32</a></div><span><a href="/Bin/Win32/%E9%80%9A%E7%94%A8%E6%8E%A7%E4%BB%B6%E4%B8%8EWM_NOTIFY%E6%B6%88%E6%81%AF/" title="通用控件与WM_NOTIFY消息">通用控件与WM_NOTIFY消息</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Programming/" title="分类于 编程">编程</a> <i class="ic i-angle-right"></i> <a href="/categories/Programming/STL/" title="分类于 STL">STL</a></div><span><a href="/Programming/STL/STL%E5%AE%B9%E5%99%A8/" title="STL容器">STL容器</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/PenetrationTest/" title="分类于 渗透测试">渗透测试</a> <i class="ic i-angle-right"></i> <a href="/categories/PenetrationTest/Web-Security/" title="分类于 web安全">web安全</a></div><span><a href="/PenetrationTest/Web-Security/%E5%88%9D%E5%AD%A6webshell%E6%A3%80%E6%B5%8B/" title="初学webshell检测">初学webshell检测</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Bin/" title="分类于 逆向">逆向</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/WindowsPE/" title="分类于 WindowsPE">WindowsPE</a></div><span><a href="/Bin/WindowsPE/%E5%AF%BC%E5%87%BA%E8%A1%A8/" title="导出表">导出表</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Programming/" title="分类于 编程">编程</a> <i class="ic i-angle-right"></i> <a href="/categories/Programming/Python/" title="分类于 Python">Python</a></div><span><a href="/Programming/Python/python%E8%BF%9B%E7%A8%8B%E7%BA%BF%E7%A8%8B/" title="python进程线程">python进程线程</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Or0kit @ Or0kit</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">1.7m 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">25:02</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"Bin/Core/WindowsXp/Process-Thread/进程与线程-进程结构体/",favicon:{show:"╰(*°▽°*)╯正在变强中",hide:"(ー`′ー)快回来"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{scale:1,hHeadPos:.5,vHeadPos:.618,jsonPath:"/live2dw/assets/koharu.model.json"},display:{superSample:2,width:150,height:300,position:"right",hOffset:0,vOffset:-20},mobile:{show:!0,scale:.5},react:{opacityDefault:.7,opacityOnHover:.8},log:!1})</script></body></html><!-- rebuild by hrmmi -->