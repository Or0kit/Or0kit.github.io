<!-- build time:Wed Mar 22 2023 00:57:33 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="Or0kit" href="https://or0kit.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="Or0kit" href="https://or0kit.github.io/atom.xml"><link rel="alternate" type="application/json" title="Or0kit" href="https://or0kit.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="AD-Attack-Defense"><link rel="canonical" href="https://or0kit.github.io/PenetrationTest/Reference/AD-Attack-Defense/"><title>Active Directory Kill Chain Attack & Defense【转】 - 转载 - 渗透测试 | Or0kit = Or0kit</title><meta name="generator" content="Hexo 5.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Active Directory Kill Chain Attack & Defense【转】</h1><div class="meta"><span class="item" title="创建时间：2021-01-18 15:08:48"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2021-01-18T15:08:48+08:00">2021-01-18</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>28k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>25 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Or0kit</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="http://storage.live.com/items/70930153B02A575!294?authkey=AGDHHD5Qh4Y5OtQ"></li><li class="item" data-background-image="http://storage.live.com/items/70930153B02A575!365?authkey=AGDHHD5Qh4Y5OtQ"></li><li class="item" data-background-image="http://storage.live.com/items/70930153B02A575!389?authkey=AGDHHD5Qh4Y5OtQ"></li><li class="item" data-background-image="http://storage.live.com/items/70930153B02A575!366?authkey=AGDHHD5Qh4Y5OtQ"></li><li class="item" data-background-image="http://storage.live.com/items/70930153B02A575!379?authkey=AGDHHD5Qh4Y5OtQ"></li><li class="item" data-background-image="http://storage.live.com/items/70930153B02A575!376?authkey=AGDHHD5Qh4Y5OtQ"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/PenetrationTest/" itemprop="item" rel="index" title="分类于 渗透测试"><span itemprop="name">渗透测试</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/PenetrationTest/Reference/" itemprop="item" rel="index" title="分类于 转载"><span itemprop="name">转载</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://or0kit.github.io/PenetrationTest/Reference/AD-Attack-Defense/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Or0kit"><meta itemprop="description" content=", 临渊羡鱼，不如退而结网"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Or0kit"></span><div class="body md" itemprop="articleBody"><h1 id="active-directory-kill-chain-attack-defense"><a class="anchor" href="#active-directory-kill-chain-attack-defense">#</a> Active Directory Kill Chain Attack &amp; Defense</h1><img width="650" data-src="https://camo.githubusercontent.com/9547d8152e3490a6e5e3da0279faab64340885be/68747470733a2f2f646f63732e6d6963726f736f66742e636f6d2f656e2d75732f616476616e6365642d7468726561742d616e616c79746963732f6d656469612f61747461636b2d6b696c6c2d636861696e2d736d616c6c2e6a7067"><h2 id="summary"><a class="anchor" href="#summary">#</a> Summary</h2><p>This document was designed to be a useful, informational asset for those looking to understand the specific tactics, techniques, and procedures (TTPs) attackers are leveraging to compromise active directory and guidance to mitigation, detection, and prevention. And understand Active Directory Kill Chain Attack and Modern Post Exploitation Adversary Tradecraft Activity.</p><h2 id="table-of-contents"><a class="anchor" href="#table-of-contents">#</a> Table of Contents</h2><ul><li><a href="#discovery">Discovery</a></li><li><a href="#privilege-escalation">Privilege Escalation</a></li><li><a href="#defense-evasion">Defense Evasion</a></li><li><a href="#credential-dumping">Credential Dumping</a></li><li><a href="#lateral-movement">Lateral Movement</a></li><li><a href="#persistence">Persistence</a></li><li><a href="#defense-&amp;-detection">Defense &amp; Detection</a></li></ul><hr><h2 id="discovery"><a class="anchor" href="#discovery">#</a> Discovery</h2><h3 id="spn-scanning"><a class="anchor" href="#spn-scanning">#</a> SPN Scanning</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0xNTA4">SPN Scanning – Service Discovery without Network Port Scanning</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9zb2NpYWwudGVjaG5ldC5taWNyb3NvZnQuY29tL3dpa2kvY29udGVudHMvYXJ0aWNsZXMvMTg5OTYuYWN0aXZlLWRpcmVjdG9yeS1wb3dlcnNoZWxsLXNjcmlwdC10by1saXN0LWFsbC1zcG5zLXVzZWQuYXNweA==">Active Directory: PowerShell script to list all SPNs used</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnN0ZWFsdGhiaXRzLmNvbS9kaXNjb3ZlcmluZy1zZXJ2aWNlLWFjY291bnRzLXdpdGhvdXQtdXNpbmctcHJpdmlsZWdlcy8=">Discovering Service Accounts Without Using Privileges</span></li></ul><h3 id="data-mining"><a class="anchor" href="#data-mining">#</a> Data Mining</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly90aGV2aXZpLm5ldC8yMDE4LzA1LzIzL2EtZGF0YS1odW50aW5nLW92ZXJ2aWV3Lw==">A Data Hunting Overview</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFybWoweS5uZXQvYmxvZy9yZWR0ZWFtaW5nL3B1c2gtaXQtcHVzaC1pdC1yZWFsLWdvb2Qv">Push it, Push it Real Good</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLm5ldHNwaS5jb20vZmluZGluZy1zZW5zaXRpdmUtZGF0YS1kb21haW4tc3FsLXNlcnZlcnMtdXNpbmctcG93ZXJ1cHNxbC8=">Finding Sensitive Data on Domain SQL Servers using PowerUpSQL</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1aSU93X3hmcWtLTQ==">Sensitive Data Discovery in Email with MailSniper</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuZm9ydHlub3J0aHNlY3VyaXR5LmNvbS9yZW1vdGVseS1zZWFyY2gv">Remotely Searching for Sensitive Files</span></li><li><span class="exturl" data-url="aHR0cDovL3d3dy5oYXJtajB5Lm5ldC9ibG9nL3BlbmV0ZXN0aW5nL2ktaHVudC1zeXNhZG1pbnMv">I Hunt Sysadmins - harmj0y</span></li></ul><h3 id="user-hunting"><a class="anchor" href="#user-hunting">#</a> User Hunting</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY3Jvd2RzdHJpa2UuY29tL2Jsb2cvaGlkZGVuLWFkbWluaXN0cmF0aXZlLWFjY291bnRzLWJsb29kaG91bmQtdG8tdGhlLXJlc2N1ZS8=">Hidden Administrative Accounts: BloodHound to the Rescue</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0yNTM1">Active Directory Recon Without Admin Rights</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0zNzE5">Gathering AD Data with the Active Directory PowerShell Module</span></li><li><span class="exturl" data-url="aHR0cDovL3d3dy5sYWJvZmFwZW5ldHJhdGlvbnRlc3Rlci5jb20vMjAxOC8xMC9kb21haW4tZW51bWVyYXRpb24tZnJvbS1Qb3dlclNoZWxsLUNMTS5odG1s">Using ActiveDirectory module for Domain Enumeration from PowerShell Constrained Language Mode</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL05ldFNQSS9Qb3dlclVwU1FML3dpa2kvQWN0aXZlLURpcmVjdG9yeS1SZWNvbi1GdW5jdGlvbnM=">PowerUpSQL Active Directory Recon Functions</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2l4ZHViLm5ldC8/cD01OTE=">Derivative Local Admin</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLm5ldHNwaS5jb20vZHVtcGluZy1hY3RpdmUtZGlyZWN0b3J5LWRvbWFpbi1pbmZvLXdpdGgtcG93ZXJ1cHNxbC8=">Dumping Active Directory Domain Info – with PowerUpSQL!</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFybWoweS5uZXQvYmxvZy9yZWR0ZWFtaW5nL2xvY2FsLWdyb3VwLWVudW1lcmF0aW9uLw==">Local Group Enumeration</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnN0ZWFsdGhiaXRzLmNvbS9sb2NhbC1hZG1pbi1tYXBwaW5nLWJsb29kaG91bmQ=">Attack Mapping With Bloodhound</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9wZW50ZXN0bGFiLmJsb2cvMjAxOC8wNS8yOC9zaXR1YXRpb25hbC1hd2FyZW5lc3Mv">Situational Awareness</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuamF2ZWxpbi1uZXR3b3Jrcy5jb20vc3RhdGljLzVmY2M2ZTg0LnBkZg==">Commands for Domain Network Compromise</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFybWoweS5uZXQvYmxvZy9hY3RpdmVkaXJlY3RvcnkvYS1wZW50ZXN0ZXJzLWd1aWRlLXRvLWdyb3VwLXNjb3Bpbmcv">A Pentester’s Guide to Group Scoping</span></li></ul><h3 id="laps"><a class="anchor" href="#laps">#</a> LAPS</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0zMTY0">Microsoft LAPS Security &amp; Active Directory LAPS Configuration Recon</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFybWoweS5uZXQvYmxvZy9wb3dlcnNoZWxsL3J1bm5pbmctbGFwcy13aXRoLXBvd2Vydmlldy8=">Running LAPS with PowerView</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9yYXN0YW1vdXNlLm1lL3RhZ3MvbGFwcy8=">RastaMouse LAPS Part 1 &amp; 2</span></li></ul><h3 id="applocker"><a class="anchor" href="#applocker">#</a> AppLocker</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9yYXN0YW1vdXNlLm1lLzIwMTgvMDkvZW51bWVyYXRpbmctYXBwbG9ja2VyLWNvbmZpZy8=">Enumerating AppLocker Config</span></li></ul><h3 id="azure"><a class="anchor" href="#azure">#</a> Azure</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2xpZGVzaGFyZS5uZXQvRGlya2phbk1vbGxlbWEvaW0taW4teW91ci1jbG91ZC1yZWFkaW5nLWV2ZXJ5b25lcy1lbWFpbC1oYWNraW5nLWF6dXJlLWFkLXZpYS1hY3RpdmUtZGlyZWN0b3J5">I'm in your cloud... reading everyone's email. Hacking Azure AD via Active Directory</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLm5ldHNwaS5jb20vdXRpaWx6aW5nLWF6dXJlLWZvci1yZWQtdGVhbS1lbmdhZ2VtZW50cy8=">Utilizing Azure Services for Red Team Engagements</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9zcGVha2VyZGVjay5jb20vdHdlZWtmYXdrZXMvYmx1ZS1jbG91ZC1vZi1kZWF0aC1yZWQtdGVhbWluZy1henVyZS0x">Blue Cloud of Death: Red Teaming Azure</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnhwbnNlYy5jb20vYXp1cmVhZC1jb25uZWN0LWZvci1yZWR0ZWFtLw==">Azure AD Connect for Red Teamers</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmxhY2toaWxsc2luZm9zZWMuY29tL3JlZC10ZWFtaW5nLW1pY3Jvc29mdC1wYXJ0LTEtYWN0aXZlLWRpcmVjdG9yeS1sZWFrcy12aWEtYXp1cmUv">Red Teaming Microsoft: Part 1 – Active Directory Leaks via Azure</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy93cC1jb250ZW50L3VwbG9hZHMvMjAxOS8wOC8yMDE5LUJsYWNrSGF0LVVTLU1ldGNhbGYtTW9yb3djenluc2tpLUF0dGFja2luZ0FuZERlZmVuZGluZ1RoZU1pY3Jvc29mdENsb3VkLnBkZg==">Attacking &amp; Defending the Microsoft Cloud</span></li></ul><h3 id="active-directory-federation-services"><a class="anchor" href="#active-directory-federation-services">#</a> Active Directory Federation Services</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1vVHlMZEFVanczMA==">118 Attacking ADFS Endpoints with PowerShell Karl Fosaaen</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLm5ldHNwaS5jb20vdXNpbmctcG93ZXJzaGVsbC1pZGVudGlmeS1mZWRlcmF0ZWQtZG9tYWlucy8=">Using PowerShell to Identify Federated Domains</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21kc2VjcmVzZWFyY2gvTHluY1NuaXBlcg==">LyncSniper: A tool for penetration testing Skype for Business and Lync deployments</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2xpZGVzaGFyZS5uZXQvRG91Z2xhc0JpZW5zdG9jay90cm9vcGVycy0xOS1pLWFtLWFkLWZzLWFuZC1zby1jYW4teW91">Troopers 19 - I am AD FS and So Can You</span></li></ul><hr><h2 id="privilege-escalation"><a class="anchor" href="#privilege-escalation">#</a> Privilege Escalation</h2><h3 id="zerologon"><a class="anchor" href="#zerologon">#</a> Zerologon</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3JzbXVkZ2UvWmVyb0xvZ29uLUJPRg==">Cobalt Strike ZeroLogon-BOF</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2RpcmtqYW5tL0NWRS0yMDIwLTE0NzI=">CVE-2020-1472 POC</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2VjdXJhLmNvbS9ibG9nL3plcm8tbG9nb24=">Zerologon: instantly become domain admin by subverting Netlogon cryptography (CVE-2020-1472)</span></li></ul><h3 id="passwords-in-sysvol-group-policy-preferences"><a class="anchor" href="#passwords-in-sysvol-group-policy-preferences">#</a> Passwords in SYSVOL &amp; Group Policy Preferences</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0yMjg4">Finding Passwords in SYSVOL &amp; Exploiting Group Policy Preferences</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnJhcGlkNy5jb20vMjAxNi8wNy8yNy9wZW50ZXN0aW5nLWluLXRoZS1yZWFsLXdvcmxkLWdyb3VwLXBvbGljeS1wd25hZ2Uv">Pentesting in the Real World: Group Policy Pwnage</span></li></ul><h3 id="ms14-068-kerberos-vulnerability"><a class="anchor" href="#ms14-068-kerberos-vulnerability">#</a> MS14-068 Kerberos Vulnerability</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD01MjU=">MS14-068: Vulnerability in (Active Directory) Kerberos Could Allow Elevation of Privilege</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9sYWJzLm13cmluZm9zZWN1cml0eS5jb20vYmxvZy9kaWdnaW5nLWludG8tbXMxNC0wNjgtZXhwbG9pdGF0aW9uLWFuZC1kZWZlbmNlLw==">Digging into MS14-068, Exploitation and Defence</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cudHJ1c3RlZHNlYy5jb20vMjAxNC8xMi9tczE0LTA2OC1mdWxsLWNvbXByb21pc2Utc3RlcC1zdGVwLw==">From MS14-068 to Full Compromise – Step by Step</span></li></ul><h3 id="dnsadmins"><a class="anchor" href="#dnsadmins">#</a> DNSAdmins</h3><ul><li><span class="exturl" data-url="aHR0cDovL3d3dy5sYWJvZmFwZW5ldHJhdGlvbnRlc3Rlci5jb20vMjAxNy8wNS9hYnVzaW5nLWRuc2FkbWlucy1wcml2aWxlZ2UtZm9yLWVzY2FsYXRpb24taW4tYWN0aXZlLWRpcmVjdG9yeS5odG1s">Abusing DNSAdmins privilege for escalation in Active Directory</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD00MDY0">From DNSAdmins to Domain Admin, When DNSAdmins is More than Just DNS Administration</span></li></ul><h3 id="kerberos-delegation"><a class="anchor" href="#kerberos-delegation">#</a> Kerberos Delegation</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9zaGVuYW5pZ2Fuc2xhYnMuaW8vbWVkaWEvQ29uc3RydWN0aW5nJTIwS2VyYmVyb3MlMjBBdHRhY2tzJTIwd2l0aCUyMERlbGVnYXRpb24lMjBQcmltaXRpdmVzLnBkZg==">Constructing Kerberos Attacks with Delegation Primitives</span></li><li><span class="exturl" data-url="aHR0cDovL2Jsb2cucmVkeG9yYmx1ZS5jb20vMjAxOS8xMi9uby1zaGVsbHMtcmVxdWlyZWQtdXNpbmctaW1wYWNrZXQtdG8uaHRtbA==">No Shells Required - a Walkthrough on Using Impacket and Kerberos to Delegate Your Way to DA</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLm5ldHNwaS5jb20vY3ZlLTIwMjAtMTcwNDkta2VyYmVyb3MtYnJvbnplLWJpdC1vdmVydmlldy8=">CVE-2020-17049: Kerberos Bronze Bit Attack – Overview</span></li></ul><h4 id="unconstrained-delegation"><a class="anchor" href="#unconstrained-delegation">#</a> Unconstrained Delegation</h4><ul><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD00MDU2">Domain Controller Print Server + Unconstrained Kerberos Delegation = Pwned Active Directory Forest</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0xNjY3">Active Directory Security Risk #101: Kerberos Unconstrained Delegation (or How Compromise of a Single Server Can Compromise the Domain)</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnN0ZWFsdGhiaXRzLmNvbS91bmNvbnN0cmFpbmVkLWRlbGVnYXRpb24tcGVybWlzc2lvbnMv">Unconstrained Delegation Permissions</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9sYWJzLm13cmluZm9zZWN1cml0eS5jb20vYmxvZy90cnVzdC15ZWFycy10by1lYXJuLXNlY29uZHMtdG8tYnJlYWsv">Trust? Years to earn, seconds to break</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9wb3N0cy5zcGVjdGVyb3BzLmlvL2h1bnRpbmctaW4tYWN0aXZlLWRpcmVjdG9yeS11bmNvbnN0cmFpbmVkLWRlbGVnYXRpb24tZm9yZXN0cy10cnVzdHMtNzFmMmIzMzY4OGUx">Hunting in Active Directory: Unconstrained Delegation &amp; Forests Trusts</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cucmljY2FyZG9hbmNhcmFuaS5pdC9leHBsb2l0aW5nLXVuY29uc3RyYWluZWQtZGVsZWdhdGlvbi8=">Exploiting Unconstrained Delegation</span></li></ul><h4 id="constrained-delegation"><a class="anchor" href="#constrained-delegation">#</a> Constrained Delegation</h4><ul><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFybWoweS5uZXQvYmxvZy9yZWR0ZWFtaW5nL2Fub3RoZXItd29yZC1vbi1kZWxlZ2F0aW9uLw==">Another Word on Delegation</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFybWoweS5uZXQvYmxvZy9yZWR0ZWFtaW5nL2Zyb20ta2VrZW8tdG8tcnViZXVzLw==">From Kekeo to Rubeus</span></li><li><span class="exturl" data-url="aHR0cDovL3d3dy5oYXJtajB5Lm5ldC9ibG9nL2FjdGl2ZWRpcmVjdG9yeS9zNHUycHduYWdlLw==">S4U2Pwnage</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2VjdXJlYXV0aC5jb20vYmxvZy9rZXJiZXJvcy1kZWxlZ2F0aW9uLXNwbnMtYW5kLW1vcmU=">Kerberos Delegation, Spns And More...</span></li></ul><h4 id="resource-based-constrained-delegation"><a class="anchor" href="#resource-based-constrained-delegation">#</a> Resource-Based Constrained Delegation</h4><ul><li><span class="exturl" data-url="aHR0cHM6Ly9zaGVuYW5pZ2Fuc2xhYnMuaW8vMjAxOS8wMS8yOC9XYWdnaW5nLXRoZS1Eb2cuaHRtbA==">Wagging the Dog: Abusing Resource-Based Constrained Delegation to Attack Active Directory</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9pcmVkLnRlYW0vb2ZmZW5zaXZlLXNlY3VyaXR5LWV4cGVyaW1lbnRzL2FjdGl2ZS1kaXJlY3Rvcnkta2VyYmVyb3MtYWJ1c2UvcmVzb3VyY2UtYmFzZWQtY29uc3RyYWluZWQtZGVsZWdhdGlvbi1hZC1jb21wdXRlci1vYmplY3QtdGFrZS1vdmVyLWFuZC1wcml2aWxnZWQtY29kZS1leGVjdXRpb24=">Kerberos Resource-based Constrained Delegation: Computer Object Take Over</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnN0ZWFsdGhiaXRzLmNvbS9yZXNvdXJjZS1iYXNlZC1jb25zdHJhaW5lZC1kZWxlZ2F0aW9uLWFidXNlLw==">Resource Based Constrained Delegation</span></li><li><span class="exturl" data-url="aHR0cDovL3d3dy5oYXJtajB5Lm5ldC9ibG9nL2FjdGl2ZWRpcmVjdG9yeS9hLWNhc2Utc3R1ZHktaW4td2FnZ2luZy10aGUtZG9nLWNvbXB1dGVyLXRha2VvdmVyLw==">A Case Study in Wagging the Dog: Computer Takeover</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1SVWJBREhjQkxLZw==">BloodHound 2.1's New Computer Takeover Attack</span></li></ul><h3 id="insecure-group-policy-object-permission-rights"><a class="anchor" href="#insecure-group-policy-object-permission-rights">#</a> Insecure Group Policy Object Permission Rights</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFybWoweS5uZXQvYmxvZy9yZWR0ZWFtaW5nL2FidXNpbmctZ3BvLXBlcm1pc3Npb25zLw==">Abusing GPO Permissions</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93YWxkMC5jb20vP3A9MTc5">A Red Teamer’s Guide to GPOs and OUs</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3Jhc3RhLW1vdXNlL0dQTy1BYnVzZQ==">File templates for GPO Abuse</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9yYXN0YW1vdXNlLm1lLzIwMTkvMDEvZ3BvLWFidXNlLXBhcnQtMS8=">GPO Abuse - Part 1</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL213cmxhYnMvU2hhcnBHUE9BYnVzZQ==">SharpGPOAbuse</span></li></ul><h3 id="insecure-acls-permission-rights"><a class="anchor" href="#insecure-acls-permission-rights">#</a> Insecure ACLs Permission Rights</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnN0ZWFsdGhiaXRzLmNvbS9leHBsb2l0aW5nLXdlYWstYWN0aXZlLWRpcmVjdG9yeS1wZXJtaXNzaW9ucy13aXRoLXBvd2Vyc3Bsb2l0Lw==">Exploiting Weak Active Directory Permissions With Powersploit</span></li><li><a target="_blank" rel="noopener" href="https://blog.fox-it.com/2018/04/26/escalating-privileges-with-acls-in-active-directory/">Escalating privileges with ACLs in Active Directory<br></a></li><li><a target="_blank" rel="noopener" href="http://www.harmj0y.net/blog/redteaming/abusing-active-directory-permissions-with-powerview/">Abusing Active Directory Permissions with PowerView<br></a></li><li><span class="exturl" data-url="aHR0cHM6Ly93YWxkMC5jb20vP3A9MTEy">BloodHound 1.3 – The ACL Attack Path Update</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0zNjU4">Scanning for Active Directory Privileges &amp; Privileged Accounts</span></li><li><span class="exturl" data-url="aHR0cHM6Ly90ZWNoY29tbXVuaXR5Lm1pY3Jvc29mdC5jb20vdDUvRW50ZXJwcmlzZS1Nb2JpbGl0eS1TZWN1cml0eS9BY3RpdmUtRGlyZWN0b3J5LUFjY2Vzcy1Db250cm9sLUxpc3QtODIxMS1BdHRhY2tzLWFuZC1EZWZlbnNlL2JhLXAvMjUwMzE1">Active Directory Access Control List – Attacks and Defense</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2xpZGVzaGFyZS5uZXQvRGlya2phbk1vbGxlbWEvYWNscHduLWFjdGl2ZS1kaXJlY3RvcnktYWNsLWV4cGxvaXRhdGlvbi13aXRoLWJsb29kaG91bmQ=">aclpwn - Active Directory ACL exploitation with BloodHound</span></li></ul><h3 id="domain-trusts"><a class="anchor" href="#domain-trusts">#</a> Domain Trusts</h3><ul><li><span class="exturl" data-url="aHR0cDovL3d3dy5oYXJtajB5Lm5ldC9ibG9nL3JlZHRlYW1pbmcvYS1ndWlkZS10by1hdHRhY2tpbmctZG9tYWluLXRydXN0cy8=">A Guide to Attacking Domain Trusts</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0xNTg4">It's All About Trust – Forging Kerberos Trust Tickets to Spoof Access across Active Directory Trusts</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kaXJramFubS5pby9hY3RpdmUtZGlyZWN0b3J5LWZvcmVzdC10cnVzdHMtcGFydC1vbmUtaG93LWRvZXMtc2lkLWZpbHRlcmluZy13b3Jr">Active Directory forest trusts part 1 - How does SID filtering work?</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9oYWNrbWFnLmNvbS9zZWN1cml0eS9hZC1mb3Jlc3Qv">The Forest Is Under Control. Taking over the entire Active Directory forest</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9wb3N0cy5zcGVjdGVyb3BzLmlvL25vdC1hLXNlY3VyaXR5LWJvdW5kYXJ5LWJyZWFraW5nLWZvcmVzdC10cnVzdHMtY2QxMjU4Mjk1MThk">Not A Security Boundary: Breaking Forest Trusts</span></li><li><span class="exturl" data-url="aHR0cDovL3d3dy5oYXJtajB5Lm5ldC9ibG9nL3JlZHRlYW1pbmcvdGhlLXRydXN0cG9jYWx5cHNlLw==">The Trustpocalypse</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuZHJvcGJveC5jb20vcy9pbHpqdGxvMHZieXUxdTAvQ2FybG9zJTIwR2FyY2lhJTIwLSUyMFJvb3RlZDIwMTklMjAtJTIwUGVudGVzdGluZyUyMEFjdGl2ZSUyMERpcmVjdG9yeSUyMEZvcmVzdHMlMjBwdWJsaWMucGRmP2RsPTA=">Pentesting Active Directory Forests</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0yODI=">Security Considerations for Active Directory (AD) Trusts</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0xNjQw">Kerberos Golden Tickets are Now More Golden</span></li></ul><h3 id="dcshadow"><a class="anchor" href="#dcshadow">#</a> DCShadow</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnN0ZWFsdGhiaXRzLmNvbS9wcml2aWxlZ2UtZXNjYWxhdGlvbi13aXRoLWRjc2hhZG93Lw==">Privilege Escalation With DCShadow</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9wZW50ZXN0bGFiLmJsb2cvMjAxOC8wNC8xNi9kY3NoYWRvdy8=">DCShadow</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmFsc2lkLmV1L2Rjc2hhZG93LWV4cGxhaW5lZC00NTEwZjUyZmMxOWQ=">DCShadow explained: A technical deep dive into the latest AD attack technique</span></li><li><span class="exturl" data-url="aHR0cDovL3d3dy5sYWJvZmFwZW5ldHJhdGlvbnRlc3Rlci5jb20vMjAxOC8wNS9kY3NoYWRvdy1zYWNsLmh0bWw=">DCShadow - Silently turn off Active Directory Auditing</span></li><li><span class="exturl" data-url="aHR0cDovL3d3dy5sYWJvZmFwZW5ldHJhdGlvbnRlc3Rlci5jb20vMjAxOC8wNC9kY3NoYWRvdy5odG1s">DCShadow - Minimal permissions, Active Directory Deception, Shadowception and more</span></li></ul><h3 id="rid"><a class="anchor" href="#rid">#</a> RID</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnN0ZWFsdGhiaXRzLmNvbS9yaWQtaGlqYWNraW5nLXdoZW4tZ3Vlc3RzLWJlY29tZS1hZG1pbnMv">Rid Hijacking: When Guests Become Admins</span></li></ul><h3 id="microsoft-sql-server"><a class="anchor" href="#microsoft-sql-server">#</a> Microsoft SQL Server</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLm5ldHNwaS5jb20vZ2V0LXNxbC1zZXJ2ZXItc3lzYWRtaW4tcHJpdmlsZWdlcy1sb2NhbC1hZG1pbi1wb3dlcnVwc3FsLw==">How to get SQL Server Sysadmin Privileges as a Local Admin with PowerUpSQL</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnN0ZWFsdGhiaXRzLmNvbS9jb21wcm9taXNlLXdpdGgtcG93ZXJ1cHNxbC1zcWwtYXR0YWNrcy8=">Compromise With Powerupsql – Sql Attacks</span></li></ul><h3 id="red-forest"><a class="anchor" href="#red-forest">#</a> Red Forest</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC5lcm53LWluc2lnaHQuZGUvdHJvb3BlcnMvdHIxOC9zbGlkZXMvVFIxOF9BRF9BdHRhY2stYW5kLURlZmVuZC1NaWNyb3NvZnQtRW5oYW5jZWQtU2VjdXJpdHkucGRm">Attack and defend Microsoft Enhanced Security Administrative</span></li></ul><h3 id="exchange"><a class="anchor" href="#exchange">#</a> Exchange</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2dkZWRyb3Vhcy9FeGNoYW5nZS1BRC1Qcml2ZXNj">Exchange-AD-Privesc</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kaXJramFubS5pby9hYnVzaW5nLWV4Y2hhbmdlLW9uZS1hcGktY2FsbC1hd2F5LWZyb20tZG9tYWluLWFkbWluLw==">Abusing Exchange: One API call away from Domain Admin</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0Fybm8weC9OdGxtUmVsYXlUb0VXUw==">NtlmRelayToEWS</span></li></ul><h3 id="llmnrnbns"><a class="anchor" href="#llmnrnbns">#</a> LLMNR/NBNS</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly93d3cubm90c29zZWN1cmUuY29tL3B3bmluZy13aXRoLXJlc3BvbmRlci1hLXBlbnRlc3RlcnMtZ3VpZGUv">Pwning with Responder – A Pentester’s Guide</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ieXQzYmwzM2Qzci5naXRodWIuaW8vcHJhY3RpY2FsLWd1aWRlLXRvLW50bG0tcmVsYXlpbmctaW4tMjAxNy1ha2EtZ2V0dGluZy1hLWZvb3Rob2xkLWluLXVuZGVyLTUtbWludXRlcy5odG1s">Practical guide to NTLM Relaying in 2017 (A.K.A getting a foothold in under 5 minutes)</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuZm94LWl0LmNvbS9lbi9pbnNpZ2h0cy9ibG9ncy9ibG9nL2luc2lkZS13aW5kb3dzLW5ldHdvcmsv">Relaying credentials everywhere with ntlmrelayx</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLm5ldHNwaS5jb20vZXhwbG9pdGluZy1hZGlkbnMv">Beyond LLMNR/NBNS Spoofing – Exploiting Active Directory-Integrated DNS</span></li></ul><hr><h2 id="lateral-movement"><a class="anchor" href="#lateral-movement">#</a> Lateral Movement</h2><h3 id="microsoft-sql-server-database-links"><a class="anchor" href="#microsoft-sql-server-database-links">#</a> Microsoft SQL Server Database links</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLm5ldHNwaS5jb20vaG93LXRvLWhhY2stZGF0YWJhc2UtbGlua3MtaW4tc3FsLXNlcnZlci8=">SQL Server – Link… Link… Link… and Shell: How to Hack Database Links in SQL Server!</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLm5ldHNwaS5jb20vc3FsLXNlcnZlci1saW5rLWNyYXdsaW5nLXBvd2VydXBzcWwv">SQL Server Link Crawling with PowerUpSQL</span></li></ul><h3 id="pass-the-hash"><a class="anchor" href="#pass-the-hash">#</a> Pass The Hash</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnN0ZWFsdGhiaXRzLmNvbS9wYXNzaW5nLXRoZS1oYXNoLXdpdGgtbWltaWthdHo=">Performing Pass-the-hash Attacks With Mimikatz</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNvYmFsdHN0cmlrZS5jb20vMjAxNS8wNS8yMS9ob3ctdG8tcGFzcy10aGUtaGFzaC13aXRoLW1pbWlrYXR6Lw==">How to Pass-the-Hash with Mimikatz</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFybWoweS5uZXQvYmxvZy9yZWR0ZWFtaW5nL3Bhc3MtdGhlLWhhc2gtaXMtZGVhZC1sb25nLWxpdmUtbG9jYWxhY2NvdW50dG9rZW5maWx0ZXJwb2xpY3kv">Pass-the-Hash Is Dead: Long Live LocalAccountTokenFilterPolicy</span></li></ul><h3 id="system-center-configuration-manager-sccm"><a class="anchor" href="#system-center-configuration-manager-sccm">#</a> System Center Configuration Manager (SCCM)</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9lbmlnbWEweDMubmV0LzIwMTUvMTAvMjcvdGFyZ2V0ZWQtd29ya3N0YXRpb24tY29tcHJvbWlzZS13aXRoLXNjY20v">Targeted Workstation Compromise With Sccm</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1Bvd2VyU2hlbGxNYWZpYS9Qb3dlclNDQ00=">PowerSCCM - PowerShell module to interact with SCCM deployments</span></li></ul><h3 id="wsus"><a class="anchor" href="#wsus">#</a> WSUS</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2l4ZHViLm5ldC8/cD02MjM=">Remote Weaponization of WSUS MITM</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmxhY2toYXQuY29tL2RvY3MvdXMtMTcvd2VkbmVzZGF5L3VzLTE3LUNvbHRlbC1XU1VTcGVuZHUtVXNlLVdTVVMtVG8tSGFuZy1JdHMtQ2xpZW50cy13cC5wZGY=">WSUSpendu</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9panVzdHdhbm5hcmVkLnRlYW0vMjAxOC8xMC8xNS9sZXZlcmFnaW5nLXdzdXMtcGFydC1vbmUv">Leveraging WSUS – Part One</span></li></ul><h3 id="password-spraying"><a class="anchor" href="#password-spraying">#</a> Password Spraying</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj14QjI2UWhuTDY0Yw==">Password Spraying Windows Active Directory Accounts - Tradecraft Security Weekly #5</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmxhY2toaWxsc2luZm9zZWMuY29tL2F0dGFja2luZy1leGNoYW5nZS13aXRoLW1haWxzbmlwZXIv">Attacking Exchange with MailSniper</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1NwaWRlckxhYnMvU3ByYXk=">A Password Spraying tool for Active Directory Credentials by Jacob Wilkin</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2J5dDNibDMzZDNyL1NwcmF5aW5nVG9vbGtpdA==">SprayingToolkit</span></li></ul><h3 id="automated-lateral-movement"><a class="anchor" href="#automated-lateral-movement">#</a> Automated Lateral Movement</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0dvRmV0Y2hBRC9Hb0ZldGNo">GoFetch is a tool to automatically exercise an attack plan generated by the BloodHound application</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2J5dDNibDMzZDNyL0RlYXRoU3Rhcg==">DeathStar - Automate getting Domain Admin using Empire</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3Z5c2VjL0FOR1JZUFVQUFk=">ANGRYPUPPY - Bloodhound Attack Path Automation in CobaltStrike</span></li></ul><hr><h2 id="defense-evasion"><a class="anchor" href="#defense-evasion">#</a> Defense Evasion</h2><h3 id="in-memory-evasion"><a class="anchor" href="#in-memory-evasion">#</a> In-Memory Evasion</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9sYWJzLm13cmluZm9zZWN1cml0eS5jb20vYmxvZy9leHBlcmltZW50aW5nLWJ5cGFzc2luZy1tZW1vcnktc2Nhbm5lcnMtd2l0aC1jb2JhbHQtc3RyaWtlLWFuZC1nYXJnb3lsZS8=">Bypassing Memory Scanners with Cobalt Strike and Gargoyle</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vcGxheWxpc3Q/bGlzdD1QTDlITzZNX01VMm5jNVEzMXFkMkN3cFo4SjRLRk1oZ25L">In-Memory Evasions Course</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuZmlyZWV5ZS5jb20vYmxvZy90aHJlYXQtcmVzZWFyY2gvMjAxOC8wNi9icmluZy15b3VyLW93bi1sYW5kLW5vdmVsLXJlZC10ZWFtaW5nLXRlY2huaXF1ZS5odG1s">Bring Your Own Land (BYOL) – A Novel Red Teaming Technique</span></li></ul><h3 id="endpoint-detection-and-response-edr-evasion"><a class="anchor" href="#endpoint-detection-and-response-edr-evasion">#</a> Endpoint Detection and Response (EDR) Evasion</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly95b3V0dS5iZS9sOG5rWENPWVFDNA==">Red Teaming in the EDR age</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0Z1enp5U2VjdXJpdHkvU2hhcnAtU3VpdGU=">Sharp-Suite - Process Argument Spoofing</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9vdXRmbGFuay5ubC9ibG9nLzIwMTkvMDYvMTkvcmVkLXRlYW0tdGFjdGljcy1jb21iaW5pbmctZGlyZWN0LXN5c3RlbS1jYWxscy1hbmQtc3JkaS10by1ieXBhc3MtYXYtZWRyLw==">Red Team Tactics: Combining Direct System Calls and sRDI to bypass AV/EDR</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY291bnRlcmNlcHQuY29tL2Jsb2cvZGVjaGFpbmluZy1tYWNyb3MtYW5kLWV2YWRpbmctZWRyLw==">Dechaining Macros and Evading EDR</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9tZWRpdW0uY29tL0Bmc3gzMC9ieXBhc3MtZWRycy1tZW1vcnktcHJvdGVjdGlvbi1pbnRyb2R1Y3Rpb24tdG8taG9va2luZy0yZWZiMjFhY2ZmZDY=">Bypass EDR’s memory protection, introduction to hooking</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9pcmVkLnRlYW0vb2ZmZW5zaXZlLXNlY3VyaXR5L2RlZmVuc2UtZXZhc2lvbi9ieXBhc3NpbmctY3lsYW5jZS1hbmQtb3RoZXItYXZzLWVkcnMtYnktdW5ob29raW5nLXdpbmRvd3MtYXBpcw==">Bypassing Cylance and other AVs/EDRs by Unhooking Windows APIs</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cubWRzZWMuY28udWsvMjAxOS8wMy9zaWxlbmNpbmctY3lsYW5jZS1hLWNhc2Utc3R1ZHktaW4tbW9kZXJuLWVkcnMv">Silencing Cylance: A Case Study in Modern EDRs</span></li></ul><h3 id="opsec"><a class="anchor" href="#opsec">#</a> OPSEC</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNvYmFsdHN0cmlrZS5jb20vMjAxNy8xMC8yNS9tb2Rlcm4tZGVmZW5zZXMtYW5kLXlvdS8=">Modern Defenses and YOU!</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNvYmFsdHN0cmlrZS5jb20vMjAxNy8wNi8yMy9vcHNlYy1jb25zaWRlcmF0aW9ucy1mb3ItYmVhY29uLWNvbW1hbmRzLw==">OPSEC Considerations for Beacon Commands</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9zZWM1NjQuY29tLyMhZG9jcy90cmFkZWNyYWZ0Lm1k">Red Team Tradecraft and TTP Guidance</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1Sb3FWdW5YX3NxQQ==">Fighting the Toolset</span></li></ul><h3 id="microsoft-ata-atp-evasion"><a class="anchor" href="#microsoft-ata-atp-evasion">#</a> Microsoft ATA &amp; ATP Evasion</h3><ul><li><a target="_blank" rel="noopener" href="https://www.blackhat.com/docs/eu-17/materials/eu-17-Thompson-Red-Team-Techniques-For-Evading-Bypassing-And-Disabling-MS-Advanced-Threat-Protection-And-Advanced-Threat-Analytics.pdf">Red Team Techniques for Evading, Bypassing, and Disabling MS<br>Advanced Threat Protection and Advanced Threat Analytics</a></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2xpZGVzaGFyZS5uZXQvbmlraGlsX21pdHRhbC9yZWQtdGVhbS1yZXZlbmdlLWF0dGFja2luZy1taWNyb3NvZnQtYXRh">Red Team Revenge - Attacking Microsoft ATA</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2xpZGVzaGFyZS5uZXQvbmlraGlsX21pdHRhbC9ldmFkaW5nLW1pY3Jvc29mdC1hdGEtZm9yLWFjdGl2ZS1kaXJlY3RvcnktZG9taW5hdGlvbg==">Evading Microsoft ATA for Active Directory Domination</span></li></ul><h3 id="powershell-scriptblock-logging-bypass"><a class="anchor" href="#powershell-scriptblock-logging-bypass">#</a> PowerShell ScriptBlock Logging Bypass</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9jb2Jici5pby9TY3JpcHRCbG9jay1Mb2dnaW5nLUJ5cGFzcy5odG1s">PowerShell ScriptBlock Logging Bypass</span></li></ul><h3 id="powershell-anti-malware-scan-interface-amsi-bypass"><a class="anchor" href="#powershell-anti-malware-scan-interface-amsi-bypass">#</a> PowerShell Anti-Malware Scan Interface (AMSI) Bypass</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly8weDAwLTB4MDAuZ2l0aHViLmlvL3Jlc2VhcmNoLzIwMTgvMTAvMjgvSG93LXRvLWJ5cGFzcy1BTVNJLWFuZC1FeGVjdXRlLUFOWS1tYWxpY2lvdXMtcG93ZXJzaGVsbC1jb2RlLmh0bWw=">How to bypass AMSI and execute ANY malicious Powershell code</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmxhY2toYXQuY29tL2RvY3MvdXMtMTYvbWF0ZXJpYWxzL3VzLTE2LU1pdHRhbC1BTVNJLUhvdy1XaW5kb3dzLTEwLVBsYW5zLVRvLVN0b3AtU2NyaXB0LUJhc2VkLUF0dGFja3MtQW5kLUhvdy1XZWxsLUl0LURvZXMtSXQucGRm">AMSI: How Windows 10 Plans to Stop Script-Based Attacks</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY3liZXJhcmsuY29tL3RocmVhdC1yZXNlYXJjaC1ibG9nL2Ftc2ktYnlwYXNzLXBhdGNoaW5nLXRlY2huaXF1ZS8=">AMSI Bypass: Patching Technique</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL09tZXJZYS9JbnZpc2ktU2hlbGw=">Invisi-Shell - Hide your Powershell script in plain sight. Bypass all Powershell security features</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9zZWN1cmV5b3VyaXQuY28udWsvd3AvMjAxOS8wNS8xMC9keW5hbWljLW1pY3Jvc29mdC1vZmZpY2UtMzY1LWFtc2ktaW4tbWVtb3J5LWJ5cGFzcy11c2luZy12YmEv">Dynamic Microsoft Office 365 AMSI In Memory Bypass Using VBA</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9yYXN0YW1vdXNlLm1lLzIwMTgvMTAvYW1zaXNjYW5idWZmZXItYnlwYXNzLS0tcGFydC0xLw==">AmsiScanBuffer Bypass - Part 1</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY29udGV4dGlzLmNvbS9lbi9ibG9nL2Ftc2ktYnlwYXNz">AMSI Bypass</span></li></ul><h3 id="loading-net-assemblies-anti-malware-scan-interface-amsi-bypass"><a class="anchor" href="#loading-net-assemblies-anti-malware-scan-interface-amsi-bypass">#</a> Loading .NET Assemblies Anti-Malware Scan Interface (AMSI) Bypass</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vbWF0dGlmZXN0YXRpb24vZWYwMTMyYmE0YWUzY2MxMzY5MTRkYTMyYTg4MTA2Yjk=">A PoC function to corrupt the g_amsiContext global variable in clr.dll in .NET Framework Early Access build 3694</span></li></ul><h3 id="applocker-device-guard-bypass"><a class="anchor" href="#applocker-device-guard-bypass">#</a> AppLocker &amp; Device Guard Bypass</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9sb2xiYXMtcHJvamVjdC5naXRodWIuaW8v">Living Off The Land Binaries And Scripts - (LOLBins and LOLScripts)</span></li></ul><h3 id="sysmon-evasion"><a class="anchor" href="#sysmon-evasion">#</a> Sysmon Evasion</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21hdHRpZmVzdGF0aW9uL0JIVVNBMjAxOF9TeXNtb24=">Subverting Sysmon: Application of a Formalized Security Product Evasion Methodology</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21rb3JtYW45MC9zeXNtb24tY29uZmlnLWJ5cGFzcy1maW5kZXI=">sysmon-config-bypass-finder</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9wb3N0cy5zcGVjdGVyb3BzLmlvL3NoaG1vbi1zaWxlbmNpbmctc3lzbW9uLXZpYS1kcml2ZXItdW5sb2FkLTY4MmI1YmU1NzY1MA==">Shhmon — Silencing Sysmon via Driver Unload</span></li></ul><h3 id="honeytokens-evasion"><a class="anchor" href="#honeytokens-evasion">#</a> HoneyTokens Evasion</h3><ul><li><span class="exturl" data-url="aHR0cDovL3d3dy5sYWJvZmFwZW5ldHJhdGlvbnRlc3Rlci5jb20vMjAxOC8xMC9kZXBsb3ktZGVjZXB0aW9uLmh0bWw=">Forging Trusts for Deception in Active Directory</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9qYmxvZy5qYXZlbGluLW5ldHdvcmtzLmNvbS9ibG9nL3RoZS1ob25leXBvdC1idXN0ZXIv">Honeypot Buster: A Unique Red-Team Tool</span></li></ul><h3 id="disabling-security-tools"><a class="anchor" href="#disabling-security-tools">#</a> Disabling Security Tools</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2hsbGR6L0ludm9rZS1QaGFudDBt">Invoke-Phant0m - Windows Event Log Killer</span></li></ul><hr><h2 id="credential-dumping"><a class="anchor" href="#credential-dumping">#</a> Credential Dumping</h2><h3 id="ntdsdit-password-extraction"><a class="anchor" href="#ntdsdit-password-extraction">#</a> NTDS.DIT Password Extraction</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD00NTE=">How Attackers Pull the Active Directory Database (NTDS.dit) from a Domain Controller</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnN0ZWFsdGhiaXRzLmNvbS9leHRyYWN0aW5nLXBhc3N3b3JkLWhhc2hlcy1mcm9tLXRoZS1udGRzLWRpdC1maWxlLw==">Extracting Password Hashes From The Ntds.dit File</span></li></ul><h3 id="sam-security-accounts-manager"><a class="anchor" href="#sam-security-accounts-manager">#</a> SAM (Security Accounts Manager)</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2VsYWRzaGFtaXIvSW50ZXJuYWwtTW9ub2xvZ3Vl">Internal Monologue Attack: Retrieving NTLM Hashes without Touching LSASS</span></li></ul><h3 id="kerberoasting"><a class="anchor" href="#kerberoasting">#</a> Kerberoasting</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFybWoweS5uZXQvYmxvZy9wb3dlcnNoZWxsL2tlcmJlcm9hc3Rpbmctd2l0aG91dC1taW1pa2F0ei8=">Kerberoasting Without Mimikatz</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0yMjkz">Cracking Kerberos TGS Tickets Using Kerberoast – Exploiting Kerberos to Compromise the Active Directory Domain</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnN0ZWFsdGhiaXRzLmNvbS9leHRyYWN0aW5nLXNlcnZpY2UtYWNjb3VudC1wYXNzd29yZHMtd2l0aC1rZXJiZXJvYXN0aW5nLw==">Extracting Service Account Passwords With Kerberoasting</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY3liZXJhcmsuY29tL2Jsb2cvY3JhY2tpbmctc2VydmljZS1hY2NvdW50LXBhc3N3b3Jkcy1rZXJiZXJvYXN0aW5nLw==">Cracking Service Account Passwords with Kerberoasting</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vZWRlcm1pL2Y4YjE0M2IxMWRjMDIwYjg1NDE3OGQzODA5Y2Y5MWI1">Kerberoast PW list for cracking passwords with complexity requirements</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2xpZGVzaGFyZS5uZXQvaGFybWoweS9kZXJieWNvbi0yMDE5LWtlcmJlcm9hc3RpbmctcmV2aXNpdGVk">DerbyCon 2019 - Kerberoasting Revisited</span></li></ul><h3 id="kerberos-ap-rep-roasting"><a class="anchor" href="#kerberos-ap-rep-roasting">#</a> Kerberos AP-REP Roasting</h3><ul><li><span class="exturl" data-url="aHR0cDovL3d3dy5oYXJtajB5Lm5ldC9ibG9nL2FjdGl2ZWRpcmVjdG9yeS9yb2FzdGluZy1hcy1yZXBzLw==">Roasting AS-REPs</span></li></ul><h3 id="windows-credential-managervault"><a class="anchor" href="#windows-credential-managervault">#</a> Windows Credential Manager/Vault</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFybWoweS5uZXQvYmxvZy9yZWR0ZWFtaW5nL29wZXJhdGlvbmFsLWd1aWRhbmNlLWZvci1vZmZlbnNpdmUtdXNlci1kcGFwaS1hYnVzZS8=">Operational Guidance for Offensive User DPAPI Abuse</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9yYXN0YW1vdXNlLm1lLzIwMTcvMDgvanVtcGluZy1uZXR3b3JrLXNlZ3JlZ2F0aW9uLXdpdGgtcmRwLw==">Jumping Network Segregation with RDP</span></li></ul><h3 id="dcsync"><a class="anchor" href="#dcsync">#</a> DCSync</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFybWoweS5uZXQvYmxvZy9yZWR0ZWFtaW5nL21pbWlrYXR6LWFuZC1kY3N5bmMtYW5kLWV4dHJhc2lkcy1vaC1teS8=">Mimikatz and DCSync and ExtraSids, Oh My</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0xNzI5">Mimikatz DCSync Usage, Exploitation, and Detection</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0yMDUz">Dump Clear-Text Passwords for All Admins in the Domain Using Mimikatz DCSync</span></li></ul><h3 id="llmnrnbt-ns-poisoning"><a class="anchor" href="#llmnrnbt-ns-poisoning">#</a> LLMNR/NBT-NS Poisoning</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuNGFybWVkLmNvbS9ibG9nL2xsbW5yLW5idG5zLXBvaXNvbmluZy11c2luZy1yZXNwb25kZXIv">LLMNR/NBT-NS Poisoning Using Responder</span></li></ul><h3 id="others"><a class="anchor" href="#others">#</a> Others</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnN0ZWFsdGhiaXRzLmNvbS9jb21wcm9taXNpbmctcGxhaW4tdGV4dC1wYXNzd29yZHMtaW4tYWN0aXZlLWRpcmVjdG9yeQ==">Compromising Plain Text Passwords In Active Directory</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuZmlyZWV5ZS5jb20vYmxvZy90aHJlYXQtcmVzZWFyY2gvMjAyMC8wNC9rZXJiZXJvcy10aWNrZXRzLW9uLWxpbnV4LXJlZC10ZWFtcy5odG1s">Kerberos Tickets on Linux Red Teams</span></li></ul><hr><h2 id="persistence"><a class="anchor" href="#persistence">#</a> Persistence</h2><h3 id="golden-ticket"><a class="anchor" href="#golden-ticket">#</a> Golden Ticket</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9wZW50ZXN0bGFiLmJsb2cvMjAxOC8wNC8wOS9nb2xkZW4tdGlja2V0Lw==">Golden Ticket</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0xNjQw">Kerberos Golden Tickets are Now More Golden</span></li></ul><h3 id="sid-history"><a class="anchor" href="#sid-history">#</a> SID History</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0xNzcy">Sneaky Active Directory Persistence #14: SID History</span></li></ul><h3 id="silver-ticket"><a class="anchor" href="#silver-ticket">#</a> Silver Ticket</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0yMDEx">How Attackers Use Kerberos Silver Tickets to Exploit Systems</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0yNzUz">Sneaky Active Directory Persistence #16: Computer Accounts &amp; Domain Controller Silver Tickets</span></li></ul><h3 id="dcshadow-2"><a class="anchor" href="#dcshadow-2">#</a> DCShadow</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnN0ZWFsdGhiaXRzLmNvbS9jcmVhdGluZy1wZXJzaXN0ZW5jZS13aXRoLWRjc2hhZG93Lw==">Creating Persistence With Dcshadow</span></li></ul><h3 id="adminsdholder"><a class="anchor" href="#adminsdholder">#</a> AdminSDHolder</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0xOTA2">Sneaky Active Directory Persistence #15: Leverage AdminSDHolder &amp; SDProp to (Re)Gain Domain Admin Rights</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnN0ZWFsdGhiaXRzLmNvbS9wZXJzaXN0ZW5jZS11c2luZy1hZG1pbnNkaG9sZGVyLWFuZC1zZHByb3Av">Persistence Using Adminsdholder And Sdprop</span></li></ul><h3 id="group-policy-object"><a class="anchor" href="#group-policy-object">#</a> Group Policy Object</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0yNzE2">Sneaky Active Directory Persistence #17: Group Policy</span></li></ul><h3 id="skeleton-keys"><a class="anchor" href="#skeleton-keys">#</a> Skeleton Keys</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnN0ZWFsdGhiaXRzLmNvbS91bmxvY2tpbmctYWxsLXRoZS1kb29ycy10by1hY3RpdmUtZGlyZWN0b3J5LXdpdGgtdGhlLXNrZWxldG9uLWtleS1hdHRhY2sv">Unlocking All The Doors To Active Directory With The Skeleton Key Attack</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9wZW50ZXN0bGFiLmJsb2cvMjAxOC8wNC8xMC9za2VsZXRvbi1rZXkv">Skeleton Key</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0xMjc1">Attackers Can Now Use Mimikatz to Implant Skeleton Key on Domain Controllers &amp; BackDoor Your Active Directory Forest</span></li></ul><h3 id="seenabledelegationprivilege"><a class="anchor" href="#seenabledelegationprivilege">#</a> SeEnableDelegationPrivilege</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFybWoweS5uZXQvYmxvZy9hY3RpdmVkaXJlY3RvcnkvdGhlLW1vc3QtZGFuZ2Vyb3VzLXVzZXItcmlnaHQteW91LXByb2JhYmx5LWhhdmUtbmV2ZXItaGVhcmQtb2Yv">The Most Dangerous User Right You (Probably) Have Never Heard Of</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1PaXFhTzlSSHNrVQ==">SeEnableDelegationPrivilege Active Directory Backdoor</span></li></ul><h3 id="security-support-provider"><a class="anchor" href="#security-support-provider">#</a> Security Support Provider</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0xNzYw">Sneaky Active Directory Persistence #12: Malicious Security Support Provider (SSP)</span></li></ul><h3 id="directory-services-restore-mode"><a class="anchor" href="#directory-services-restore-mode">#</a> Directory Services Restore Mode</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0xNzE0">Sneaky Active Directory Persistence #11: Directory Service Restore Mode (DSRM)</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0xNzg1">Sneaky Active Directory Persistence #13: DSRM Persistence v2</span></li></ul><h3 id="acls-security-descriptors"><a class="anchor" href="#acls-security-descriptors">#</a> ACLs &amp; Security Descriptors</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmxhY2toYXQuY29tL2RvY3MvdXMtMTcvd2VkbmVzZGF5L3VzLTE3LVJvYmJpbnMtQW4tQUNFLVVwLVRoZS1TbGVldmUtRGVzaWduaW5nLUFjdGl2ZS1EaXJlY3RvcnktREFDTC1CYWNrZG9vcnMtd3AucGRm">An ACE Up the Sleeve: Designing Active Directory DACL Backdoors</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY3liZXJhcmsuY29tL3RocmVhdC1yZXNlYXJjaC1ibG9nL3NoYWRvdy1hZG1pbnMtc3RlYWx0aHktYWNjb3VudHMtZmVhci8=">Shadow Admins – The Stealthy Accounts That You Should Fear The Most</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2xpZGVzaGFyZS5uZXQvaGFybWoweS90aGUtdW5pbnRlbmRlZC1yaXNrcy1vZi10cnVzdGluZy1hY3RpdmUtZGlyZWN0b3J5">The Unintended Risks of Trusting Active Directory</span></li></ul><h2 id="tools-scripts"><a class="anchor" href="#tools-scripts">#</a> Tools &amp; Scripts</h2><ul><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1Bvd2VyU2hlbGxNYWZpYS9Qb3dlclNwbG9pdC9ibG9iL21hc3Rlci9SZWNvbi9Qb3dlclZpZXcucHMx">PowerView</span> - Situational Awareness PowerShell framework</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0Jsb29kSG91bmRBRC9CbG9vZEhvdW5k">BloodHound</span> - Six Degrees of Domain Admin</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1NlY3VyZUF1dGhDb3JwL2ltcGFja2V0">Impacket</span> - Impacket is a collection of Python classes for working with network protocols</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZveC1pdC9hY2xwd24ucHk=">aclpwn.py</span> - Active Directory ACL exploitation with BloodHound</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2J5dDNibDMzZDNyL0NyYWNrTWFwRXhlYw==">CrackMapExec</span> - A swiss army knife for pentesting networks</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Nhbml4MS9BREFDTFNjYW5uZXI=">ADACLScanner</span> - A tool with GUI or command linte used to create reports of access control lists (DACLs) and system access control lists (SACLs) in Active Directory</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2N5YmVyYXJrL3pCYW5n">zBang</span> - zBang is a risk assessment tool that detects potential privileged account threats</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0dob3N0UGFjay9TYWZldHlLYXR6">SafetyKatz</span> - SafetyKatz is a combination of slightly modified version of @gentilkiwi's Mimikatz project and @subTee's .NET PE Loader.</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0dob3N0UGFjay9TaGFycER1bXA=">SharpDump</span> - SharpDump is a C# port of PowerSploit's Out-Minidump.ps1 functionality.</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL05ldFNQSS9Qb3dlclVwU1FM">PowerUpSQL</span> - A PowerShell Toolkit for Attacking SQL Server</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0dob3N0UGFjay9SdWJldXM=">Rubeus</span> - Rubeus is a C# toolset for raw Kerberos interaction and abuses</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NlbnNlLW9mLXNlY3VyaXR5L0FEUmVjb24=">ADRecon</span> - A tool which gathers information about the Active Directory and generates a report which can provide a holistic picture of the current state of the target AD environment</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2dlbnRpbGtpd2kvbWltaWthdHo=">Mimikatz</span> - Utility to extract plaintexts passwords, hash, PIN code and kerberos tickets from memory but also perform pass-the-hash, pass-the-ticket or build Golden tickets</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2wwc3MvR3JvdXBlcg==">Grouper</span> - A PowerShell script for helping to find vulnerable settings in AD Group Policy.</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0tldmluLVJvYmVydHNvbi9Qb3dlcm1hZA==">Powermad</span> - PowerShell MachineAccountQuota and DNS exploit tools</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NhbXJhdGFzaG9rL1JBQ0U=">RACE</span> - RACE is a PowerShell module for executing ACL attacks against Windows targets.</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21kYXZpczMzMi9Eb21haW5QYXNzd29yZFNwcmF5">DomainPasswordSpray</span> - DomainPasswordSpray is a tool written in PowerShell to perform a password spray attack against users of a domain.</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2RhZnRoYWNrL01haWxTbmlwZXI=">MailSniper</span> - MailSniper is a penetration testing tool for searching through email in a Microsoft Exchange environment for specific terms (passwords, insider intel, network architecture information, etc.)</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xlb2xvb2JlZWsvTEFQU1Rvb2xraXQ=">LAPSToolkit</span> - Tool to audit and attack LAPS environments.</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0NyZWREZWZlbnNlL0NyZWREZWZlbnNl">CredDefense</span> - Credential and Red Teaming Defense for Windows Environments</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2RpcmtqYW5tL2xkYXBkb21haW5kdW1w">ldapdomaindump</span> - Active Directory information dumper via LDAP</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xlZWNocmlzdGVuc2VuL1Nwb29sU2FtcGxlLw==">SpoolSample</span> - PoC tool to coerce Windows hosts authenticate to other machines via the MS-RPRN RPC interface</li></ul><h2 id="ebooks"><a class="anchor" href="#ebooks">#</a> Ebooks</h2><ul><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuZXJudy5kZS9kb3dubG9hZC9CbG9vZEhvdW5kV29ya3Nob3AvRVJOV19Eb2dXaGlzcGVyZXJIYW5kYm9vay5wZGY=">The Dog Whisperer’s Handbook – A Hacker’s Guide to the BloodHound Galaxy</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cudmFyb25pcy5jb20vYmxvZy92YXJvbmlzLWVib29rLXBlbi10ZXN0aW5nLWFjdGl2ZS1kaXJlY3RvcnktZW52aXJvbm1lbnRzLw==">Varonis eBook: Pen Testing Active Directory Environments</span></li></ul><h2 id="cheat-sheets"><a class="anchor" href="#cheat-sheets">#</a> Cheat Sheets</h2><ul><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0hhcm1KMHkvQ2hlYXRTaGVldHM=">Tools Cheat Sheets</span> - Tools (PowerView, PowerUp, Empire, and PowerSploit)</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1NhZFByb2Nlc3Nvci9DaGVhdHMvYmxvYi9tYXN0ZXIvRG9nV2hpc3BlcmVyVjIubWQ=">DogWhisperer - BloodHound Cypher Cheat Sheet (v2)</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vSGFybUoweS8xODRmOTgyMmIxOTVjNTJkZDUwYzM3OWVkMzExNzk5Mw==">PowerView-3.0 tips and tricks</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vSGFybUoweS8zMzI4ZDk1NDYwN2Q3MTM2MmUzYw==">PowerView-2.0 tips and tricks</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1Njb3ViaS9CbG9vZGhvdW5kQUQtUXVlcmllcw==">BloodhoundAD-Queries</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vVGFybG9naWNTZWN1cml0eS8yZjIyMTkyNGZlZjhjMTRhMWQ4ZTI5ZjNjYjVjNWM0YQ==">Kerberos Attacks Cheat Sheet</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9oYXVzZWMuY29tLzIwMTkvMDkvMDkvYmxvb2Rob3VuZC1jeXBoZXItY2hlYXRzaGVldC8=">Bloodhound Cypher Cheatsheet</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20va25ldGh0ZW8vMmZjOGFmNmVhMjgxOTlmZDYzYTUyOWE3M2E0MTc2Yzc=">Kerberos cheatsheet</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ludGVncmF0aW9uLUlUL0FjdGl2ZS1EaXJlY3RvcnktRXhwbG9pdGF0aW9uLUNoZWF0LVNoZWV0">Active Directory Exploitation Cheat Sheet</span></li></ul><h2 id="other-resources"><a class="anchor" href="#other-resources">#</a> Other Resources</h2><ul><li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vcHJlc2VudGF0aW9uL2QvMWoyblcwNUgtaVJ6Ny1GVlRSaC1MQlhRbTZNNllJQlFOV2E0Vjd0cDk5WVEv">Tactics, Techniques and Procedures for Attacking Active Directory BlackHat Asia 2019</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cucGVudGVzdHBhcnRuZXJzLmNvbS9zZWN1cml0eS1ibG9nL2Jsb29kaG91bmQtd2Fsa3Rocm91Z2gtYS10b29sLWZvci1tYW55LXRyYWRlY3JhZnRzLw==">Bloodhound walkthrough. A Tool for Many Tradecrafts</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0yMzYy">Attack Methods for Gaining Domain Admin Rights in Active Directory</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2xpZGVzaGFyZS5uZXQvbmV0dGl0dWRlX2xhYnMvcG93ZXJzaGVsbGlzZGVhZGVwaWNsZWFybmluZ3Nsb25kb24=">PowerShell Is Dead Epic Learnings</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vcHJlc2VudGF0aW9uL2QvMWxRSFRxWFpJRHh3YUlVblhkTy1FZHZHcDc5UnpIMXJiTTR6RTQ1S2tpMkkvZWRpdCNzbGlkZT1pZC5nMzVmMzkxMTkyXzAw">Finding Our Path: How We’re Trying to Improve Active Directory Security</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1KY0ZkTkFsZUlrNCZhbXA7ZmVhdHVyZT15b3V0dS5iZQ==">SteelCon 2019: Getting Splunky With Kerberos - Ross Bingham and Tom MacDonald</span></li></ul><hr><h2 id="defense-detection"><a class="anchor" href="#defense-detection">#</a> Defense &amp; Detection</h2><h3 id="tools-scripts-2"><a class="anchor" href="#tools-scripts-2">#</a> Tools &amp; Scripts</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9nb2ZpbGUuaW8vZC9JQUtETG4=">Invoke-TrimarcADChecks</span> - The Invoke-TrimarcADChecks.ps1 PowerShell script is designed to gather data from a single domain AD forest to performed Active Directory Security Assessment (ADSA).</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2RhdmlkcHJvd2UvQURfU2VjX1Rvb2xz">Create-Tiers in AD</span> - Project Title Active Directory Auto Deployment of Tiers in any environment</li><li><span class="exturl" data-url="aHR0cHM6Ly9nYWxsZXJ5LnRlY2huZXQubWljcm9zb2Z0LmNvbS9TQU1SaTEwLUhhcmRlbmluZy1SZW1vdGUtNDhkOTRiNWI=">SAMRi10</span> - Hardening SAM Remote Access in Windows 10/Server 2016</li><li><span class="exturl" data-url="aHR0cHM6Ly9nYWxsZXJ5LnRlY2huZXQubWljcm9zb2Z0LmNvbS9OZXQtQ2Vhc2UtQmxvY2tpbmctTmV0LTFlOGRjYjVi">Net Cease</span> - Hardening Net Session Enumeration</li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cucGluZ2Nhc3RsZS5jb20v">PingCastle</span> - A tool designed to assess quickly the Active Directory security level with a methodology based on risk assessment and a maturity framework</li><li><span class="exturl" data-url="aHR0cHM6Ly9nYWxsZXJ5LnRlY2huZXQubWljcm9zb2Z0LmNvbS9Bb3JhdG8tU2tlbGV0b24tS2V5LTI0ZTQ2Yjcz">Aorato Skeleton Key Malware Remote DC Scanner</span> - Remotely scans for the existence of the Skeleton Key Malware</li><li><span class="exturl" data-url="aHR0cHM6Ly9nYWxsZXJ5LnRlY2huZXQubWljcm9zb2Z0LmNvbS9SZXNldC10aGUta3JidGd0LWFjY291bnQtNTgxYTllNTE=">Reset the krbtgt account password/keys</span> - This script will enable you to reset the krbtgt account password and related keys while minimizing the likelihood of Kerberos authentication issues being caused by the operation</li><li><span class="exturl" data-url="aHR0cHM6Ly9nYWxsZXJ5LnRlY2huZXQubWljcm9zb2Z0LmNvbS9SZXNldC1UaGUtS3JiVGd0LUFjY291bnQtNWY0NWE0MTQ=">Reset The KrbTgt Account Password/Keys For RWDCs/RODCs</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2N5YmVyYXJrL1Jpc2t5U1BO">RiskySPN</span> - RiskySPNs is a collection of PowerShell scripts focused on detecting and abusing accounts associated with SPNs (Service Principal Name).</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NhbXJhdGFzaG9rL0RlcGxveS1EZWNlcHRpb24=">Deploy-Deception</span> - A PowerShell module to deploy active directory decoy objects</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3ZsZXRvdXgvU3Bvb2xlclNjYW5uZXI=">SpoolerScanner</span> - Check if MS-RPRN is remotely available with powershell/c#</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NlY3VyZXdvcmtzL2RjZXB0">dcept</span> - A tool for deploying and detecting use of Active Directory honeytokens</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0pQQ0VSVENDL0xvZ29uVHJhY2Vy">LogonTracer</span> - Investigate malicious Windows logon by visualizing and analyzing Windows event log</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NoZWxsc3Rlci9EQ1NZTkNNb25pdG9y">DCSYNCMonitor</span> - Monitors for DCSYNC and DCSHADOW attacks and create custom Windows Events for these events</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL05lbzIzeDAvc2lnbWEv">Sigma</span> - Generic Signature Format for SIEM Systems</li><li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm1pY3Jvc29mdC5jb20vZW4tdXMvc3lzaW50ZXJuYWxzL2Rvd25sb2Fkcy9zeXNtb24=">Sysmon</span> - System Monitor (Sysmon) is a Windows system service and device driver that, once installed on a system, remains resident across system reboots to monitor and log system activity to the Windows event log.</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0pQQ0VSVENDL1N5c21vblNlYXJjaA==">SysmonSearch</span> - Investigate suspicious activity by visualizing Sysmon's event log</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2VuZGdhbWVpbmMvQ2xyR3VhcmQ=">ClrGuard</span> - ClrGuard is a proof of concept project to explore instrumenting the Common Language Runtime (CLR) for security purposes.</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vZGV6aHViLzI4NzVmYTZkYzc4MDgzY2VkZWFiMTBhYmM1NTFjYjU4">Get-ClrReflection</span> - Detects memory-only CLR (.NET) modules.</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vamFyZWRjYXRraW5zb24vMjM5MDVkMzQ1MzdjZTRiNWIxODE4YzNlNjQwNWMxZDI=">Get-InjectedThread</span> - Get-InjectedThread looks at each running thread to determine if it is the result of memory injection.</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZpcmVleWUvU2lsa0VUVw==">SilkETW</span> - SilkETW &amp; SilkService are flexible C# wrappers for ETW, they are meant to abstract away the complexities of ETW and give people a simple interface to perform research and introspection.</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tLzBLZWUtVGVhbS9XYXRjaEFE">WatchAD</span> - AD Security Intrusion Detection System</li></ul><h3 id="sysmon-configuration"><a class="anchor" href="#sysmon-configuration">#</a> Sysmon Configuration</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL29sYWZoYXJ0b25nL3N5c21vbi1tb2R1bGFy">sysmon-modular</span> - A Sysmon configuration repository for everybody to customise</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL01IYWdnaXMvc3lzbW9uLWRmaXI=">sysmon-dfir</span> - Sources, configuration and how to detect evil things utilizing Microsoft Sysmon.</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1N3aWZ0T25TZWN1cml0eS9zeXNtb24tY29uZmln">sysmon-config</span> - Sysmon configuration file template with default high-quality event tracing</li></ul><h3 id="active-directory-security-checks-by-sean-metcalf-pyrotek3"><a class="anchor" href="#active-directory-security-checks-by-sean-metcalf-pyrotek3">#</a> Active Directory Security Checks (by Sean Metcalf - @Pyrotek3)</h3><h4 id="general-recommendations"><a class="anchor" href="#general-recommendations">#</a> General Recommendations</h4><ul><li>Manage local Administrator passwords (LAPS).</li><li>Implement RDP Restricted Admin mode (as needed).</li><li>Remove unsupported OSs from the network.</li><li>Monitor scheduled tasks on sensitive systems (DCs, etc.).</li><li>Ensure that OOB management passwords (DSRM) are changed regularly &amp; securely stored.</li><li>Use SMB v2/v3+</li><li>Default domain Administrator &amp; KRBTGT password should be changed every year &amp; when an AD admin leaves.</li><li>Remove trusts that are no longer necessary &amp; enable SID filtering as appropriate.</li><li>All domain authentications should be set (when possible) to: &quot;Send NTLMv2 response onlyrefuse LM &amp; NTLM.&quot;</li><li>Block internet access for DCs, servers, &amp; all administration systems.</li></ul><h4 id="protect-admin-credentials"><a class="anchor" href="#protect-admin-credentials">#</a> Protect Admin Credentials</h4><ul><li>No &quot;user&quot; or computer accounts in admin groups.</li><li>Ensure all admin accounts are &quot;sensitive &amp; cannot be delegated&quot;.</li><li>Add admin accounts to &quot;Protected Users&quot; group (requires Windows Server 2012 R2 Domain Controllers, 2012R2 DFL for domain protection).</li><li>Disable all inactive admin accounts and remove from privileged groups.</li></ul><h4 id="protect-ad-admin-credentials"><a class="anchor" href="#protect-ad-admin-credentials">#</a> Protect AD Admin Credentials</h4><ul><li>Limit AD admin membership (DA, EA, Schema Admins, etc.) &amp; only use custom delegation groups.</li><li>‘Tiered’ Administration mitigating credential theft impact.</li><li>Ensure admins only logon to approved admin workstations &amp; servers.</li><li>Leverage time-based, temporary group membership for all admin accounts</li></ul><h4 id="protect-service-account-credentials"><a class="anchor" href="#protect-service-account-credentials">#</a> Protect Service Account Credentials</h4><ul><li>Limit to systems of the same security level.</li><li>Leverage “(Group) Managed Service Accounts” (or PW &gt;20 characters) to mitigate credential theft (kerberoast).</li><li>Implement FGPP (DFL =&gt;2008) to increase PW requirements for SAs and administrators.</li><li>Logon restrictions – prevent interactive logon &amp; limit logon capability to specific computers.</li><li>Disable inactive SAs &amp; remove from privileged groups.</li></ul><h4 id="protect-resources"><a class="anchor" href="#protect-resources">#</a> Protect Resources</h4><ul><li>Segment network to protect admin &amp; critical systems.</li><li>Deploy IDS to monitor the internal corporate network.</li><li>Network device &amp; OOB management on separate network.</li></ul><h4 id="protect-domain-controllers"><a class="anchor" href="#protect-domain-controllers">#</a> Protect Domain Controllers</h4><ul><li>Only run software &amp; services to support AD.</li><li>Minimal groups (&amp; users) with DC admin/logon rights.</li><li>Ensure patches are applied before running DCPromo (especially MS14-068 and other critical patches).</li><li>Validate scheduled tasks &amp; scripts.</li></ul><h4 id="protect-workstations-servers"><a class="anchor" href="#protect-workstations-servers">#</a> Protect Workstations (&amp; Servers)</h4><ul><li>Patch quickly, especially privilege escalation vulnerabilities.</li><li>Deploy security back-port patch (KB2871997).</li><li>Set Wdigest reg key to 0 (KB2871997/Windows 8.1/2012R2+): HKEY_LOCAL_MACHINESYSTEMCurrentControlSetControlSecurityProvidersWdigest</li><li>Deploy workstation whitelisting (Microsoft AppLocker) to block code exec in user folders – home dir &amp; profile path.</li><li>Deploy workstation app sandboxing technology (EMET) to mitigate application memory exploits (0-days).</li></ul><h4 id="logging"><a class="anchor" href="#logging">#</a> Logging</h4><ul><li>Enable enhanced auditing</li><li>“Audit: Force audit policy subcategory settings (Windows Vista or later) to override audit policy category settings”</li><li>Enable PowerShell module logging (“*”) &amp; forward logs to central log server (WEF or other method).</li><li>Enable CMD Process logging &amp; enhancement (KB3004375) and forward logs to central log server.</li><li>SIEM or equivalent to centralize as much log data as possible.</li><li>User Behavioural Analysis system for enhanced knowledge of user activity (such as Microsoft ATA).</li></ul><h4 id="security-pros-checks"><a class="anchor" href="#security-pros-checks">#</a> Security Pro’s Checks</h4><ul><li>Identify who has AD admin rights (domain/forest).</li><li>Identify who can logon to Domain Controllers (&amp; admin rights to virtual environment hosting virtual DCs).</li><li>Scan Active Directory Domains, OUs, AdminSDHolder, &amp; GPOs for inappropriate custom permissions.</li><li>Ensure AD admins (aka Domain Admins) protect their credentials by not logging into untrusted systems (workstations).</li><li>Limit service account rights that are currently DA (or equivalent).</li></ul><h3 id="important-security-updates"><a class="anchor" href="#important-security-updates">#</a> Important Security Updates</h3><table><thead><tr><th>CVE</th><th>Title</th><th>Description</th><th>Link</th></tr></thead><tbody><tr><td>CVE-2020-1472</td><td>Netlogon Elevation of Privilege Vulnerability</td><td>An elevation of privilege vulnerability exists when an attacker establishes a vulnerable Netlogon secure channel connection to a domain controller, using the Netlogon Remote Protocol (MS-NRPC). An attacker who successfully exploited the vulnerability could run a specially crafted application on a device on the network.</td><td><span class="exturl" data-url="aHR0cHM6Ly9wb3J0YWwubXNyYy5taWNyb3NvZnQuY29tL2VuLVVTL3NlY3VyaXR5LWd1aWRhbmNlL2Fkdmlzb3J5L0NWRS0yMDIwLTE0NzI=">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1472</span></td></tr><tr><td>CVE-2019-1040</td><td>Windows NTLM Tampering Vulnerability</td><td>A tampering vulnerability exists in Microsoft Windows when a man-in-the-middle attacker is able to successfully bypass the NTLM MIC (Message Integrity Check) protection, aka 'Windows NTLM Tampering Vulnerability'.</td><td><span class="exturl" data-url="aHR0cHM6Ly9wb3J0YWwubXNyYy5taWNyb3NvZnQuY29tL2VuLVVTL3NlY3VyaXR5LWd1aWRhbmNlL2Fkdmlzb3J5L0NWRS0yMDE5LTEwNDA=">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1040</span></td></tr><tr><td>CVE-2019-0683</td><td>Active Directory Elevation of Privilege Vulnerability</td><td>An elevation of privilege vulnerability exists in Active Directory Forest trusts due to a default setting that lets an attacker in the trusting forest request delegation of a TGT for an identity from the trusted forest, aka 'Active Directory Elevation of Privilege Vulnerability'.</td><td><span class="exturl" data-url="aHR0cHM6Ly9wb3J0YWwubXNyYy5taWNyb3NvZnQuY29tL2VuLVVTL3NlY3VyaXR5LWd1aWRhbmNlL2Fkdmlzb3J5L0NWRS0yMDE5LTA2ODM=">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0683</span></td></tr><tr><td>CVE-2019-0708</td><td>Remote Desktop Services Remote Code Execution Vulnerability</td><td>A remote code execution vulnerability exists in Remote Desktop Services formerly known as Terminal Services when an unauthenticated attacker connects to the target system using RDP and sends specially crafted requests, aka 'Remote Desktop Services Remote Code Execution Vulnerability'.</td><td><span class="exturl" data-url="aHR0cHM6Ly9wb3J0YWwubXNyYy5taWNyb3NvZnQuY29tL2VuLVVTL3NlY3VyaXR5LWd1aWRhbmNlL2Fkdmlzb3J5L0NWRS0yMDE5LTA3MDg=">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0708</span></td></tr><tr><td>CVE-2018-8581</td><td>Microsoft Exchange Server Elevation of Privilege Vulnerability</td><td>An elevation of privilege vulnerability exists in Microsoft Exchange Server, aka &quot;Microsoft Exchange Server Elevation of Privilege Vulnerability.&quot; This affects Microsoft Exchange Server.</td><td><span class="exturl" data-url="aHR0cHM6Ly9wb3J0YWwubXNyYy5taWNyb3NvZnQuY29tL2VuLVVTL3NlY3VyaXR5LWd1aWRhbmNlL2Fkdmlzb3J5L0NWRS0yMDE4LTg1MTg=">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8518</span></td></tr><tr><td>CVE-2017-0143</td><td>Windows SMB Remote Code Execution Vulnerability</td><td>The SMBv1 server in Microsoft Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016 allows remote attackers to execute arbitrary code via crafted packets, aka &quot;Windows SMB Remote Code Execution Vulnerability.&quot; This vulnerability is different from those described in CVE-2017-0144, CVE-2017-0145, CVE-2017-0146, and CVE-2017-0148.</td><td><span class="exturl" data-url="aHR0cHM6Ly9wb3J0YWwubXNyYy5taWNyb3NvZnQuY29tL2VuLVVTL3NlY3VyaXR5LWd1aWRhbmNlL2Fkdmlzb3J5L0NWRS0yMDE3LTAxNDM=">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-0143</span></td></tr><tr><td>CVE-2016-0128</td><td>Windows SAM and LSAD Downgrade Vulnerability</td><td>The SAM and LSAD protocol implementations in Microsoft Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, and Windows 10 Gold and 1511 do not properly establish an RPC channel, which allows man-in-the-middle attackers to perform protocol-downgrade attacks and impersonate users by modifying the client-server data stream, aka &quot;Windows SAM and LSAD Downgrade Vulnerability&quot; or &quot;BADLOCK.&quot;</td><td><span class="exturl" data-url="aHR0cHM6Ly9wb3J0YWwubXNyYy5taWNyb3NvZnQuY29tL2VuLVVTL3NlY3VyaXR5LWd1aWRhbmNlL2Fkdmlzb3J5L0NWRS0yMDE2LTAxMjg=">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2016-0128</span></td></tr><tr><td>CVE-2014-6324</td><td>Vulnerability in Kerberos Could Allow Elevation of Privilege (3011780)</td><td>The Kerberos Key Distribution Center (KDC) in Microsoft Windows Server 2003 SP2, Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8, Windows 8.1, and Windows Server 2012 Gold and R2 allows remote authenticated domain users to obtain domain administrator privileges via a forged signature in a ticket, as exploited in the wild in November 2014, aka &quot;Kerberos Checksum Vulnerability.&quot;</td><td><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm1pY3Jvc29mdC5jb20vZW4tdXMvc2VjdXJpdHktdXBkYXRlcy9zZWN1cml0eWJ1bGxldGlucy8yMDE0L21zMTQtMDY4">https://docs.microsoft.com/en-us/security-updates/securitybulletins/2014/ms14-068</span></td></tr><tr><td>CVE-2014-1812</td><td>Vulnerability in Group Policy Preferences could allow elevation of privilege</td><td>The Group Policy implementation in Microsoft Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8, Windows 8.1, and Windows Server 2012 Gold and R2 does not properly handle distribution of passwords, which allows remote authenticated users to obtain sensitive credential information and consequently gain privileges by leveraging access to the SYSVOL share, as exploited in the wild in May 2014, aka &quot;Group Policy Preferences Password Elevation of Privilege Vulnerability.&quot;</td><td><span class="exturl" data-url="aHR0cHM6Ly9zdXBwb3J0Lm1pY3Jvc29mdC5jb20vZW4tdXMvaGVscC8yOTYyNDg2L21zMTQtMDI1LXZ1bG5lcmFiaWxpdHktaW4tZ3JvdXAtcG9saWN5LXByZWZlcmVuY2VzLWNvdWxkLWFsbG93LWVsZXZhdGk=">https://support.microsoft.com/en-us/help/2962486/ms14-025-vulnerability-in-group-policy-preferences-could-allow-elevati</span></td></tr></tbody></table><h3 id="detection"><a class="anchor" href="#detection">#</a> Detection</h3><table><thead><tr><th>Attack</th><th>Event ID</th></tr></thead><tbody><tr><td>Account and Group Enumeration</td><td>4798: A user's local group membership was enumerated<br>4799: A security-enabled local group membership was enumerated</td></tr><tr><td>AdminSDHolder</td><td>4780: The ACL was set on accounts which are members of administrators groups</td></tr><tr><td>Kekeo</td><td>4624: Account Logon<br>4672: Admin Logon<br>4768: Kerberos TGS Request</td></tr><tr><td>Silver	Ticket</td><td>4624: Account Logon<br>4634: Account Logoff<br>4672: Admin Logon</td></tr><tr><td>Golden	Ticket</td><td>4624: Account Logon<br>4672: Admin Logon</td></tr><tr><td>PowerShell</td><td>4103: Script Block Logging<br>400: Engine Lifecycle<br>403: Engine Lifecycle<br>4103: Module Logging<br>600: Provider Lifecycle<br></td></tr><tr><td>DCShadow</td><td>4742: A computer account was changed<br>5137: A directory service object was created<br>5141: A directory service object was deleted<br>4929: An Active Directory replica source naming context was removed</td></tr><tr><td>Skeleton Keys</td><td>4673: A privileged service was called<br>4611: A trusted logon process has been registered with the Local Security Authority<br>4688: A new process has been created<br>4689: A new process has exited</td></tr><tr><td>PYKEK MS14-068</td><td>4672: Admin Logon<br>4624: Account Logon<br>4768: Kerberos TGS Request</td></tr><tr><td>Kerberoasting</td><td>4769: A Kerberos ticket was requested</td></tr><tr><td>S4U2Proxy</td><td>4769: A Kerberos ticket was requested</td></tr><tr><td>Lateral Movement</td><td>4688: A new process has been created<br>4689: A process has exited<br>4624: An account was successfully logged on<br>4625: An account failed to log on</td></tr><tr><td>DNSAdmin</td><td>770: DNS Server plugin DLL has been loaded<br>541: The setting serverlevelplugindll on scope . has been set to <code>&lt;dll path&gt;</code><br>150: DNS Server could not load or initialize the plug-in DLL</td></tr><tr><td>DCSync</td><td>4662: An operation was performed on an object</td></tr><tr><td>Password Spraying</td><td>4625: An account failed to log on<br>4771: Kerberos pre-authentication failed<br>4648: A logon was attempted using explicit credentials</td></tr></tbody></table><h3 id="resources"><a class="anchor" href="#resources">#</a> Resources</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9zdXBwb3J0Lm1pY3Jvc29mdC5jb20vZW4tdXMvaGVscC80NTU3MjIyL2hvdy10by1tYW5hZ2UtdGhlLWNoYW5nZXMtaW4tbmV0bG9nb24tc2VjdXJlLWNoYW5uZWwtY29ubmVjdGlvbnMtYXNzb2M=">How to manage the changes in Netlogon secure channel connections associated with CVE-2020-1472</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuaHViLnRyaW1hcmNzZWN1cml0eS5jb20vcG9zdC9zZWN1cmluZy1hY3RpdmUtZGlyZWN0b3J5LXBlcmZvcm1pbmctYW4tYWN0aXZlLWRpcmVjdG9yeS1zZWN1cml0eS1yZXZpZXc=">Securing Active Directory: Performing an Active Directory Security Review</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY2VydC5zc2kuZ291di5mci91cGxvYWRzL2d1aWRlLWFkLmh0bWw=">ACTIVE DIRECTORY SECURITY ASSESSMENT CHECKLIST</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hY3NjLmdvdi5hdS9wdWJsaWNhdGlvbnMvTWl0aWdhdGlvbl9TdHJhdGVnaWVzXzIwMTcucGRm">ASD Strategies to Mitigate Cyber Security Incidents</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm1pY3Jvc29mdC5jb20vZW4tdXMvd2luZG93cy1zZXJ2ZXIvaWRlbnRpdHkvYWQtZHMvcGxhbi9zZWN1cml0eS1iZXN0LXByYWN0aWNlcy9yZWR1Y2luZy10aGUtYWN0aXZlLWRpcmVjdG9yeS1hdHRhY2stc3VyZmFjZQ==">Reducing the Active Directory Attack Surface</span></li><li><span class="exturl" data-url="aHR0cHM6Ly90ZWNoY29tbXVuaXR5Lm1pY3Jvc29mdC5jb20vdDUvUHJlbWllci1GaWVsZC1FbmdpbmVlcmluZy9DaGFuZ2VzLXRvLVRpY2tldC1HcmFudGluZy1UaWNrZXQtVEdULURlbGVnYXRpb24tQWNyb3NzLVRydXN0cy9iYS1wLzQ0MDI4Mw==">Changes to Ticket-Granting Ticket (TGT) Delegation Across Trusts in Windows Server (AskPFEPlat edition)</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9wb3J0YWwubXNyYy5taWNyb3NvZnQuY29tL2VuLXVzL3NlY3VyaXR5LWd1aWRhbmNlL2Fkdmlzb3J5L0FEVjE5MDAwNg==">ADV190006 | Guidance to mitigate unconstrained delegation vulnerabilities</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9wb3J0YWwubXNyYy5taWNyb3NvZnQuY29tL2VuLVVTL3NlY3VyaXR5LWd1aWRhbmNlL2Fkdmlzb3J5L0FEVjE5MDAyMw==">ADV190023 | Microsoft Guidance for Enabling LDAP Channel Binding and LDAP Signing</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9zb2NpYWwudGVjaG5ldC5taWNyb3NvZnQuY29tL3dpa2kvY29udGVudHMvYXJ0aWNsZXMvMjA5NjQuYWN0aXZlLWRpcmVjdG9yeS11bHRpbWF0ZS1yZWFkaW5nLWNvbGxlY3Rpb24uYXNweA==">Active Directory: Ultimate Reading Collection</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9zb2NpYWwudGVjaG5ldC5taWNyb3NvZnQuY29tL3dpa2kvY29udGVudHMvYXJ0aWNsZXMvMTg5MzEuc2VjdXJpdHktaGFyZGVuaW5nLXRpcHMtYW5kLXJlY29tbWVuZGF0aW9ucy5hc3B4">Security Hardening Tips and Recommendations</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0zMzc3">Securing Domain Controllers to Improve Active Directory Security</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0zMjk5">Securing Windows Workstations: Developing a Secure Baseline</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm1pY3Jvc29mdC5jb20vZW4tdXMvd2luZG93cy1zZXJ2ZXIvaWRlbnRpdHkvYWQtZHMvcGxhbi9zZWN1cml0eS1iZXN0LXByYWN0aWNlcy9pbXBsZW1lbnRpbmctc2VjdXJlLWFkbWluaXN0cmF0aXZlLWhvc3Rz">Implementing Secure Administrative Hosts</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm1pY3Jvc29mdC5jb20vZW4tdXMvbWljcm9zb2Z0LWlkZW50aXR5LW1hbmFnZXIvcGFtL3ByaXZpbGVnZWQtaWRlbnRpdHktbWFuYWdlbWVudC1mb3ItYWN0aXZlLWRpcmVjdG9yeS1kb21haW4tc2VydmljZXM=">Privileged Access Management for Active Directory Domain Services</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1BhdWxTZWMvYXdlc29tZS13aW5kb3dzLWRvbWFpbi1oYXJkZW5pbmc=">Awesome Windows Domain Hardening</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm1pY3Jvc29mdC5jb20vZW4tdXMvd2luZG93cy1zZXJ2ZXIvaWRlbnRpdHkvYWQtZHMvcGxhbi9zZWN1cml0eS1iZXN0LXByYWN0aWNlcy9iZXN0LXByYWN0aWNlcy1mb3Itc2VjdXJpbmctYWN0aXZlLWRpcmVjdG9yeQ==">Best Practices for Securing Active Directory</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9wb3N0cy5zcGVjdGVyb3BzLmlvL2ludHJvZHVjaW5nLXRoZS1hZHZlcnNhcnktcmVzaWxpZW5jZS1tZXRob2RvbG9neS1wYXJ0LW9uZS1lMzhlMDZmZmQ2MDQ=">Introducing the Adversary Resilience Methodology — Part One</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9wb3N0cy5zcGVjdGVyb3BzLmlvL2ludHJvZHVjaW5nLXRoZS1hZHZlcnNhcnktcmVzaWxpZW5jZS1tZXRob2RvbG9neS1wYXJ0LXR3by0yNzlhMWVkNzg2M2Q=">Introducing the Adversary Resilience Methodology — Part Two</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC5taWNyb3NvZnQuY29tL2Rvd25sb2FkLzcvNy9BLzc3QUJDNUJELTgzMjAtNDFBRi04NjNDLTZFQ0ZCMTBDQjRCOS9NaXRpZ2F0aW5nLVBhc3MtdGhlLUhhc2gtQXR0YWNrcy1hbmQtT3RoZXItQ3JlZGVudGlhbC1UaGVmdC1WZXJzaW9uLTIucGRm">Mitigating Pass-the-Hash and Other Credential Theft, version 2</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL25zYWN5YmVyL1dpbmRvd3MtU2VjdXJlLUhvc3QtQmFzZWxpbmU=">Configuration guidance for implementing the Windows 10 and Windows Server 2016 DoD Secure Host Baseline settings</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm1pY3Jvc29mdC5jb20vZW4tdXMvd2luZG93cy1zZXJ2ZXIvaWRlbnRpdHkvYWQtZHMvcGxhbi9zZWN1cml0eS1iZXN0LXByYWN0aWNlcy9tb25pdG9yaW5nLWFjdGl2ZS1kaXJlY3RvcnktZm9yLXNpZ25zLW9mLWNvbXByb21pc2U=">Monitoring Active Directory for Signs of Compromise</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuanBjZXJ0Lm9yLmpwL2VuZ2xpc2gvcHViL3NyL0RldGVjdGluZyUyMExhdGVyYWwlMjBNb3ZlbWVudCUyMHRocm91Z2glMjBUcmFja2luZyUyMEV2ZW50JTIwTG9nc192ZXJzaW9uMi5wZGY=">Detecting Lateral Movement through Tracking Event Logs</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9jZXJ0LmV1cm9wYS5ldS9zdGF0aWMvV2hpdGVQYXBlcnMvVVBEQVRFRCUyMC0lMjBDRVJULUVVX1NlY3VyaXR5X1doaXRlcGFwZXJfMjAxNC0wMDdfS2VyYmVyb3NfR29sZGVuX1RpY2tldF9Qcm90ZWN0aW9uX3YxXzQucGRm">Kerberos Golden Ticket Protection Mitigating Pass-the-Ticket on Active Directory</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kaWdpdGFsLWZvcmVuc2ljcy5zYW5zLm9yZy9ibG9nLzIwMTMvMDYvMjAvb3ZlcnZpZXctb2YtbWljcm9zb2Z0cy1iZXN0LXByYWN0aWNlcy1mb3Itc2VjdXJpbmctYWN0aXZlLWRpcmVjdG9yeQ==">Overview of Microsoft's &quot;Best Practices for Securing Active Directory&quot;</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kc2ltZy51Ym0tdXMubmV0L2VudmVsb3BlLzE1NTQyMi8zMTQyMDIvMTMzMDUzNzkxMl9LZXlzX3RvX3RoZV9LaW5nZG9tX0xpbWl0aW5nX0FEX0FkbWlucy5wZGY=">The Keys to the Kingdom: Limiting Active Directory Administrators</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9ncy5zYW5zLm9yZy9jeWJlci1kZWZlbnNlLzIwMTgvMDkvMTAvcHJvdGVjdC1wcml2aWxlZ2VkLWFkLWFjY291bnRzLXdpdGgtZml2ZS1mcmVlLWNvbnRyb2xzLw==">Protect Privileged AD Accounts With Five Free Controls</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0xNjg0">The Most Common Active Directory Security Issues and What You Can Do to Fix Them</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL25zYWN5YmVyL0V2ZW50LUZvcndhcmRpbmctR3VpZGFuY2U=">Event Forwarding Guidance</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cubXdyaW5mb3NlY3VyaXR5LmNvbS9vdXItdGhpbmtpbmcvcGxhbnRpbmctdGhlLXJlZC1mb3Jlc3QtaW1wcm92aW5nLWFkLW9uLXRoZS1yb2FkLXRvLWVzYWUv">Planting the Red Forest: Improving AD on the Road to ESAE</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0zNDU4">Detecting Kerberoasting Activity</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm1pY3Jvc29mdC5jb20vcHQtcHQvcHJldmlvdXMtdmVyc2lvbnMvd2luZG93cy9zZXJ2ZXIvY2M3NTUzMjEodj13cy4xMCk=">Security Considerations for Trusts</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm1pY3Jvc29mdC5jb20vZW4tdXMvYWR2YW5jZWQtdGhyZWF0LWFuYWx5dGljcy9zdXNwaWNpb3VzLWFjdGl2aXR5LWd1aWRl">Advanced Threat Analytics suspicious activity guide</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9jZXJ0LmV1cm9wYS5ldS9zdGF0aWMvV2hpdGVQYXBlcnMvQ0VSVC1FVS1TV1BfMTRfMDdfUGFzc1RoZUdvbGRlbl9UaWNrZXRfdjFfMS5wZGY=">Protection from Kerberos Golden Ticket</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC5taWNyb3NvZnQuY29tL2Rvd25sb2FkL0MvMS80L0MxNDU3OUNBLUU1NjQtNDc0My04QjUxLTYxQzA4ODI2NjJBQy9XaW5kb3dzJTIwMTAlMjBjcmVkZW50aWFsJTIwdGhlZnQlMjBtaXRpZ2F0aW9uJTIwZ3VpZGUuZG9jeA==">Windows 10 Credential Theft Mitigation Guide</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmphdmVsaW4tbmV0d29ya3MuY29tL2RldGVjdGluZy1wYXNzLXRoZS10aWNrZXQtYW5kLXBhc3MtdGhlLWhhc2gtYXR0YWNrLXVzaW5nLXNpbXBsZS13bWktY29tbWFuZHMtMmM0NjEwMmI3NmJj">Detecting Pass-The- Ticket and Pass-The- Hash Attack Using Simple WMI Commands</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9nYWxsZXJ5LnRlY2huZXQubWljcm9zb2Z0LmNvbS9TdGVwLWJ5LVN0ZXAtRGVwbG95LUxvY2FsLTdjOWVmNzcy">Step by Step Deploy Microsoft Local Administrator Password Solution</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cudHJvb3BlcnMuZGUvZG93bmxvYWRzL3Ryb29wZXJzMTcvVFIxN19BRF9zaWduZWQucGRm">Active Directory Security Best Practices</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9ncy50ZWNobmV0Lm1pY3Jvc29mdC5jb20vam9uc2gvMjAxOC8xMC8wMy9maW5hbGx5LWRlcGxveS1hbmQtYXVkaXQtbGFwcy13aXRoLXByb2plY3QtdmFzdC1wYXJ0LTEtb2YtMi8=">Finally Deploy and Audit LAPS with Project VAST, Part 1 of 2</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cudWx0aW1hdGV3aW5kb3dzc2VjdXJpdHkuY29tL3NlY3VyaXR5bG9nL2VuY3ljbG9wZWRpYS9kZWZhdWx0LmFzcHg=">Windows Security Log Events</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cudHJpbWFyY3NlY3VyaXR5LmNvbS9zaW5nbGUtcG9zdC9EZXRlY3RpbmctdGhlLUVsdXNpdmUtQWN0aXZlLURpcmVjdG9yeS1UaHJlYXQtSHVudGluZw==">Talk Transcript BSidesCharm Detecting the Elusive: Active Directory Threat Hunting</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9tZWRpdW0uY29tL2JsdWUtdGVhbS9wcmV2ZW50aW5nLW1pbWlrYXR6LWF0dGFja3MtZWQyODNlN2ViZGQ1">Preventing Mimikatz Attacks</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2xpZGVzaGFyZS5uZXQvUXVlc3RTb2Z0d2FyZS91bmRlcnN0YW5kaW5nLXJlZC1mb3Jlc3QtdGhlLTN0aWVyLWVzYWUtYW5kLWFsdGVybmF0aXZlLXdheXMtdG8tcHJvdGVjdC1wcml2aWxlZ2VkLWNyZWRlbnRpYWxz">Understanding &quot;Red Forest&quot; - The 3-Tier ESAE and Alternative Ways to Protect Privileged Credentials</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0zNzgy">Securing Microsoft Active Directory Federation Server (ADFS)</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cubWljcm9zb2Z0LmNvbS9lbi11cy9taWNyb3NvZnQtMzY1L2Jsb2cvMjAxOC8wMy8wNS9henVyZS1hZC1hbmQtYWRmcy1iZXN0LXByYWN0aWNlcy1kZWZlbmRpbmctYWdhaW5zdC1wYXNzd29yZC1zcHJheS1hdHRhY2tzLw==">Azure AD and ADFS best practices: Defending against password spray attacks</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0yMg==">AD Reading: Active Directory Backup and Disaster Recovery</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuZW5kZ2FtZS5jb20vYmxvZy90ZWNobmljYWwtYmxvZy90ZW4tcHJvY2Vzcy1pbmplY3Rpb24tdGVjaG5pcXVlcy10ZWNobmljYWwtc3VydmV5LWNvbW1vbi1hbmQtdHJlbmRpbmctcHJvY2Vzcw==">Ten Process Injection Techniques: A Technical Survey Of Common And Trending Process Injection Techniques</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuZW5kZ2FtZS5jb20vYmxvZy90ZWNobmljYWwtYmxvZy9odW50aW5nLW1lbW9yeS1uZXQtYXR0YWNrcw==">Hunting For In-Memory .NET Attacks</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2Fucy5vcmcvcmVhZGluZy1yb29tL3doaXRlcGFwZXJzL2RldGVjdGlvbi9taW1pa2F0ei1vdmVydmlldy1kZWZlbnNlcy1kZXRlY3Rpb24tMzY3ODA=">Mimikatz Overview, Defenses and Detection</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cudHJpbWFyY3NlY3VyaXR5LmNvbS9zaW5nbGUtcG9zdC8yMDE4LzA1LzA2L1RyaW1hcmMtUmVzZWFyY2gtRGV0ZWN0aW5nLVBhc3N3b3JkLVNwcmF5aW5nLXdpdGgtU2VjdXJpdHktRXZlbnQtQXVkaXRpbmc=">Trimarc Research: Detecting Password Spraying with Security Event Auditing</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY291bnRlcmNlcHQuY29tL2Jsb2cvaHVudGluZy1mb3ItZ2FyZ295bGUv">Hunting for Gargoyle Memory Scanning Evasion</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm1pY3Jvc29mdC5jb20vZW4tdXMvd2luZG93cy9zZWN1cml0eS90aHJlYXQtcHJvdGVjdGlvbi93aW5kb3dzLWRlZmVuZGVyLWFwcGxpY2F0aW9uLWNvbnRyb2wvd2luZG93cy1kZWZlbmRlci1hcHBsaWNhdGlvbi1jb250cm9sLWRlcGxveW1lbnQtZ3VpZGU=">Planning and getting started on the Windows Defender Application Control deployment process</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9tZWRpdW0uY29tL3RoaW5rLXN0YWNrL3ByZXZlbnRpbmctbGF0ZXJhbC1tb3ZlbWVudC11c2luZy1uZXR3b3JrLWFjY2Vzcy1ncm91cHMtN2U4ZDUzOWE5MDI5">Preventing Lateral Movement Using Network Access Groups</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9vbmVkcml2ZS5saXZlLmNvbS92aWV3LmFzcHg/cmVzaWQ9RDAyNkI0Njk5MTkwRjFFNiEyODQzJmFtcDtpdGhpbnQ9ZmlsZSUyY3BwdHgmYW1wO2FwcD1Qb3dlclBvaW50JmFtcDthdXRoa2V5PSFBTXZDUlRLQl9WMUo1b3c=">How to Go from Responding to Hunting with Sysinternals Sysmon</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3BhbGFudGlyL3dpbmRvd3MtZXZlbnQtZm9yd2FyZGluZw==">Windows Event Forwarding Guidance</span></li><li><span class="exturl" data-url="aHR0cDovL3RocmVhdGV4cHJlc3MuY29tLzIwMTgvMDUvdGhyZWF0LW1pdGlnYXRpb24tc3RyYXRlZ2llcy10ZWNobmljYWwtcmVjb21tZW5kYXRpb25zLWFuZC1pbmZvLXBhcnQtMi8=">Threat Mitigation Strategies: Part 2 – Technical Recommendations and Information</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9jaGFubmVsOS5tc2RuLmNvbS9FdmVudHMvSWduaXRlLzIwMTUvQlJLMzQ4Ng==">Modern Hardening: Lessons Learned on Hardening Applications and Services</span></li><li><span class="exturl" data-url="aHR0cDovL3B1YmxpY2F0aW9ucy5nYy5jYS9jb2xsZWN0aW9ucy9jb2xsZWN0aW9uXzIwMTkvY3N0Yy1jc2VjL0Q5Ny0zLTcwLTEyLTIwMTktZW5nLnBkZg==">ITSP.70.012 Guidance for Hardening Microsoft Windows 10 Enterprise</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuc25lYWt5bW9ua2V5Lm5ldC8yMDE4LzA2LzI1L2JsdWUtdGVhbS10aXBzLw==">Blue Team Tips</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuc3RpZ3ZpZXdlci5jb20vc3RpZy9hY3RpdmVfZGlyZWN0b3J5X2RvbWFpbi8=">Active Directory Domain Security Technical Implementation Guide (STIG)</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2xpZGVzaGFyZS5uZXQvSHV5S2hhMi9hZHN0Zy12MjAtZ3VpZGFuY2U=">Active Directory Security Testing Guide - v2.0</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm1pY3Jvc29mdC5jb20vZW4tdXMvd2luZG93cy1zZXJ2ZXIvaWRlbnRpdHkvYWQtZnMvZGVwbG95bWVudC9iZXN0LXByYWN0aWNlcy1zZWN1cmluZy1hZC1mcw==">Best practices for securing Active Directory Federation Services</span></li></ul><h2 id="license"><a class="anchor" href="#license">#</a> License</h2><p><a target="_blank" rel="noopener" href="http://creativecommons.org/publicdomain/zero/1.0"><img data-src="http://mirrors.creativecommons.org/presskit/buttons/88x31/svg/cc-zero.svg" alt="CC0"></a></p><p>To the extent possible under law, Rahmat Nurfauzi &quot;@infosecn1nja&quot; has waived all copyright and related or neighboring rights to this work.</p><div class="tags"><a href="/tags/AD-Attack-Defense/" rel="tag"><i class="ic i-tag"></i> AD-Attack-Defense</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2022-03-13 17:09:44" itemprop="dateModified" datetime="2022-03-13T17:09:44+08:00">2022-03-13</time> </span><span id="PenetrationTest/Reference/AD-Attack-Defense/" class="item leancloud_visitors" data-flag-title="Active Directory Kill Chain Attack & Defense【转】" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/reward.jpg" alt="Or0kit 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Or0kit <i class="ic i-at"><em>@</em></i>Or0kit</li><li class="link"><strong>本文链接：</strong> <a href="https://or0kit.github.io/PenetrationTest/Reference/AD-Attack-Defense/" title="Active Directory Kill Chain Attack &amp; Defense【转】">https://or0kit.github.io/PenetrationTest/Reference/AD-Attack-Defense/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/PenetrationTest/Reference/Awesome-Red-Teaming/" itemprop="url" rel="prev" data-background-image="http:&#x2F;&#x2F;storage.live.com&#x2F;items&#x2F;70930153B02A575!367?authkey&#x3D;AGDHHD5Qh4Y5OtQ" title="Awesome Red Teaming【转】"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 转载</span><h3>Awesome Red Teaming【转】</h3></a></div><div class="item right"><a href="/PenetrationTest/Reference/RedTeamer/" itemprop="url" rel="next" data-background-image="http:&#x2F;&#x2F;storage.live.com&#x2F;items&#x2F;70930153B02A575!392?authkey&#x3D;AGDHHD5Qh4Y5OtQ" title="红方人员实战手册【转】"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 网络安全</span><h3>红方人员实战手册【转】</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#active-directory-kill-chain-attack-defense"><span class="toc-number">1.</span> <span class="toc-text">Active Directory Kill Chain Attack &amp; Defense</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#summary"><span class="toc-number">1.1.</span> <span class="toc-text">Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#table-of-contents"><span class="toc-number">1.2.</span> <span class="toc-text">Table of Contents</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#discovery"><span class="toc-number">1.3.</span> <span class="toc-text">Discovery</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#spn-scanning"><span class="toc-number">1.3.1.</span> <span class="toc-text">SPN Scanning</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#data-mining"><span class="toc-number">1.3.2.</span> <span class="toc-text">Data Mining</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#user-hunting"><span class="toc-number">1.3.3.</span> <span class="toc-text">User Hunting</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#laps"><span class="toc-number">1.3.4.</span> <span class="toc-text">LAPS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#applocker"><span class="toc-number">1.3.5.</span> <span class="toc-text">AppLocker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#azure"><span class="toc-number">1.3.6.</span> <span class="toc-text">Azure</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#active-directory-federation-services"><span class="toc-number">1.3.7.</span> <span class="toc-text">Active Directory Federation Services</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#privilege-escalation"><span class="toc-number">1.4.</span> <span class="toc-text">Privilege Escalation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#zerologon"><span class="toc-number">1.4.1.</span> <span class="toc-text">Zerologon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#passwords-in-sysvol-group-policy-preferences"><span class="toc-number">1.4.2.</span> <span class="toc-text">Passwords in SYSVOL &amp; Group Policy Preferences</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ms14-068-kerberos-vulnerability"><span class="toc-number">1.4.3.</span> <span class="toc-text">MS14-068 Kerberos Vulnerability</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dnsadmins"><span class="toc-number">1.4.4.</span> <span class="toc-text">DNSAdmins</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kerberos-delegation"><span class="toc-number">1.4.5.</span> <span class="toc-text">Kerberos Delegation</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#unconstrained-delegation"><span class="toc-number">1.4.5.1.</span> <span class="toc-text">Unconstrained Delegation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#constrained-delegation"><span class="toc-number">1.4.5.2.</span> <span class="toc-text">Constrained Delegation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#resource-based-constrained-delegation"><span class="toc-number">1.4.5.3.</span> <span class="toc-text">Resource-Based Constrained Delegation</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#insecure-group-policy-object-permission-rights"><span class="toc-number">1.4.6.</span> <span class="toc-text">Insecure Group Policy Object Permission Rights</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#insecure-acls-permission-rights"><span class="toc-number">1.4.7.</span> <span class="toc-text">Insecure ACLs Permission Rights</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#domain-trusts"><span class="toc-number">1.4.8.</span> <span class="toc-text">Domain Trusts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dcshadow"><span class="toc-number">1.4.9.</span> <span class="toc-text">DCShadow</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rid"><span class="toc-number">1.4.10.</span> <span class="toc-text">RID</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#microsoft-sql-server"><span class="toc-number">1.4.11.</span> <span class="toc-text">Microsoft SQL Server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#red-forest"><span class="toc-number">1.4.12.</span> <span class="toc-text">Red Forest</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exchange"><span class="toc-number">1.4.13.</span> <span class="toc-text">Exchange</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#llmnrnbns"><span class="toc-number">1.4.14.</span> <span class="toc-text">LLMNR&#x2F;NBNS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lateral-movement"><span class="toc-number">1.5.</span> <span class="toc-text">Lateral Movement</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#microsoft-sql-server-database-links"><span class="toc-number">1.5.1.</span> <span class="toc-text">Microsoft SQL Server Database links</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pass-the-hash"><span class="toc-number">1.5.2.</span> <span class="toc-text">Pass The Hash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#system-center-configuration-manager-sccm"><span class="toc-number">1.5.3.</span> <span class="toc-text">System Center Configuration Manager (SCCM)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#wsus"><span class="toc-number">1.5.4.</span> <span class="toc-text">WSUS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#password-spraying"><span class="toc-number">1.5.5.</span> <span class="toc-text">Password Spraying</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#automated-lateral-movement"><span class="toc-number">1.5.6.</span> <span class="toc-text">Automated Lateral Movement</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#defense-evasion"><span class="toc-number">1.6.</span> <span class="toc-text">Defense Evasion</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#in-memory-evasion"><span class="toc-number">1.6.1.</span> <span class="toc-text">In-Memory Evasion</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#endpoint-detection-and-response-edr-evasion"><span class="toc-number">1.6.2.</span> <span class="toc-text">Endpoint Detection and Response (EDR) Evasion</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#opsec"><span class="toc-number">1.6.3.</span> <span class="toc-text">OPSEC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#microsoft-ata-atp-evasion"><span class="toc-number">1.6.4.</span> <span class="toc-text">Microsoft ATA &amp; ATP Evasion</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#powershell-scriptblock-logging-bypass"><span class="toc-number">1.6.5.</span> <span class="toc-text">PowerShell ScriptBlock Logging Bypass</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#powershell-anti-malware-scan-interface-amsi-bypass"><span class="toc-number">1.6.6.</span> <span class="toc-text">PowerShell Anti-Malware Scan Interface (AMSI) Bypass</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#loading-net-assemblies-anti-malware-scan-interface-amsi-bypass"><span class="toc-number">1.6.7.</span> <span class="toc-text">Loading .NET Assemblies Anti-Malware Scan Interface (AMSI) Bypass</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#applocker-device-guard-bypass"><span class="toc-number">1.6.8.</span> <span class="toc-text">AppLocker &amp; Device Guard Bypass</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sysmon-evasion"><span class="toc-number">1.6.9.</span> <span class="toc-text">Sysmon Evasion</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#honeytokens-evasion"><span class="toc-number">1.6.10.</span> <span class="toc-text">HoneyTokens Evasion</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#disabling-security-tools"><span class="toc-number">1.6.11.</span> <span class="toc-text">Disabling Security Tools</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#credential-dumping"><span class="toc-number">1.7.</span> <span class="toc-text">Credential Dumping</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ntdsdit-password-extraction"><span class="toc-number">1.7.1.</span> <span class="toc-text">NTDS.DIT Password Extraction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sam-security-accounts-manager"><span class="toc-number">1.7.2.</span> <span class="toc-text">SAM (Security Accounts Manager)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kerberoasting"><span class="toc-number">1.7.3.</span> <span class="toc-text">Kerberoasting</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kerberos-ap-rep-roasting"><span class="toc-number">1.7.4.</span> <span class="toc-text">Kerberos AP-REP Roasting</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#windows-credential-managervault"><span class="toc-number">1.7.5.</span> <span class="toc-text">Windows Credential Manager&#x2F;Vault</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dcsync"><span class="toc-number">1.7.6.</span> <span class="toc-text">DCSync</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#llmnrnbt-ns-poisoning"><span class="toc-number">1.7.7.</span> <span class="toc-text">LLMNR&#x2F;NBT-NS Poisoning</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#others"><span class="toc-number">1.7.8.</span> <span class="toc-text">Others</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#persistence"><span class="toc-number">1.8.</span> <span class="toc-text">Persistence</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#golden-ticket"><span class="toc-number">1.8.1.</span> <span class="toc-text">Golden Ticket</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sid-history"><span class="toc-number">1.8.2.</span> <span class="toc-text">SID History</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#silver-ticket"><span class="toc-number">1.8.3.</span> <span class="toc-text">Silver Ticket</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dcshadow-2"><span class="toc-number">1.8.4.</span> <span class="toc-text">DCShadow</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#adminsdholder"><span class="toc-number">1.8.5.</span> <span class="toc-text">AdminSDHolder</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#group-policy-object"><span class="toc-number">1.8.6.</span> <span class="toc-text">Group Policy Object</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#skeleton-keys"><span class="toc-number">1.8.7.</span> <span class="toc-text">Skeleton Keys</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#seenabledelegationprivilege"><span class="toc-number">1.8.8.</span> <span class="toc-text">SeEnableDelegationPrivilege</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#security-support-provider"><span class="toc-number">1.8.9.</span> <span class="toc-text">Security Support Provider</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#directory-services-restore-mode"><span class="toc-number">1.8.10.</span> <span class="toc-text">Directory Services Restore Mode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#acls-security-descriptors"><span class="toc-number">1.8.11.</span> <span class="toc-text">ACLs &amp; Security Descriptors</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tools-scripts"><span class="toc-number">1.9.</span> <span class="toc-text">Tools &amp; Scripts</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ebooks"><span class="toc-number">1.10.</span> <span class="toc-text">Ebooks</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cheat-sheets"><span class="toc-number">1.11.</span> <span class="toc-text">Cheat Sheets</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#other-resources"><span class="toc-number">1.12.</span> <span class="toc-text">Other Resources</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#defense-detection"><span class="toc-number">1.13.</span> <span class="toc-text">Defense &amp; Detection</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#tools-scripts-2"><span class="toc-number">1.13.1.</span> <span class="toc-text">Tools &amp; Scripts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sysmon-configuration"><span class="toc-number">1.13.2.</span> <span class="toc-text">Sysmon Configuration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#active-directory-security-checks-by-sean-metcalf-pyrotek3"><span class="toc-number">1.13.3.</span> <span class="toc-text">Active Directory Security Checks (by Sean Metcalf - @Pyrotek3)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#general-recommendations"><span class="toc-number">1.13.3.1.</span> <span class="toc-text">General Recommendations</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#protect-admin-credentials"><span class="toc-number">1.13.3.2.</span> <span class="toc-text">Protect Admin Credentials</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#protect-ad-admin-credentials"><span class="toc-number">1.13.3.3.</span> <span class="toc-text">Protect AD Admin Credentials</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#protect-service-account-credentials"><span class="toc-number">1.13.3.4.</span> <span class="toc-text">Protect Service Account Credentials</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#protect-resources"><span class="toc-number">1.13.3.5.</span> <span class="toc-text">Protect Resources</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#protect-domain-controllers"><span class="toc-number">1.13.3.6.</span> <span class="toc-text">Protect Domain Controllers</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#protect-workstations-servers"><span class="toc-number">1.13.3.7.</span> <span class="toc-text">Protect Workstations (&amp; Servers)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#logging"><span class="toc-number">1.13.3.8.</span> <span class="toc-text">Logging</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#security-pros-checks"><span class="toc-number">1.13.3.9.</span> <span class="toc-text">Security Pro’s Checks</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#important-security-updates"><span class="toc-number">1.13.4.</span> <span class="toc-text">Important Security Updates</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#detection"><span class="toc-number">1.13.5.</span> <span class="toc-text">Detection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#resources"><span class="toc-number">1.13.6.</span> <span class="toc-text">Resources</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#license"><span class="toc-number">1.14.</span> <span class="toc-text">License</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/PenetrationTest/Reference/awesome-web-security/" rel="bookmark" title="Awesome Web Security【转】">Awesome Web Security【转】</a></li><li><a href="/PenetrationTest/Reference/Awesome-Red-Teaming/" rel="bookmark" title="Awesome Red Teaming【转】">Awesome Red Teaming【转】</a></li><li class="active"><a href="/PenetrationTest/Reference/AD-Attack-Defense/" rel="bookmark" title="Active Directory Kill Chain Attack & Defense【转】">Active Directory Kill Chain Attack & Defense【转】</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Or0kit" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Or0kit</p><div class="description" itemprop="description">临渊羡鱼，不如退而结网</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">216</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">49</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">398</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29t" title="https:&#x2F;&#x2F;github.com"><i class="ic i-github"></i></span> <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;twitter.com&#x2F;yourname"><i class="ic i-twitter"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;yourname"><i class="ic i-zhihu"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPXlvdXJuYW1l" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;yourname"><i class="ic i-cloud-music"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20veW91cm5hbWU=" title="https:&#x2F;&#x2F;weibo.com&#x2F;yourname"><i class="ic i-weibo"></i></span> <span class="exturl item youtube" data-url="aHR0cHM6Ly95b3V0dWJlLmNvbS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;youtube.com&#x2F;yourname"><i class="ic i-youtube"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>links</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/PenetrationTest/Reference/Awesome-Red-Teaming/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/PenetrationTest/Reference/RedTeamer/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/Programming/" title="分类于 编程">编程</a> <i class="ic i-angle-right"></i> <a href="/categories/Programming/MFC/" title="分类于 MFC">MFC</a></div><span><a href="/Programming/MFC/MFC-06ListCtrl%E9%AB%98%E7%BA%A7%E5%88%97%E8%A1%A8%E6%8E%A7%E4%BB%B6/" title="MFC-06ListCtrl高级列表控件">MFC-06ListCtrl高级列表控件</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Bin/" title="分类于 逆向">逆向</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/Core/" title="分类于 内核学习">内核学习</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/Core/WindowsXp/" title="分类于 Xp内核分析">Xp内核分析</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/Core/WindowsXp/Protect-Mode/" title="分类于 保护模式">保护模式</a></div><span><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%E2%80%94PDE-PTE/" title="保护模式—PDE_PTE">保护模式—PDE_PTE</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Bin/" title="分类于 逆向">逆向</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/Win32/" title="分类于 Win32">Win32</a></div><span><a href="/Bin/Win32/Win32%E9%A1%B9%E7%9B%AE-%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E7%9B%91%E6%8E%A7%E5%99%A8/" title="Win32项目-函数调用监控器">Win32项目-函数调用监控器</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/VMWare/" title="分类于 VMWare">VMWare</a></div><span><a href="/PenetrationTest/Web-Security/%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%B1%9E%E6%80%A7/" title="虚拟机网络属性">虚拟机网络属性</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Programming/" title="分类于 编程">编程</a> <i class="ic i-angle-right"></i> <a href="/categories/Programming/Python/" title="分类于 Python">Python</a></div><span><a href="/Programming/Python/%E5%88%9D%E8%AF%86python%E6%B5%8B%E8%AF%95%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/" title="初识python测试驱动开发">初识python测试驱动开发</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Bin/" title="分类于 逆向">逆向</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/Win32/" title="分类于 Win32">Win32</a></div><span><a href="/Bin/Win32/Win%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E4%B8%8E%E7%89%A9%E7%90%86%E5%86%85%E5%AD%98/" title="Win虚拟内存与物理内存">Win虚拟内存与物理内存</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Bin/" title="分类于 逆向">逆向</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/Core/" title="分类于 内核学习">内核学习</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/Core/WindowsXp/" title="分类于 Xp内核分析">Xp内核分析</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/Core/WindowsXp/Protect-Mode/" title="分类于 保护模式">保护模式</a></div><span><a href="/Bin/Core/WindowsXp/Protect-Mode/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E4%BB%BB%E5%8A%A1%E9%97%A8/" title="保护模式-任务门">保护模式-任务门</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Bin/" title="分类于 逆向">逆向</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/Core/" title="分类于 内核学习">内核学习</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/Core/WindowsXp/" title="分类于 Xp内核分析">Xp内核分析</a> <i class="ic i-angle-right"></i> <a href="/categories/Bin/Core/WindowsXp/MessageMechanism/" title="分类于 消息机制">消息机制</a></div><span><a href="/Bin/Core/WindowsXp/MessageMechanism/%E6%B6%88%E6%81%AF%E6%9C%BA%E5%88%B6-04%E6%B6%88%E6%81%AF%E7%9A%84%E5%88%86%E5%8F%91/" title="消息机制-04消息的分发">消息机制-04消息的分发</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Android/" title="分类于 Android">Android</a></div><span><a href="/%E5%9C%A8Android%E4%B8%8A%E5%AE%89%E8%A3%85kali/" title="在Android上安装kali">在Android上安装kali</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Hexo/" title="分类于 Hexo">Hexo</a></div><span><a href="/Algolia%E8%B8%A9%E5%9D%91-%E4%B8%BA%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0%E6%90%9C%E7%B4%A2%E5%8A%9F%E8%83%BD/" title="Algolia踩坑--为博客添加搜索功能">Algolia踩坑--为博客添加搜索功能</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Or0kit @ Or0kit</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">1.5m 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">22:02</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"PenetrationTest/Reference/AD-Attack-Defense/",favicon:{show:"╰(*°▽°*)╯正在变强中",hide:"(ー`′ー)快回来"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{scale:1,hHeadPos:.5,vHeadPos:.618,jsonPath:"/live2dw/assets/koharu.model.json"},display:{superSample:2,width:150,height:300,position:"right",hOffset:0,vOffset:-20},mobile:{show:!0,scale:.5},react:{opacityDefault:.7,opacityOnHover:.8},log:!1})</script></body></html><!-- rebuild by hrmmi -->